---
title: Logging
description: Comprehensive guide to structured logging in ocpp-ws-io
---

# Logging

**ocpp-ws-io** comes with a powerful, built-in structured logging system powered by **[voltlog-io](https://www.npmjs.com/package/voltlog-io)**. It provides real-time traffic inspection, performance monitoring, and seamless integration with external logging services.

## Overview

Logging in `ocpp-ws-io` is designed to be:

- **Zero-Config**: Works out of the box with sensible defaults.
- **Structured**: All logs are JSON-formatted for easy parsing and ingestion.
- **OCPP-Aware**: Special handling for OCPP messages, including direction and metadata.
- **Extensible**: Use built-in transports or bring your own logger (Pino, Winston, etc.).

## Quick Start

Enable logging when initializing your client or server:

```typescript
import { OCPPClient } from "ocpp-ws-io";

const client = new OCPPClient({
  identity: "CP-001",
  endpoint: "ws://localhost:3000",
  logging: {
    enabled: true, // Default: true
    prettify: true, // ðŸŒˆ Enable colors & icons for development
    exchangeLog: true, // âš¡ Log every OCPP message (Call/Result/Error)
  },
});
```

## Configuration

The `logging` option accepts a `LoggingConfig` object:

| Option             | Type         | Default     | Description                                                             |
| :----------------- | :----------- | :---------- | :---------------------------------------------------------------------- |
| `enabled`          | `boolean`    | `true`      | Enable or disable all logging.                                          |
| `level`            | `string`     | `'info'`    | Minimum log level (`trace`, `debug`, `info`, `warn`, `error`, `fatal`). |
| `prettify`         | `boolean`    | `false`     | Use `prettyTransport` for human-readable output (colors, icons).        |
| `exchangeLog`      | `boolean`    | `false`     | Log all OCPP messages with direction (`IN`/`OUT`) and metadata.         |
| `handler`          | `LoggerLike` | `undefined` | Custom logger instance (e.g., Pino) to replace the default logger.      |
| `showMetadata`     | `boolean`    | `true`      | Show trailing metadata object in logs.                                  |
| `showSourceMeta`   | `boolean`    | `true`      | Show source context (component, identity).                              |
| `prettifySource`   | `boolean`    | `false`     | Compact source tag `[OCPPServer/CP-1]`.                                 |
| `prettifyMetadata` | `boolean`    | `false`     | Format metadata as key=value pairs.                                     |

### Levels

| Level   | Value | Usage                                                         |
| :------ | :---- | :------------------------------------------------------------ |
| `fatal` | `60`  | System is unusable.                                           |
| `error` | `50`  | Error conditions (connection failures, validation errors).    |
| `warn`  | `40`  | Warning conditions (retries, unexpected messages).            |
| `info`  | `30`  | Normal operational messages (connect/disconnect, startup).    |
| `debug` | `20`  | Detailed internal state (protocol negotiation, raw payloads). |
| `trace` | `10`  | Very detailed step-by-step tracing.                           |

## Exchange Logging (Middleware)

The `exchangeLog` feature is now powered by the internal **Logging Middleware**. It logs every WebSocket message sent or received.

### Output Format

When **`prettify: true`** is also enabled, you get styled output distinguishing outbound calls, inbound calls, and asynchronous results:

```
// Outbound RPC Call (from Station to CSMS)
âš¡ CP-101  â†’  BootNotification  [OUT]

// Inbound RPC Call (from CSMS to Station)
âœ… CP-101  â†  GetConfiguration  [IN]

// Asynchronous RPC Result / Error returned
ðŸ”¥ CP-101  â†  BootNotification  [RES]   { latencyMs: 45 }
```

When **`prettify: false`** (production), logs are structured JSON:

```json
{
  "level": 30,
  "msg": "BootNotification",
  "direction": "OUT",
  "messageId": "12345",
  "payload": { ... }
}
```

## Voltlog Integration

This library uses **voltlog-io** under the hood. You can import logging utilities directly from `ocpp-ws-io/logger`:

```typescript
import { createLogger, consoleTransport } from "ocpp-ws-io/logger";

const logger = createLogger({
  name: "MyCSMS",
  transports: [consoleTransport()],
});

logger.info("System started");
```

### Using a Custom Logger

If you already use Pino, Winston, or another logger, you can pass it to `ocpp-ws-io`. The logger must satisfy the `LoggerLike` interface (methods: `debug`, `info`, `warn`, `error`, `child`).

**Example with Pino:**

```typescript
import pino from "pino";
import { OCPPServer } from "ocpp-ws-io";

const myLogger = pino();

const server = new OCPPServer({
  logging: {
    handler: myLogger, // ocpp-ws-io will use this instance
  },
});
```

## Browser Client

The `BrowserOCPPClient` also supports logging, configured the same way.

```typescript
import { BrowserOCPPClient } from "ocpp-ws-io/browser";

const client = new BrowserOCPPClient({
  endpoint: "wss://csms.example.com",
  identity: "Simulator-1",
  logging: {
    level: "debug",
    exchangeLog: true,
  },
});
```

> **Note:** In the browser, `prettify` uses browser console styling (CSS) instead of terminal colors.
