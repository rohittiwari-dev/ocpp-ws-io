
[1m[46m RUN [49m[22m [36mv3.2.4 [39m[90mD:/projects/ocpp-ws-io/packages/ocpp-ws-io[39m

 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22mocpp-ws-io/logger re-export[2m > [22mshould re-export createLogger from voltlog-io[32m 78[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22mocpp-ws-io/logger re-export[2m > [22mshould re-export consoleTransport from voltlog-io[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22mocpp-ws-io/logger re-export[2m > [22mshould re-export prettyTransport from voltlog-io[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22mocpp-ws-io/logger re-export[2m > [22mshould re-export middleware from voltlog-io[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22mocpp-ws-io/logger re-export[2m > [22mshould create a working logger through the re-export[32m 11[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22minitLogger utility[2m > [22mshould return null when config is false[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22minitLogger utility[2m > [22mshould return null when config.enabled is false[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22minitLogger utility[2m > [22mshould return default voltlog-io logger when config is undefined[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22minitLogger utility[2m > [22mshould bind context via child() when defaultContext is provided[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22minitLogger utility[2m > [22mshould use custom handler when provided[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22minitLogger utility[2m > [22mshould call child() on custom handler when context is provided[32m 3[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22minitLogger utility[2m > [22mshould return handler as-is when handler has no child() and context is provided[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22minitLogger utility[2m > [22mshould use prettyTransport when exchangeLog is true[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22minitLogger utility[2m > [22mshould use consoleTransport when exchangeLog is false[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22minitLogger utility[2m > [22mshould respect custom level[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/logger-reexport.test.ts[2m > [22minitLogger utility[2m > [22mshould return logger without child when no defaultContext[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mconstructor[2m > [22mshould create a validator with subprotocol name[32m 8[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mconstructor[2m > [22mshould normalize urn: schema IDs during construction[32m 42[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mconstructor[2m > [22mshould handle schemas without urn: prefix[32m 22[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mvalidate[2m > [22mshould pass validation for a valid payload[32m 14[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mvalidate[2m > [22mshould pass validation for valid Authorize payload[32m 10[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mvalidate[2m > [22mshould skip validation for unknown schema ID[32m 140[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mvalidate[2m > [22mshould throw OccurrenceConstraintViolation for missing required field[32m 50[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mvalidate[2m > [22mshould throw TypeConstraintViolation for wrong type[32m 24[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mvalidate[2m > [22mshould throw PropertyConstraintViolation for invalid enum value[32m 26[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mvalidate[2m > [22mshould throw FormatViolation for value exceeding maxLength[32m 40[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mvalidate[2m > [22mshould throw for additionalProperties violation[32m 15[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mhasSchema[2m > [22mshould return true for registered schema with urn: prefix[32m 11[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mhasSchema[2m > [22mshould return false for unregistered schema[32m 19[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mhasSchema[2m > [22mshould return true for non-urn schema[32m 8[2mms[22m[39m
 [32mΓ£ô[39m test/validator.test.ts[2m > [22mValidator[2m > [22mcreateValidator[2m > [22mshould create a Validator instance[32m 8[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"ou9rz2ihewybu6fjr3zgjygf","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274576,"meta":{"port":57944,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"takgzio3skm5rbtei0dtv4lm","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274581,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"l5nk551cuo4ha5d6dyi93k39","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274586,"meta":{"port":57945,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"qbfvlgjvxbnne5c1eg6s40rd","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274588,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"qqflns6zhhctuvpkc5w0s98f","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274592,"meta":{"port":57946,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould use default voltlog-io logger when no logging config is set
[22m[39m{"id":"k6z7gwou6ztloq1r2jxjnjv6","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274636,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_LOG_DEFAULT"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"nn30u7m6zmw7fki7kwuyu8w2","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274657,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould throw if identity is missing[32m 26[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould be in CLOSED state initially[32m 6[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"q2yqgq9djygjtjkx29idzpkx","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274660,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"h6tnd5352z3vqaqmimvjrpiz","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274664,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"g2f1s3a66hd4ipyj9tzxrxbg","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274666,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"qpw4aqbq0gawpczro6epn6vb","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274671,"meta":{"port":57954,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/queue.test.ts[2m > [22mQueue[2m > [22mshould initialize with concurrency of 1[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/queue.test.ts[2m > [22mQueue[2m > [22mshould accept a custom concurrency[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/queue.test.ts[2m > [22mQueue[2m > [22mshould enforce minimum concurrency of 1[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/queue.test.ts[2m > [22mQueue[2m > [22mshould execute a single task[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/queue.test.ts[2m > [22mQueue[2m > [22mshould execute tasks in order with concurrency 1[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/queue.test.ts[2m > [22mQueue[2m > [22mshould limit concurrent execution[32m 48[2mms[22m[39m
 [32mΓ£ô[39m test/queue.test.ts[2m > [22mQueue[2m > [22mshould reject with task errors[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/queue.test.ts[2m > [22mQueue[2m > [22mshould continue after task rejections[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/queue.test.ts[2m > [22mQueue[2m > [22mshould update concurrency dynamically[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/queue.test.ts[2m > [22mQueue[2m > [22mshould track size correctly[32m 1[2mms[22m[39m
[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould start listening on a port
[22m[39m{"id":"czeofnkpd056m304hmp99yw1","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274674,"meta":{"port":57955,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"sn5r2j590i9khjuhkjzqdxob","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274677,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould start listening on a port
[22m[39m{"id":"i65ifo9bkcmhfr6mubuee1al","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274678,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"lz8ew9gck55r73j93sy3d6vb","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274678,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"j4yuo6kvdcbkw3c0b56wq4xu","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274680,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"f7bm9aewpk5mgnyqgddws1q4","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274681,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"mgry49lq4y2ejl0vsdjbz2ia","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274683,"meta":{"port":57958,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"ikwcr0zxkz8psi7z4m80z0gw","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274685,"meta":{"port":57959,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"c9fnjygbazpbmb6hhl4ki3ma","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274694,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"h1t0b7z4iekv628z9d7e1zlp","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274695,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"i49btkfdd84989ow6z69d62b","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274698,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"j4ky3zq85512a0xajnfx9tfy","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274699,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"m0f34zos1iw4yr38zyvv7e70","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274703,"meta":{"port":57963,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"lc99scvvk1fxo2f3vl3rjpuw","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274718,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"oekw8h0jeikqcdwz57by7ola","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274723,"meta":{"port":57967,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"agqsxp8bt2suq6xbtlo8ks18","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274725,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"u7y78hfk88fduvprgu1u9oud","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274729,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"q4q7hnoo3v2m31rdmd2g8h6u","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274732,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"lou01ujjoz2fjjjxqbc8wdk6","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274733,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"b95gspz0ng60wlry3ws7nymm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274733,"meta":{"port":57971,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"pnfjjx1lwk6qknrwv6gjwavi","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274733,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"e9yvx62nwpsgj67d4gwk5lla","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274735,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"di4f7s0wgt3ltg1ew9nq37ji","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274736,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"kjj50jdud14e1x0ujvp70got","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274737,"meta":{"port":57972,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould expose static connection state constants
[22m[39m{"id":"ejfeobc1kr6wqae81rctcg3g","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274741,"meta":{"port":57973,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"dw7r2v9xct4jte7l0v8ll9mn","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274741,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"fz9tgmajh8jovnb4l4rcld5z","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274742,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould expose static connection state constants
[22m[39m{"id":"rgfgunmbaq3ie9ryryofrh0q","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274743,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Client[2m > [22mshould use default voltlog-io logger when no logging config is set[32m 116[2mms[22m[39m
 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Client[2m > [22mshould not log when logging is disabled[32m 16[2mms[22m[39m
 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Client[2m > [22mshould use custom handler when provided[32m 21[2mms[22m[39m
 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Client[2m > [22mshould log CALL sent and received[32m 18[2mms[22m[39m
 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Client[2m > [22mshould log incoming CALL and handler errors[32m 24[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"x8br6bnk78vwm12wudubqf93","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274744,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"rli4aqxkdf0l1afw2cbgl942","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274746,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"ckns6v9oz2mw76tiolmdm59k","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274746,"meta":{"port":57975,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould set identity correctly
[22m[39m{"id":"ajqn3fk9wt0yofpx6bgf8yfc","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274746,"meta":{"port":57976,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould set identity correctly
[22m[39m{"id":"yl2f38jddatrvlvec54gyhi0","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274748,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"rmif4ecdot0ahsdo2l1s8lsu","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274751,"meta":{"port":57978,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"crxo41tfmked024vd0z5ha86","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274751,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"o66r876gr7bhfshr4adyif39","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274751,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"svu94ef635ylzm0iscfyggcm","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274752,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"k4sbqfhusydl9oyyufrj2tek","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274754,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"nk0o2x896j4r0nrvr0yj2wl7","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274756,"meta":{"port":57980,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"goycsvgwai98gz763c77rehz","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274759,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"l5kw0nl3skkdlypo0yu0jvwc","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274760,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould connect successfully[32m 79[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould emit "open" event on connect[32m 14[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould reject connect when already connected[32m 18[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould close gracefully[32m 34[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould handle RPC call and response[32m 19[2mms[22m[39m
bun : [90mstderr[2m | 
test/client.test.ts[2m > 
[22m[2mOCPPClient[2m > [22m[2mshould 
receive NotImplemented for unhandled calls
At line:1 char:1
+ bun run vitest run --reporter=verbose 
2>&1 | Out-File -FilePath D:\pr ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : NotSpecified: 
    ([90mstderr[2m...unhandled calls:Str  
  ing) [], RemoteException
    + FullyQualifiedErrorId : NativeCommand 
   Error
 
[22m[39m{"id":"ky751rezos2bxj4vgqmx0izb","
level":50,"levelName":"ERROR","message":"Han
dler error","timestamp":1771530274763,"meta"
:{"messageId":"exob44pql67ohyla8ishfuip","me
thod":"UnhandledAction","error":"No handler 
for method: UnhandledAction"},"context":{"co
mponent":"OCPPClient","identity":"CS001"}}

[90mstderr[2m | test/client.test.ts[2m > 
[22m[2mOCPPClient[2m > [22m[2mshould 
receive NotImplemented for unhandled calls
[22m[39m{"id":"jg73nqda0t7ac55cbub2uz1d","
level":40,"levelName":"WARN","message":"CALL
ERROR ΓåÉ","timestamp":1771530274764,"meta":
{"messageId":"exob44pql67ohyla8ishfuip","met
hod":"UnhandledAction","errorCode":"NotImple
mented","errorMessage":"Requested method is 
not known","protocol":"ocpp1.6","latencyMs":
3,"errorDetails":{}},"context":{"component":
"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"xj8iz19kkvmvfb6dei1r3jn1","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274766,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"v6s91xnymabw0rc0wqez4l9x","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274767,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer[2m > [22mshould start listening on a port[32m 23[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer[2m > [22mshould reject connections without auth callback set[32m 63[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"khjm1l3kmpxh3j52ar5hwuld","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274770,"meta":{"port":57983,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | 
test/handshake-robustness.test.ts[2m > 
[22m[2mOCPPServer - Handshake 
Robustness[2m > [22m[2mshould emit 
upgradeAborted when client disconnects 
during auth
[22m[39m{"id":"rlprr7x1ifns4gnz3pc2pjid","
level":40,"levelName":"WARN","message":"Hand
shake aborted","timestamp":1771530274772,"me
ta":{"identity":"abort-test-01","reason":"So
cket closed during handshake"},"context":{"c
omponent":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould emit upgradeAborted when client disconnects during auth
[22m[39m{"id":"hl0vb9mag3my1mkv2a3cjdk7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274777,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"c5lylj6ozp1an7zm278owekb","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274780,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"reoxems500d1c96tac1i082o","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274781,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"oulguce558y1w26pipp35kx7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274785,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39mConnecting { url: [32m'ws://localhost:57978/CS001'[39m }

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"v5numw0tb115pjv0k6euhawr","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274787,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"ufuzpildfj5i9c228g681bx7","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274792,"meta":{"port":57987,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"xjopdmha5ie15enje1vedb3u","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274796,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"uwayq6obz7ao93wjlcud9zba","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274798,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"sq7fp0qemoq6k6sgebotkeus","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274799,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"zx10jx48y7uu8g16xng33sfz","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530274800,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"dv3vpqymlictgblc67wo2tbk","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274800,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"ybdk6t1uuecqam22yhei7gpc","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274801,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"y74vhmr31ekx4rd4mgwkjouw","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274804,"meta":{"port":57990,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mConstruction[2m > [22mshould throw if identity is missing[32m 25[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mConstruction[2m > [22mshould be in CLOSED state initially[32m 6[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mConstruction[2m > [22mshould expose static connection state constants[32m 7[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mConstruction[2m > [22mshould set identity correctly[32m 5[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"j9sv6bfbyrui1wlgoq4kwlxk","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274809,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"zzkvg08v78etjr7136xp8oz3","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274809,"meta":{"identity":"CS002","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"lrsb40vc2gqlrfwvs5iip8c3","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274810,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS002"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"yhnqsfhyhrm4rza6lt2ckvrc","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274811,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"k5w1cmtvbbs8i3ys89y5jf29","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274813,"meta":{"port":57992,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"e4qokb2ohvtsbqd44foex0s6","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530274812,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS002"}}
{"id":"ocu6ovxg7pr7u4b8nen722i9","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274813,"meta":{"identity":"CS002"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39mConnecting { url: [32m'ws://localhost:57992/CS001'[39m }

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"ys5lob37y7pkjcsujey4jfj9","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274814,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"lt34lri7osaliav4edxfcdb0","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274817,"meta":{"port":57994,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"l1t3n20l8wr2drh1u8wd3u63","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274817,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"epcv5o1ggf0vpr3ofnuzk3qt","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274821,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"ie7443nnq069k2oukbe0j0ps","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274820,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"vh12rolikt7dkx691liotuux","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274822,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/client.test.ts[2m > 
[22m[2mOCPPClient[2m > [22m[2mshould 
remove specific handlers
[22m[39m{"id":"fia85oqirnhja0hyi4bmgwfy","
level":50,"levelName":"ERROR","message":"Han
dler error","timestamp":1771530274823,"meta"
:{"messageId":"f83l6jwkwdh8elvt6dapyqin","me
thod":"Test","error":"No handler for 
method: Test"},"context":{"component":"OCPPC
lient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"a7pilg7ax49iuymq5xwzdo7h","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274822,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstderr[2m | test/client.test.ts[2m > 
[22m[2mOCPPClient[2m > [22m[2mshould 
remove specific handlers
[22m[39m{"id":"grsrexzlrq9y1owfm8hiy9ib","
level":40,"levelName":"WARN","message":"CALL
ERROR ΓåÉ","timestamp":1771530274823,"meta":
{"messageId":"f83l6jwkwdh8elvt6dapyqin","met
hod":"Test","errorCode":"NotImplemented","er
rorMessage":"Requested method is not known",
"protocol":"ocpp1.6","latencyMs":2,"errorDet
ails":{}},"context":{"component":"OCPPClient
","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"voccrekzm1orsoju4zt53pvw","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274824,"meta":{"port":57996,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"cbhlovr1pr9cyik2mhlakh73","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530274824,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"dgxtakuur86emltze29edm5s","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274825,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"fogzp6dz7hch0suw1md6dmik","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274825,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39mConnecting { url: [32m'ws://localhost:57996/CS001'[39m }

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"pmcpf2anajhl4wiqg26tcp9a","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274828,"meta":{"port":57998,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"y7og3yuh82pi4tc3ytg9is7w","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274829,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"rmv03g2w3829ftovruotbsyk","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274831,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"fsktars9jjkqtjfsso6mu1tw","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274831,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"rwi1mgkxbe6b7rsen740c0ka","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274832,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"s4bmzy9q7lwwk5w13zu2eoya","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274835,"meta":{"port":58000,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"hfugjk9t8ho3m7pk8myzi4nf","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274835,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39mConnecting { url: [32m'ws://localhost:58000/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"v46duji31k2lp2n7y4fwzxf6","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274838,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"ln8l1elh62apcmlscqs4jnds","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274841,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"km0f0l367pdvtxr1sb41bcrh","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274841,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"o0plqepupyweglkq8sx7mcfw","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274844,"meta":{"port":58002,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39mConnecting { url: [32m'ws://localhost:58002/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"udl0m18a1qg0j5el48f6r3vh","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274847,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"pxk1ipu6vk6d03fe5b9f8p85","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274851,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"kzsv8t041dxbgp5f36b7nrb4","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274851,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"pplk0ytuy6sjbfoqiekw45y6","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274853,"meta":{"port":58004,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39mConnecting { url: [32m'ws://localhost:58004/CS%2F001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"y7j9ud22vwv3zdnpv2my8sqq","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274856,"meta":{"identity":"CS/001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"dzvwjgd0eqk3w74nlcfygqzj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274857,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"nj1hqsjkxe9s1mmg2n1e5pzm","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274858,"meta":{"identity":"CS/001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"xs24yqf0sad6glmkz4r0boot","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274860,"meta":{"port":58006,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39mConnecting { url: [32m'ws://localhost:58006/CS001?token=abc123'[39m }

 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Client[2m > [22mshould log CALLERROR received[32m 23[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"ltgjo34j3q3it157gwww1gar","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274864,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"qcqm1vk6lzka73huooph6qii","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530274865,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"ylr7jojga07918l34pk2vaxm","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274865,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"lt3fnso39rvmpwvzihk9usvq","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274866,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"rz3u2udnh6rpzuxghctdb259","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274867,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"j3f05xvej5q5bwitxisu79ry","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274867,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"s7wejusq7m4j0kcu0d03v660","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274869,"meta":{"port":58009,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"sck3bbaasnl2hi70g1l15nw4","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274869,"meta":{"port":58010,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39mConnecting { url: [32m'ws://localhost:58010/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"naah1nectapyg345b3olcane","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274872,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"vmn7d8nsio00ewre5auw6ph0","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274872,"meta":{"identity":"CS_EMIT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"c7mlrzj2cl87656f6ixepflw","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274873,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_EMIT"}}

 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer[2m > [22mshould expose connected clients[32m 123[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"goiqhbbkz9n3r0bbsrajlq9i","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274875,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"shkh9wksq3yd0elatsr1x5dq","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274875,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"e1m9nkq7iip52n2on9l2c4qv","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274876,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"nx6nzlz21h4gdyf7qf64yofp","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274876,"meta":{"identity":"CS_EMIT"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/handshake-robustness.test.ts[2m > [22mOCPPServer - Handshake Robustness[2m > [22mshould emit upgradeAborted when client disconnects during auth[32m 173[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould receive NotImplemented for unhandled calls[32m 15[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould support abort signal on calls[32m 22[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould receive calls from server[32m 12[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould handle wildcard handlers[32m 13[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient[2m > [22mshould remove specific handlers[32m 11[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"zim0rdb7aau5lhq0soeuzs2j","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274878,"meta":{"port":58013,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections via auth callback
[22m[39m{"id":"qjmbyk8hdjsw66p8gp3935wp","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274879,"meta":{"port":58014,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39mConnecting { url: [32m'ws://localhost:58013/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"r82yz6znoavpcdlt934bj4tg","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274882,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstderr[2m | test/server.test.ts[2m > 
[22m[2mOCPPServer[2m > [22m[2mshould 
reject connections via auth callback
[22m[39m{"id":"u1s7c1jjghb926tn5ij624gv","
level":40,"levelName":"WARN","message":"Auth
 rejected","timestamp":1771530274882,"meta":
{"identity":"CS_REJECTED","code":401},"conte
xt":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"o8vyvxplbwvtutbu8h8ue5i0","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274884,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/server.test.ts[2m > 
[22m[2mOCPPServer[2m > [22m[2mshould 
reject connections via auth callback
[22m[39m{"id":"zaw341p54so3am6qcgijiu51","
level":50,"levelName":"ERROR","message":"Une
xpected HTTP response","timestamp":177153027
4884,"meta":{"statusCode":401},"context":{"c
omponent":"OCPPClient","identity":"CS_REJECT
ED"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"m7sefh5ec3csue2w8cquk0s8","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274885,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections via auth callback
[22m[39m{"id":"s9wkd17ryhu528acbe3uy11u","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274886,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould return immediately when already closed
[22m[39m{"id":"y1xzm58oq9se2qup52wouvde","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274887,"meta":{"port":58017,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"n4w3y00rx6h9kzog6jiw3eoe","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274889,"meta":{"port":58018,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould return immediately when already closed
[22m[39m{"id":"kjkipth8w3mw295r4ohae3o8","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274889,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"r6yoeg1zj7y6yui4k7pquh8n","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274891,"meta":{"port":58020,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"j7e7uysc6psn7s9a6vm3r94t","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274892,"meta":{"identity":"MY-STATION-123","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39mConnecting { url: [32m'ws://localhost:58020/CS001'[39m }

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"rzop0i0s5kjqjwhq1pyznl93","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274893,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"MY-STATION-123"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"tmmfbnzr5wxuom0bk08i5no9","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274894,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"a80n3wt8xqvnhfvhdc710y93","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274895,"meta":{"identity":"MY-STATION-123"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"u8rj2c525nsaq7d26ql7kdc5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274896,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"z7j8nzhprf72obw7p8965r0j","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274898,"meta":{"port":58022,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"zunrostimhwub75t5dj1nlfy","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274900,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"vg2pjbhokqiz7b9agnih0l5g","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274901,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"xizmulp9ob8pf7dyveyui26u","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274902,"meta":{"identity":"CS_DISC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"cc8noquxk82x3o0g86rkbw0x","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274903,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_DISC"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"wbnfca97ru7447hzmdfqq6dd","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274903,"meta":{"port":58024,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39mConnecting { url: [32m'ws://localhost:58024/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"mmna58t1bcmbqu4okl9y58ui","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274906,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mConnection[2m > [22mshould connect successfully[32m 62[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mConnection[2m > [22mshould set protocol after connection[32m 11[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mConnection[2m > [22mshould emit "open" event on connect[32m 10[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mConnection[2m > [22mshould emit "connecting" event before WebSocket opens[32m 9[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mConnection[2m > [22mshould reject connect when already connected[32m 10[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mConnection[2m > [22mshould build endpoint with identity appended[32m 6[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mConnection[2m > [22mshould append query params to endpoint[32m 10[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mClose[2m > [22mshould close gracefully[32m 8[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mClose[2m > [22mshould emit close event[32m 9[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mClose[2m > [22mshould return immediately when already closed[32m 4[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mClose[2m > [22mshould handle double close gracefully[32m 12[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"m1qrm655vut83lllahqztzqm","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274908,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"lad2mwins1usfhzmdpkioh0d","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274909,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"ks8bg54cbhv00bx70fzpcbpq","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274911,"meta":{"port":58026,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39mConnecting { url: [32m'ws://localhost:58026/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"sv6y3b52ctsjhmikcg35kdwt","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274914,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"g6dh1yyrhnc91fhn6ifagech","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274916,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"z4mjz98fi7rc322z0p7d909p","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274917,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"kwzmdffm0nslrgzahzek88mo","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274920,"meta":{"port":58028,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39mConnecting { url: [32m'ws://localhost:58028/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"svpywigys86tigv2hhnwrrxc","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274923,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39mCALL ΓåÆ {
  messageId: [32m'e37gsx63ka1amvl73n7qqvss'[39m,
  method: [32m'BootNotification'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: { chargePointVendor: [32m'TestVendor'[39m, chargePointModel: [32m'TestModel'[39m }
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39mCALLRESULT ΓåÉ {
  messageId: [32m'e37gsx63ka1amvl73n7qqvss'[39m,
  method: [32m'BootNotification'[39m,
  protocol: [32m'ocpp1.6'[39m,
  latencyMs: [33m3[39m,
  payload: {
    status: [32m'Accepted'[39m,
    currentTime: [32m'2026-02-19T19:44:34.926Z'[39m,
    interval: [33m300[39m
  }
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"rcrsxliz6r8lwoeh1dlbthy3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274930,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"al1qa5thxfwhy09o5k1p87mk","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274934,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"lyy90qrusaufm6ewe58cnvrv","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274936,"meta":{"port":58030,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39mConnecting { url: [32m'ws://localhost:58030/CS001'[39m }

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"gb8n2id4hz7p7754ihtf2em9","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530274938,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"zid5129td74h7xq0qdh1f0l3","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274938,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"h7gg0m5iaflxk7yud1jzm7hz","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274939,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"l1jt7hlkk9n5emahjsy3cb8r","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274941,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39mCALL ΓåÆ {
  messageId: [32m'n2ntrp7l9o7r71o0qxgqktws'[39m,
  method: [32m'UnknownMethod'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"mxmpube10zav0unqy6ku26fk","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274942,"meta":{"port":58032,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mRPC Calls[2m > [22m[2mshould 
receive call error from server
[22m[39m{"id":"sbc3bp83v6v94k5zpqm46ee1","
level":50,"levelName":"ERROR","message":"Han
dler error","timestamp":1771530274943,"meta"
:{"messageId":"n2ntrp7l9o7r71o0qxgqktws","me
thod":"UnknownMethod","error":"No handler 
for method: UnknownMethod"},"context":{"comp
onent":"OCPPClient","identity":"CS001"}}

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mRPC Calls[2m > [22m[2mshould 
receive call error from server
[22m[39mCALLERROR ΓåÉ {
  messageId: 
[32m'n2ntrp7l9o7r71o0qxgqktws'[39m,
  method: [32m'UnknownMethod'[39m,
  errorCode: [32m'NotImplemented'[39m,
  errorMessage: [32m'Requested method is 
not known'[39m,
  protocol: [32m'ocpp1.6'[39m,
  latencyMs: [33m2[39m,
  errorDetails: {}
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"ggd4kxngaxsud3ie477be0k9","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274946,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"tl4pdd0wri1cgmmno68tu8ar","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274946,"meta":{"identity":"CS_VERSIONED","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"aye3ydh6zatdi9y8k595snvb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274947,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"v68fi2j8odo87jeo7ticki2v","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274947,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VERSIONED"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould reject calls when not connected
[22m[39m{"id":"hjcemjmhgw40lt5hk72t565c","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274949,"meta":{"port":58034,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"pkjc7168qwzon3esnv790vmu","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530274949,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_VERSIONED"}}
{"id":"zi6i48aqf7xv42xz5enkf03s","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274949,"meta":{"identity":"CS_VERSIONED"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"lnuawiq7358g2b7u20xoxsqj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274950,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould reject calls when not connected
[22m[39m{"id":"bk65x4zxa3yj32ekbwituwpx","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274952,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"tdwxfy0a7ljngaj3pdgxwpqu","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274953,"meta":{"port":58035,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"ye3k9x7d8jj3wcrs4itrf885","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274955,"meta":{"port":58036,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39mConnecting { url: [32m'ws://localhost:58036/CS001'[39m }

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"ndhpenlzrvya71wacucfded1","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274957,"meta":{"identity":"CS_CTX","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"t1mawqed0ez9l6lijhl35tbm","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274958,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_CTX"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"deaxb52bc8pkbzypst2lvo7k","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274959,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"v8tizdmy6uftndipqi638dqv","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530274960,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_CTX"}}
{"id":"d27ogor83q6a4pych1vgoqhz","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274960,"meta":{"identity":"CS_CTX"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39mCALL ΓåÆ {
  messageId: [32m'h4logs1bbp59rvfxqfuvdfdh'[39m,
  method: [32m'SlowMethod'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"pn0191qdyugueav8twvgc2ig","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274961,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"gprf934fpzszfgte3n64a0eb","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274964,"meta":{"port":58039,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"wpv0is1qsyaemjd63zb0uwvf","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274967,"meta":{"identity":"CS_PRIORITY","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"vs5cn0v4f5zyk26tmvlqk3aw","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274968,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PRIORITY"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"g9mczmhper3u7m6dyjof74d1","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530274970,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_PRIORITY"}}
{"id":"njqjlwshi6p91imenqlc8thq","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274973,"meta":{"identity":"CS_PRIORITY"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"ccm4003xpilgwl0jgdjcgj0c","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274974,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"w6uvoh7mzvc6fo9x7nrds80g","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274978,"meta":{"port":58043,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer[2m > [22mshould emit "client" event when a station connects[32m 10[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer[2m > [22mshould reject connections via auth callback[32m 10[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer[2m > [22mshould parse identity from URL path[32m 9[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"dn257nhorfs1sg2jz0emaimm","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274981,"meta":{"identity":"CS_FALLBACK","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"jl50ir20rylyyckoynbgkh27","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274985,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_FALLBACK"}}

 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Security Profiles[2m > [22mshould include Basic Auth header for Profile 1[32m 114[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mVersion-Aware Handle[2m > [22mshould support version-specific handler with typed params[32m 10[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mVersion-Aware Handle[2m > [22mshould expose protocol in HandlerContext for generic handlers[32m 11[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mVersion-Aware Handle[2m > [22mshould prioritize version-specific handler over generic handler[32m 14[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"bmsf3v8clvh7f0nt4oaa12lz","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530274987,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_FALLBACK"}}
{"id":"ka2854cijx5hz55axbp8h0dd","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274988,"meta":{"identity":"CS_FALLBACK"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"bptd43kehuzuq1dmt6qunkqt","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530274989,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"yhl0g3cl8e16cw11qu0ny1js","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530274992,"meta":{"port":58045,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"k80kj4c9lr2z4nz498mngrpc","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530274994,"meta":{"identity":"CS_WILDCARD","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"hqld4rs49yrsxnu17tx7b6qv","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530274996,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_WILDCARD"}}

[90mstderr[2m | 
test/handshake-robustness.test.ts[2m > 
[22m[2mOCPPServer - Handshake 
Robustness[2m > [22m[2mshould abort 
handshake on timeout
[22m[39m{"id":"hiqx3nr9v99wxd4abkn8b3xz","
level":40,"levelName":"WARN","message":"Hand
shake aborted","timestamp":1771530274996,"me
ta":{"identity":"timeout-test-01","reason":"
Handshake timeout"},"context":{"component":"
OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould abort handshake on timeout
[22m[39m{"id":"nbxp77gakh5i7a9y4p5r6ds6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275000,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"kw5iacxew76352l5xwq2oo1o","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530274999,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_WILDCARD"}}
{"id":"i0jljwgnn8e5r4om41t2bs48","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530274999,"meta":{"identity":"CS_WILDCARD"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"fpakoi67z4q51m42zi65zksd","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275007,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould connect successfully with valid auth
[22m[39m{"id":"s6t2zabo3b7etsdwnvbg770o","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275009,"meta":{"identity":"valid-test-01","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"i7me7jvaxcr94cuhoz81rpgr","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275011,"meta":{"port":58049,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mClose[2m > [22mshould close with force option[32m 8[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mClose[2m > [22mshould close with custom code and reason[32m 8[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mRPC Calls[2m > [22mshould send a call and receive a response[32m 16[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mRPC Calls[2m > [22mshould receive call error from server[32m 13[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mRPC Calls[2m > [22mshould reject calls when not connected[32m 5[2mms[22m[39m
[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould connect successfully with valid auth
[22m[39m{"id":"pmhcejj1rc5j0hvjfx45y0xp","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275014,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"x8pr54gbwz1yoabo29gzfcrr","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275017,"meta":{"identity":"CS_RMALL","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"xazxeeo3ck1vw3finifc64q6","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530275017,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_DISC"}}
{"id":"kpx1xz4kf0kwy9at916atgju","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275017,"meta":{"identity":"CS_DISC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould connect successfully with valid auth
[22m[39m{"id":"p1iv2ny9ikwgqql9k9a8lf2x","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275019,"meta":{"identity":"valid-test-01"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/client.test.ts[2m > 
[22m[2mOCPPClient - Advanced Features[2m 
> [22m[2mshould remove all handlers with 
removeAllHandlers
[22m[39m{"id":"j2jprrx7nf9o2rs5024ht4pb","
level":50,"levelName":"ERROR","message":"Han
dler error","timestamp":1771530275019,"meta"
:{"messageId":"u0vovaj257beozk0w15peapd","me
thod":"Heartbeat","error":"No handler for 
method: Heartbeat"},"context":{"component":"
OCPPClient","identity":"CS_RMALL"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"o9jgs329dk47j53uzc1xj7ju","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275018,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RMALL"}}

[90mstderr[2m | test/client.test.ts[2m > 
[22m[2mOCPPClient - Advanced Features[2m 
> [22m[2mshould remove all handlers with 
removeAllHandlers
[22m[39m{"id":"vaf5w2bwc4s5mlaa2t69z94o","
level":40,"levelName":"WARN","message":"CALL
ERROR ΓåÉ","timestamp":1771530275020,"meta":
{"messageId":"u0vovaj257beozk0w15peapd","met
hod":"Heartbeat","errorCode":"NotImplemented
","errorMessage":"Requested method is not kn
own","protocol":"ocpp1.6","latencyMs":2,"err
orDetails":{}},"context":{"component":"OCPPC
lient","identity":"CS_RMALL"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"i34slv16khqihtoiwy58wx35","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530275021,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_RMALL"}}
{"id":"xytycz6domf24obfff6f9j4a","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275021,"meta":{"identity":"CS_RMALL"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"yvsxmwvi4k5c3r2bayderlp6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275022,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould support colons in identity via Basic Auth
[22m[39m{"id":"iekcuvq9u38hnr1gbp29kka3","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275025,"meta":{"identity":"station:01","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"jp22afbsvyzcbl4f8fpeuinu","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275025,"meta":{"port":58053,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould support colons in identity via Basic Auth
[22m[39m{"id":"x8lh2045b7bgohh5tx2lczvi","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275027,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould support colons in identity via Basic Auth
[22m[39m{"id":"zik1bgnzav1piem0zt7iu4sj","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275029,"meta":{"identity":"station:01"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"nj1vahr61fiwyn3wry9f9wcf","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275029,"meta":{"identity":"CS_RAW","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"yukb6d5m2fwvtlyu31mfpk45","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275032,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RAW"}}

 [32mΓ£ô[39m test/handshake-robustness.test.ts[2m > [22mOCPPServer - Handshake Robustness[2m > [22mshould abort handshake on timeout[32m 222[2mms[22m[39m
 [32mΓ£ô[39m test/handshake-robustness.test.ts[2m > [22mOCPPServer - Handshake Robustness[2m > [22mshould connect successfully with valid auth[32m 19[2mms[22m[39m
 [32mΓ£ô[39m test/handshake-robustness.test.ts[2m > [22mOCPPServer - Handshake Robustness[2m > [22mshould support colons in identity via Basic Auth[32m 10[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould initialize with concurrency of 1[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould accept a custom concurrency[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould enforce minimum concurrency of 1[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould execute a single task[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould execute tasks in order with concurrency 1[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould limit concurrent execution[32m 42[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould reject with task errors[32m 3[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould continue after task rejections[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould update concurrency dynamically[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould enforce minimum concurrency of 1 in setConcurrency[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould track size correctly[32m 9[2mms[22m[39m
 [32mΓ£ô[39m test/browser-queue.test.ts[2m > [22mBrowser Queue[2m > [22mshould drain pending tasks when concurrency increases[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Client[2m > [22mshould log disconnect[32m 215[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mVersion-Aware Handle[2m > [22mshould fall back to generic handler when version-specific is removed[32m 14[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mVersion-Aware Handle[2m > [22mshould handle wildcard for unknown methods[32m 18[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mVersion-Aware Handle[2m > [22mshould return securityProfile from options[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mVersion-Aware Handle[2m > [22mshould default securityProfile to NONE[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mVersion-Aware Handle[2m > [22mshould throw when calling sendRaw while not connected[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Advanced Features[2m > [22mshould remove all handlers with removeAllHandlers[32m 14[2mms[22m[39m
 [32mΓ£ô[39m test/generate-types.test.ts[2m > [22mType Generation Script[2m > [22mshould generate files using main() function[32m 27[2mms[22m[39m
 [32mΓ£ô[39m test/generate-types.test.ts[2m > [22mType Generation Script[2m > [22mshould convert JSON schema to TS[32m 0[2mms[22m[39m
[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"r2ke1spptfzeeow7t8luxspv","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275129,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"mmfmcv591im850wh037neyo9","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275133,"meta":{"port":58057,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"wc95zscsk49y4we9bqay6pzc","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275137,"meta":{"identity":"CS_CLOSE_ALL","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"q7hw4cstwp98c4gqjio2trdh","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275138,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_CLOSE_ALL"}}

[90mstderr[2m | test/client.test.ts[2m > 
[22m[2mOCPPClient - Advanced Features[2m 
> [22m[2mshould send raw message via 
sendRaw
[22m[39m{"id":"y0ncgoy3ecsjcbaql3k17dtu","
level":40,"levelName":"WARN","message":"Bad 
message","timestamp":1771530275148,"meta":{"
error":"Unexpected token 'o', 
\"not-valid-ocpp\" is not valid JSON","count
":1},"context":{"component":"OCPPClient","id
entity":"CS_RAW"}}

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mRPC Calls[2m > [22m[2mshould 
timeout calls that take too long
[22m[39mCall timed out {
  messageId: 
[32m'h4logs1bbp59rvfxqfuvdfdh'[39m,
  method: [32m'SlowMethod'[39m,
  timeoutMs: [33m200[39m
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"j4e27vt6digo6dgu0qesydhj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275168,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"x6b04iu1mkfqd35fk1kfasx1","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275168,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"v8gbucvdez2tjt3qyx27mod9","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275171,"meta":{"port":58059,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39mConnecting { url: [32m'ws://localhost:58059/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"jko9al266l10usal7vvzmhq9","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275175,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39mCALL ΓåÆ {
  messageId: [32m'ba6mrwi9zkiiwqj1vt0n299v'[39m,
  method: [32m'Heartbeat'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39mCALLRESULT ΓåÉ {
  messageId: [32m'ba6mrwi9zkiiwqj1vt0n299v'[39m,
  method: [32m'Heartbeat'[39m,
  protocol: [32m'ocpp1.6'[39m,
  latencyMs: [33m1[39m,
  payload: { currentTime: [32m'2026-02-19T19:44:35.177Z'[39m }
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"vhricxpwzcyt5hy0862qemjv","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275178,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"t0y5gc05r980fiey804b3y1h","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275179,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"eawh1y4wpkg5zcueie7uwzv3","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275182,"meta":{"port":58061,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39mConnecting { url: [32m'ws://localhost:58061/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"agg5rccrtnyqw1zdwo41cxhk","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275185,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39mCALL ΓåÆ {
  messageId: [32m'drjianf66n6nwf8kg5sxy71w'[39m,
  method: [32m'Heartbeat'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39mCALLRESULT ΓåÉ {
  messageId: [32m'drjianf66n6nwf8kg5sxy71w'[39m,
  method: [32m'Heartbeat'[39m,
  protocol: [32m'ocpp1.6'[39m,
  latencyMs: [33m1[39m,
  payload: { currentTime: [32m'2026-02-19T19:44:35.187Z'[39m }
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"ti3j53u1jcvybu29bfzbs363","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275189,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"f9ofc7cmiv9qfv7f0m0aowje","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275190,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"fl88rlqb8tsm6u5f5v2i3783","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275192,"meta":{"port":58063,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39mConnecting { url: [32m'ws://localhost:58063/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"a7eoans9xxvmwnafhmsvv89i","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275197,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39mCALL ΓåÆ {
  messageId: [32m'fvdngbyhan72kq8if0rct58i'[39m,
  method: [32m'Heartbeat'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}
CALL ΓåÆ {
  messageId: [32m'n13v000orj16qo6699e592lw'[39m,
  method: [32m'Heartbeat'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}
CALL ΓåÆ {
  messageId: [32m'cggwf3fy8c19c2wtayew03vo'[39m,
  method: [32m'Heartbeat'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39mCALLRESULT ΓåÉ {
  messageId: [32m'fvdngbyhan72kq8if0rct58i'[39m,
  method: [32m'Heartbeat'[39m,
  protocol: [32m'ocpp1.6'[39m,
  latencyMs: [33m3[39m,
  payload: { currentTime: [32m'2026-02-19T19:44:35.202Z'[39m }
}
CALLRESULT ΓåÉ {
  messageId: [32m'n13v000orj16qo6699e592lw'[39m,
  method: [32m'Heartbeat'[39m,
  protocol: [32m'ocpp1.6'[39m,
  latencyMs: [33m3[39m,
  payload: { currentTime: [32m'2026-02-19T19:44:35.202Z'[39m }
}
CALLRESULT ΓåÉ {
  messageId: [32m'cggwf3fy8c19c2wtayew03vo'[39m,
  method: [32m'Heartbeat'[39m,
  protocol: [32m'ocpp1.6'[39m,
  latencyMs: [33m2[39m,
  payload: { currentTime: [32m'2026-02-19T19:44:35.202Z'[39m }
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"mafgwu73uv6ymt1ye75ryjzj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275206,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"g0f26vu88o12bh4dxh1bjfqb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275207,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"r21sdwhoxpzxukd2bljzluk6","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275210,"meta":{"port":58065,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39mConnecting { url: [32m'ws://localhost:58065/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"a770m0qem7vdqbyqf6zatwdp","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275213,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39mCALL ΓåÆ {
  messageId: [32m'lwotfzftczyua7dtls9tugrx'[39m,
  method: [32m'SlowMethod'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer[2m > [22mshould remove client on disconnect[32m 234[2mms[22m[39m
[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"rfjlsps0jpo436dsc4m4nrt4","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275248,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"z5t4mdgu95cfoqo8o94006a9","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530275251,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_CLOSE_ALL"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"uk3xm2sh8vmlcfc98ockf8de","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275252,"meta":{"identity":"CS_CLOSE_ALL"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"m4kem2ejbibfmkv2sw32m8g4","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275256,"meta":{"port":58067,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"l7j4w881iyrqlin1p0rsq9v8","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275261,"meta":{"identity":"CS_INHERIT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"u2u1jfbt9h7de3s9gral8tu0","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275262,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_INHERIT"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"sd9yk7d3pu8jnwvbo9mxtntw","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275264,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"r1dwyog3v1ayp0oyxb19oyss","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275266,"meta":{"identity":"CS_INHERIT"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mRPC Calls[2m > [22mshould timeout calls that take too long[32m 216[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mRPC Calls[2m > [22mshould emit message event when sending a call[32m 11[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mRPC Calls[2m > [22mshould emit callResult event when receiving a response[32m 11[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mRPC Calls[2m > [22mshould support concurrent calls with callConcurrency > 1[32m 17[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"pacczb3vhf4dp90s9m4kl0n1","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275269,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"s0w2cu0qurupeag4qed3byn4","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275270,"meta":{"port":58069,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"tqcyc12yn7f53ruqwugd78uq","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275270,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"mvv47rwif5jpp8xgodgjsjyg","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275273,"meta":{"port":58070,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39mConnecting { url: [32m'ws://localhost:58070/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"ullrgm6km12y3o4cnzq7rckb","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275277,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"b7x2hg1qkcbe7hy2g3szjhfc","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275277,"meta":{"identity":"CS_NO_CONNECT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"s23dysh6wr5q01hfwyqvtv4b","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275279,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_NO_CONNECT"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"d1vp2hy5jr1pthbvjob49sdf","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275280,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"hskrfqt7p5poegx46qyyzzte","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275280,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"xlr8rbfvj27rjxg3kt963fgv","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275283,"meta":{"identity":"CS_NO_CONNECT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"cholz8kcfepclok5ijl9syqx","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275283,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"gsfg8uz17vy2o0uvv9gtrens","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275286,"meta":{"port":58074,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"hgumlmrmfg1zfamlt6dtbvnx","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275286,"meta":{"port":58073,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39mConnecting { url: [32m'ws://localhost:58074/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"f6nnpengx93u5do0evpsl27o","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275290,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"fklrz1laf0d72rf8vgfpfdsq","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275290,"meta":{"identity":"CS_SESSION","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"gcz0ue02jf7oeywv50uqaejl","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275291,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_SESSION"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"k9iiyyx2dqe5xc0catle7uvj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275292,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"fheilvnpmwmwuhbnfv3vjyyj","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275294,"meta":{"identity":"CS_SESSION"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould expose handleUpgrade getter for external HTTP servers
[22m[39m{"id":"ezo8791wbapyhj5ycz09ng32","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275297,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"hq9kui07kal0p6huzvt3jz7r","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275300,"meta":{"port":58077,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"x155f09xn0d1y23031d6b6hn","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275307,"meta":{"identity":"CS_EXT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"pxpc3nvyv4vne5ft163bdbgy","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275308,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_EXT"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"zt9focpj8wciz1nolje3am8q","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275310,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"ceghw6hkzr6t8mxit0cf643k","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275311,"meta":{"identity":"CS_EXT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould reconfigure server options at runtime
[22m[39m{"id":"t6ggwks3ilvv4xt2i0icsbcj","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275314,"meta":{"port":58080,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould reconfigure server options at runtime
[22m[39m{"id":"etg8yv8nefb6snkope9ugtrl","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275315,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould set and use a custom adapter
[22m[39m{"id":"x7r5erca21b2uegz59q0ixjp","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275320,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould no-op publish when no adapter is set
[22m[39m{"id":"j52ofno8n60l823zeavnwxgn","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275321,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould close server via abort signal
[22m[39m{"id":"m3esqsuzsthbi8s8cb4fb4gc","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275324,"meta":{"port":58081,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"cjkgsueyrbjs6mq0s7f6yzou","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530275349,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_RAW"}}
{"id":"sr0seg9j80i9uvtzeigmnljv","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275350,"meta":{"identity":"CS_RAW"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"crsss9cyaehdqx9helk8hcw5","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275350,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Advanced Features[2m > [22mshould send raw message via sendRaw[33m 328[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"vpdvr0fuw95boyq1fi82luum","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275353,"meta":{"port":58082,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"xqmein9kzo4cl31bgkgdfnsh","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275357,"meta":{"identity":"CS_RECONF","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"z91klluklyg8bi4rszncdxfo","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275358,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONF"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"t9ydye0ka6vtx72ivj4xi02y","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275359,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"v28lht4m15vdm79pt6c7dn2s","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275360,"meta":{"identity":"CS_RECONF"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"ap40jjjds2o8gettxrfuigfy","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275364,"meta":{"port":58084,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer[2m > [22mshould close all clients on server close[32m 122[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServerClient[2m > [22mshould inherit options from server[32m 15[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServerClient[2m > [22mshould reject connect() call[32m 16[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServerClient[2m > [22mshould expose session data[32m 11[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22mshould expose handleUpgrade getter for external HTTP servers[32m 3[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22mshould allow handleUpgrade to be called from an external server[32m 14[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22mshould reconfigure server options at runtime[32m 6[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22mshould set and use a custom adapter[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22mshould no-op publish when no adapter is set[32m 1[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"fvencpi7120aeoafw2f419wc","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275371,"meta":{"identity":"CS_RECONF_STRICT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"ci93v3qr7gup4k902a0bwpmz","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275372,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONF_STRICT"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"p5v222h7mjcjh9yw2w90fbsj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275373,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"nekiftgiklz8rueo8twov9fn","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275374,"meta":{"identity":"CS_RECONF_STRICT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"sa665gcyxn0kjkydjed98kn8","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275377,"meta":{"port":58086,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mRPC Calls[2m > [22mshould abort a call with AbortSignal[32m 63[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mRPC Calls[2m > [22mshould immediately reject if AbortSignal is already aborted[32m 14[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"te3ju1c86xxpg25as3vvmesz","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275384,"meta":{"identity":"CS_RECONF_PING","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"zmic3au6tvzpmws2p9t9vq27","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275386,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONF_PING"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"kgvlv55mabi03j3ejidablq6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275389,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"d9vfuuu8m6lw79iwd1m58u94","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275392,"meta":{"identity":"CS_RECONF_PING"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"uat1pfnbhkmw4kus9vxuimb2","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275396,"meta":{"port":58088,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39mCALL ΓåÉ {
  messageId: [32m'hgidxn896t3qq2hgqpi9uuse'[39m,
  method: [32m'Reset'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: { type: [32m'Hard'[39m }
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"npgnbznsu277zzatk5fpurrl","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275403,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"x0wkkwh5yperhayjaon32k5g","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275404,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"ui34t4fc87f5309hj9zf90n6","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275405,"meta":{"identity":"CS_BADMSG","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"hu4maixvkpwvuyzlua8ymu0x","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275405,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BADMSG"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"h67ike4s3axbcd6ngydxle3p","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275406,"meta":{"port":58090,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39mConnecting { url: [32m'ws://localhost:58090/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"gy5esr28h99aeuwikumv3fe6","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275409,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould close server via abort signal
[22m[39m{"id":"ydffqv0d9iw29yl25rr9zf3c","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275430,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"rohw8mh4y4kiy8rcr4wuhr0o","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275434,"meta":{"port":58092,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"epou2cmrnv64jr04hlufg1y7","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275448,"meta":{"identity":"CS_BC_1","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"s5fdcx8ei1zd66trfd4n4vz4","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275450,"meta":{"identity":"CS_BC_2","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"yydy17u31xh64f9t8mnvfatr","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275451,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BC_1"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"uq204jkszwjy4tootlpstix2","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275452,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BC_2"}}

 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Advanced Features[2m > [22mshould reconfigure options at runtime[32m 10[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Advanced Features[2m > [22mshould reconfigure and re-setup validators when strictMode changes[32m 14[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Advanced Features[2m > [22mshould reconfigure ping interval[32m 18[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mTimeoutError should have correct properties[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mTimeoutError should have default message[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCGenericError should have correct code[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCGenericError should default details to empty object[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCGenericError should carry details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCNotImplementedError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCNotImplementedError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCNotImplementedError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCNotImplementedError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCNotImplementedError[2m > [22mshould accept custom message and details[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCNotSupportedError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCNotSupportedError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCNotSupportedError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCNotSupportedError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCNotSupportedError[2m > [22mshould accept custom message and details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCInternalError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCInternalError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCInternalError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCInternalError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCInternalError[2m > [22mshould accept custom message and details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCProtocolError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCProtocolError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCProtocolError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCProtocolError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCProtocolError[2m > [22mshould accept custom message and details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCSecurityError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCSecurityError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCSecurityError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCSecurityError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCSecurityError[2m > [22mshould accept custom message and details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFormationViolationError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFormationViolationError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFormationViolationError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFormationViolationError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFormationViolationError[2m > [22mshould accept custom message and details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFormatViolationError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFormatViolationError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFormatViolationError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFormatViolationError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFormatViolationError[2m > [22mshould accept custom message and details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCPropertyConstraintViolationError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCPropertyConstraintViolationError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCPropertyConstraintViolationError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCPropertyConstraintViolationError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCPropertyConstraintViolationError[2m > [22mshould accept custom message and details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCOccurrenceConstraintViolationError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCOccurrenceConstraintViolationError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCOccurrenceConstraintViolationError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCOccurrenceConstraintViolationError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCOccurrenceConstraintViolationError[2m > [22mshould accept custom message and details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCTypeConstraintViolationError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCTypeConstraintViolationError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCTypeConstraintViolationError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCTypeConstraintViolationError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCTypeConstraintViolationError[2m > [22mshould accept custom message and details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCMessageTypeNotSupportedError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCMessageTypeNotSupportedError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCMessageTypeNotSupportedError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCMessageTypeNotSupportedError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCMessageTypeNotSupportedError[2m > [22mshould accept custom message and details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFrameworkError[2m > [22mshould have correct rpcErrorCode[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFrameworkError[2m > [22mshould have correct name[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFrameworkError[2m > [22mshould extend Error[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFrameworkError[2m > [22mshould have a non-empty rpcErrorMessage[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mRPCFrameworkError[2m > [22mshould accept custom message and details[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-errors.test.ts[2m > [22mBrowser Error Classes[2m > [22mall RPC errors should extend RPCGenericError chain[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould handle incoming calls from server[32m 120[2mms[22m[39m
[90mstderr[2m | test/client.test.ts[2m > 
[22m[2mOCPPClient - Advanced Features[2m 
> [22m[2mshould handle bad messages and 
emit badMessage event
[22m[39m{"id":"svb2we9xx9ika1k6cbabgde7","
level":40,"levelName":"WARN","message":"Bad 
message","timestamp":1771530275510,"meta":{"
error":"Expected property name or '}' in 
JSON at position 13 (line 1 column 14)","cou
nt":1},"context":{"component":"OCPPClient","
identity":"CS_BADMSG"}}

 [32mΓ£ô[39m test/redis-adapter.test.ts[2m > [22mRedisAdapter[2m > [22mshould subscribe to channels with prefix[32m 5[2mms[22m[39m
 [32mΓ£ô[39m test/redis-adapter.test.ts[2m > [22mRedisAdapter[2m > [22mshould publish to channels with prefix[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/redis-adapter.test.ts[2m > [22mRedisAdapter[2m > [22mshould handle incoming messages and strip prefix[32m 3[2mms[22m[39m
 [32mΓ£ô[39m test/redis-adapter.test.ts[2m > [22mRedisAdapter[2m > [22mshould unsubsribe with prefix[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/redis-adapter.test.ts[2m > [22mRedisAdapter[2m > [22mshould disconnect and cleanup[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/redis-adapter.test.ts[2m > [22mRedisAdapter[2m > [22mshould use disconnect() if quit() is missing[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/redis-adapter.test.ts[2m > [22mRedisAdapter[2m > [22mshould handle JSON parse errors gracefully[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/redis-adapter.test.ts[2m > [22mRedisAdapter[2m > [22mshould swallow handler errors[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/redis-adapter.test.ts[2m > [22mRedisAdapter (Node Redis v4)[2m > [22mshould use NodeRedisDriver and subscribe with handler[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/redis-adapter.test.ts[2m > [22mRedisAdapter (Node Redis v4)[2m > [22mshould disconnect using disconnect()[32m 1[2mms[22m[39m
[90mstderr[2m | test/client.test.ts[2m > 
[22m[2mOCPPClient - Advanced Features[2m 
> [22m[2mshould handle bad messages and 
emit badMessage event
[22m[39m{"id":"ea4dwi0ge9s692tj6ior80tv","
level":40,"levelName":"WARN","message":"CALL
ERROR ΓåÉ","timestamp":1771530275512,"meta":
{"messageId":"msg1","errorCode":"FormatViola
tion","errorMessage":"Expected property 
name or '}' in JSON at position 13 (line 1 
column 14)","protocol":"ocpp1.6","errorDetai
ls":{}},"context":{"component":"OCPPClient",
"identity":"CS_BADMSG"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39mCALL ΓåÉ {
  messageId: [32m'yvwzfizppn63skxbjdqkwv33'[39m,
  method: [32m'AnyMethod'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"yzt6kxa4rl2qz956aewxgw4b","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275517,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"l7h5cnft8uetfvk0zpkq07ld","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275518,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"p902i9a089nf0tmvp10byixw","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275520,"meta":{"port":58097,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39mConnecting { url: [32m'ws://localhost:58097/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"r0tidko8tdytxjeu4habf9bi","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275523,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22mshould close server via abort signal[32m 109[2mms[22m[39m
[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"z7unskhf8gg1t77s9p2ohv8m","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275570,"meta":{"clientCount":2},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould register and invoke a listener[32m 4[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould return true when listeners exist for an event[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould return false when no listeners exist[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould support multiple listeners on the same event[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould support chaining on()[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould invoke a once() listener only once[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould support chaining once()[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould remove a specific listener with off()[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould be able to remove a once() listener by original function[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould not fail when removing a listener from a non-existent event[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould only remove the specified listener[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould support chaining off()[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22maddListener should alias on()[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mremoveListener should alias off()[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould remove all listeners for a specific event[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould remove all listeners for all events when no event specified[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould return correct listener count[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mlistenerCount should decrease after off()[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould handle emit with no arguments[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould not interfere between different events[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould safely iterate when a listener removes itself[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-emitter.test.ts[2m > [22mBrowser EventEmitter[2m > [22mshould cleanup map entry when last listener is removed[32m 0[2mms[22m[39m
[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"edcanzq3eha639pl56qiiyrl","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275571,"meta":{"identity":"CS_BC_2"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"azqpx40m3hhiwkzzg62nzczh","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275571,"meta":{"identity":"CS_BC_1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"foaarvw5cpsikyny998j6p3j","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275574,"meta":{"port":58099,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"nqde7vfa0y7y4mrlorfeqvjr","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275578,"meta":{"identity":"CS_PERSIST","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"zwgn4lt4455095y1g3i1gdrk","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275579,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PERSIST"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"fi3s129pb6w6r52q7e71g8rd","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530275583,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_PERSIST"}}
{"id":"r70v4a2mynjhspjgsh5drdtt","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275583,"meta":{"identity":"CS_PERSIST"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"zmwz5txrm7htjwum2c0jsnso","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275585,"meta":{"identity":"CS_PERSIST","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"xykthfcrxfdy058v5paev239","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275586,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PERSIST"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"d0yvs40j38whhhpv3mjivchk","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275589,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"uxhxhcp2zzuyua9j2sn3sjxc","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275590,"meta":{"identity":"CS_PERSIST"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Client[2m > [22mshould log reconnection attempts[33m 514[2mms[22m[39m
[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"yz6rxg1vvrdp8zp37qcld40g","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275593,"meta":{"port":58102,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"v5izk2aw1p9mv61vl6sa5q18","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275593,"meta":{"identity":"CS_GC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"kv5jtdscv7d9u5a3qg46f6n9","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275593,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_GC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"t2q09d00icj3hoxhdx3jnu60","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530305593,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_GC"}}
{"id":"jif5fvh1oalp7sn2dlja9xp8","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530305593,"meta":{"identity":"CS_GC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"q9lzom3l95c4es0o7v3a93av","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771533875593,"meta":{"identity":"CS_GC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"dfeaqbybg62ogtrruhg6goxc","level":30,"levelName":"INFO","message":"Connected","timestamp":1771533875593,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_GC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"dnevmwkrgnkp5zboo0q9uma3","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771533905593,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_GC"}}
{"id":"xd0kn3wvo3ryblpoffssit06","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771533905593,"meta":{"identity":"CS_GC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"sg396f3puwy8m06bxfzhjk3m","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771541135593,"meta":{"identity":"CS_GC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"cqz6w744jocjt76j4rvssqa1","level":30,"levelName":"INFO","message":"Connected","timestamp":1771541135593,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_GC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"vbd0q5yf3knn7e83307ufck4","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771541135593,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"nhqqx0mgaovcshz1jt6ceehi","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771541135593,"meta":{"identity":"CS_GC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould ignore broadcast messages from self (loopback)
[22m[39m{"id":"vmq7959lfmck71l0ugj1c5vr","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275626,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould ignore malformed broadcast messages
[22m[39m{"id":"ihnol4zr8mu8ky71zupqlykn","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275628,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould invoke wildcard handler for unregistered methods[32m 114[2mms[22m[39m
[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mIncoming Call Handlers[2m > 
[22m[2mshould respond with NotImplemented 
for unhandled methods
[22m[39mHandler error {
  messageId: 
[32m't11w65ns5tt51elzcbn9b1z5'[39m,
  method: [32m'UnhandledMethod'[39m,
  error: [32m'No handler for method: 
UnhandledMethod'[39m
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39mCALL ΓåÉ {
  messageId: [32m't11w65ns5tt51elzcbn9b1z5'[39m,
  method: [32m'UnhandledMethod'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"voifse4q0oz405132uu2yfzu","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275637,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"j7zkz7cfu6h0b25sbcgtj4tv","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275638,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mIncoming Call Handlers[2m > 
[22m[2mshould respond with NotImplemented 
for unhandled methods
[22m[39m{"id":"ss6fbz5hadwqjnqmajievl07","
level":40,"levelName":"WARN","message":"CALL
ERROR ΓåÉ","timestamp":1771530275635,"meta":
{"messageId":"t11w65ns5tt51elzcbn9b1z5","met
hod":"UnhandledMethod","errorCode":"NotImple
mented","errorMessage":"Requested method is 
not known","protocol":"ocpp1.6","latencyMs":
3,"errorDetails":{}},"context":{"component":
"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"gq1n9q21tit86lklibc28x57","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275642,"meta":{"port":58106,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39mConnecting { url: [32m'ws://localhost:58106/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"aitocpyiqzannynt16tpxz22","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275650,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - Robustness & Clustering[2m > [22mshould broadcast to local clients and publish to adapter[32m 142[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - Robustness & Clustering[2m > [22mshould persist session data across reconnections[32m 18[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - Robustness & Clustering[2m > [22mshould garbage collect stale sessions[32m 32[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - Robustness & Clustering[2m > [22mshould ignore broadcast messages from self (loopback)[32m 3[2mms[22m[39m
 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - Robustness & Clustering[2m > [22mshould ignore malformed broadcast messages[32m 2[2mms[22m[39m
[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould handle client errors during broadcast gracefully
[22m[39m{"id":"pexidun0r3uii5p2xyu36fwe","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275662,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould catch errors in broadcast handler
[22m[39m{"id":"dqzupu3mvvl7wogehxps7oqz","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275699,"meta":{},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/server.test.ts[2m > [22mOCPPServer - Robustness & Clustering[2m > [22mshould handle client errors during broadcast gracefully[32m 34[2mms[22m[39m
 [31m├ù[39m test/server.test.ts[2m > [22mOCPPServer - Robustness & Clustering[2m > [22mshould catch errors in broadcast handler[32m 37[2mms[22m[39m
[31m   ΓåÆ expected "error" to be called with arguments: [ ΓÇª(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "Error processing broadcast message:",[90m
[32m-   Any<Error>,[90m
[31m+   "{\"id\":\"q9j5ouifzhsxku77lgfq155v\",\"level\":50,\"levelName\":\"ERROR\",\"message\":\"Error processing broadcast message\",\"timestamp\":1771530275665,\"meta\":{\"error\":\"Iterator Error\"},\"context\":{\"component\":\"OCPPServer\"}}",[90m
[2m  ][22m
[31m[90m

Number of calls: [1m1[22m
[31m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"byg7yn1zu4ow9vitl4t1j2yv","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530275724,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_BADMSG"}}
{"id":"fii4c76kehmnadvu81kipqp3","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275725,"meta":{"identity":"CS_BADMSG"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"yhun1f3dc18fk5wgn3ieg767","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275727,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Advanced Features[2m > [22mshould handle bad messages and emit badMessage event[33m 336[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"cblwhjtncr5bt2j2s8aw02ho","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275732,"meta":{"port":58108,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"h9dkhvpfvnipxl9y2zh7z2hm","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275739,"meta":{"identity":"CS_RECONN","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"g50azqpjxr066pcudxuctj5g","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530275742,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONN"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"yekert4silvck5j2sr7ufet7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275742,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould respond with NotImplemented for unhandled methods[32m 122[2mms[22m[39m
[90mstderr[2m | test/client.test.ts[2m > 
[22m[2mOCPPClient - Advanced Features[2m 
> [22m[2mshould attempt reconnect on 
unexpected disconnect
[22m[39m{"id":"yd9t3e70hewxedncyg7c97f4","
level":40,"levelName":"WARN","message":"Reco
nnecting","timestamp":1771530275744,"meta":{
"attempt":1,"delayMs":53},"context":{"compon
ent":"OCPPClient","identity":"CS_RECONN"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"idqu3s1bpmzgfoplb36hmpk9","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530275744,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_RECONN"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"k5kxbjil37wmj3qgki3rgxjz","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275745,"meta":{"identity":"CS_RECONN"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39mCALL ΓåÉ {
  messageId: [32m'nxa2whnbsiox3fr979k2z0u3'[39m,
  method: [32m'Reset'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: { type: [32m'Hard'[39m }
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"nmwj40gznbm6b2puxdxx6hh3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275776,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"a9mu675rx998fu3czmnprjlh","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275776,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"c3a8lzwuuds4u4gcw0soqhap","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275779,"meta":{"port":58110,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39mConnecting { url: [32m'ws://localhost:58110/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"wr506xps3vxccnqc0kbym28f","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275782,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstderr[2m | test/client.test.ts[2m > 
[22m[2mOCPPClient - Advanced Features[2m 
> [22m[2mshould attempt reconnect on 
unexpected disconnect
[22m[39m{"id":"n33pbj77c6jk51hl7zk950eo","
level":50,"levelName":"ERROR","message":"Con
nection error","timestamp":1771530275812,"me
ta":{"error":""},"context":{"component":"OCP
PClient","identity":"CS_RECONN"}}

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould prefer version-specific handler over generic handler[32m 137[2mms[22m[39m
[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mIncoming Call Handlers[2m > 
[22m[2mshould remove a specific handler 
with removeHandler()
[22m[39mHandler error {
  messageId: 
[32m'rp2ukm2idm5jjemtdpzr6a2g'[39m,
  method: [32m'Reset'[39m,
  error: [32m'No handler for method: 
Reset'[39m
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39mCALL ΓåÉ {
  messageId: [32m'rp2ukm2idm5jjemtdpzr6a2g'[39m,
  method: [32m'Reset'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: { type: [32m'Hard'[39m }
}

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mIncoming Call Handlers[2m > 
[22m[2mshould remove a specific handler 
with removeHandler()
[22m[39m{"id":"wpo9g3maj1ohcndgf3c7bqcj","
level":40,"levelName":"WARN","message":"CALL
ERROR ΓåÉ","timestamp":1771530275891,"meta":
{"messageId":"rp2ukm2idm5jjemtdpzr6a2g","met
hod":"Reset","errorCode":"NotImplemented","e
rrorMessage":"Requested method is not known"
,"protocol":"ocpp1.6","latencyMs":2,"errorDe
tails":{}},"context":{"component":"OCPPClien
t","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"h4urkzc6ydexjw4c0u2j9hi4","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530275893,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"wltesb5cy6sbphjdy879tefz","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530275894,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"hmo2xjncvmur0kmjdpfa2tsq","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530275897,"meta":{"port":58119,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39mConnecting { url: [32m'ws://localhost:58119/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"hmr3dw77iv1qc2ggsfe7t96e","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530275902,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Client[2m > [22mshould log bad messages[33m 329[2mms[22m[39m
 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Client[2m > [22mshould respect logging.enabled = false[32m 11[2mms[22m[39m
 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Server[2m > [22mshould log when server starts listening[32m 6[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create RPCGenericError for "GenericError" code[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create RPCNotImplementedError for "NotImplemented" code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create RPCFormatViolationError[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create RPCInternalError[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create RPCSecurityError[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create RPCFrameworkError[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould fallback to RPCGenericError for unknown error codes[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould include details in error when provided[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould default details to empty object[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "GenericError"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "NotImplemented"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "NotSupported"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "InternalError"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "ProtocolError"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "SecurityError"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "FormatViolation"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "FormationViolation"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "PropertyConstraintViolation"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "OccurrenceConstraintViolation"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "TypeConstraintViolation"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "MessageTypeNotSupported"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser createRPCError[2m > [22mshould create correct error for code "RpcFrameworkError"[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser getErrorPlainObject[2m > [22mshould convert Error to plain object[32m 6[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser getErrorPlainObject[2m > [22mshould handle RPCError with custom properties[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser getErrorPlainObject[2m > [22mshould include details from RPCError[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser getErrorPlainObject[2m > [22mshould handle errors with circular references gracefully[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser getErrorPlainObject[2m > [22mshould skip function and symbol properties[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-util.test.ts[2m > [22mBrowser getErrorPlainObject[2m > [22mshould always include name and message[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mcreateRPCError[2m > [22mshould create RPCGenericError for "GenericError" code[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mcreateRPCError[2m > [22mshould create RPCNotImplementedError for "NotImplemented" code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mcreateRPCError[2m > [22mshould create RPCFormatViolationError[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mcreateRPCError[2m > [22mshould create RPCInternalError[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mcreateRPCError[2m > [22mshould create RPCSecurityError[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mcreateRPCError[2m > [22mshould create RPCFrameworkError[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mcreateRPCError[2m > [22mshould fallback to RPCGenericError for unknown error codes[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mcreateRPCError[2m > [22mshould include details in error when provided[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mcreateRPCError[2m > [22mshould default details to empty object[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mgetErrorPlainObject[2m > [22mshould convert Error to plain object[32m 5[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mgetErrorPlainObject[2m > [22mshould handle RPCError with custom properties[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mgetErrorPlainObject[2m > [22mshould handle errors with circular references gracefully[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mgetPackageIdent[2m > [22mshould return package identifier string[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/util.test.ts[2m > [22mgetPackageIdent[2m > [22mshould return consistent value on repeated calls[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould remove a specific handler with removeHandler()[32m 117[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39mCALL ΓåÉ {
  messageId: [32m'b95w4elt1nwjl9c41gxkpcjl'[39m,
  method: [32m'Reset'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: { type: [32m'Hard'[39m }
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"l4pk7fqc6f85orj92kyzx9ta","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276016,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/parse-basic-auth.test.ts[2m > [22mparseBasicAuth[2m > [22mshould parse standard username:password[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/parse-basic-auth.test.ts[2m > [22mparseBasicAuth[2m > [22mshould support colons in the identity (OCPP convention)[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/parse-basic-auth.test.ts[2m > [22mparseBasicAuth[2m > [22mshould support binary passwords[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/parse-basic-auth.test.ts[2m > [22mparseBasicAuth[2m > [22mshould return undefined for empty auth header[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/parse-basic-auth.test.ts[2m > [22mparseBasicAuth[2m > [22mshould return undefined for non-Basic auth[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/parse-basic-auth.test.ts[2m > [22mparseBasicAuth[2m > [22mshould return undefined for mismatched identity[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/parse-basic-auth.test.ts[2m > [22mparseBasicAuth[2m > [22mshould return undefined for malformed base64[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/parse-basic-auth.test.ts[2m > [22mparseBasicAuth[2m > [22mshould handle identity with special characters[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/parse-basic-auth.test.ts[2m > [22mparseBasicAuth[2m > [22mshould handle empty password[32m 0[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"lt44r8qhy4yxub16sgr2qtgx","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276016,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove wildcard handler with removeHandler()
[22m[39m{"id":"fimolnyzx83mjynyy756latk","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276019,"meta":{"port":58121,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove wildcard handler with removeHandler()
[22m[39m{"id":"cokvyh515rizm27ytrln6lkk","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276020,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"fgybnjvq115atarp2nt5770t","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276022,"meta":{"port":58122,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39mConnecting { url: [32m'ws://localhost:58122/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"o0j4k76nr7kdlzb7jsyls8qe","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276025,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould remove version-specific handler with removeHandler(version, method)[32m 123[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould remove wildcard handler with removeHandler()[32m 3[2mms[22m[39m
[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mIncoming Call Handlers[2m > 
[22m[2mshould remove all handlers with 
removeAllHandlers()
[22m[39mHandler error {
  messageId: 
[32m'x07q4i9urt7d4trd73kelkmk'[39m,
  method: [32m'Reset'[39m,
  error: [32m'No handler for method: 
Reset'[39m
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39mCALL ΓåÉ {
  messageId: [32m'x07q4i9urt7d4trd73kelkmk'[39m,
  method: [32m'Reset'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: { type: [32m'Hard'[39m }
}

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mIncoming Call Handlers[2m > 
[22m[2mshould remove all handlers with 
removeAllHandlers()
[22m[39m{"id":"bb6x0oqcxhmld4hz2d7v80i5","
level":40,"levelName":"WARN","message":"CALL
ERROR ΓåÉ","timestamp":1771530276132,"meta":
{"messageId":"x07q4i9urt7d4trd73kelkmk","met
hod":"Reset","errorCode":"NotImplemented","e
rrorMessage":"Requested method is not known"
,"protocol":"ocpp1.6","latencyMs":2,"errorDe
tails":{}},"context":{"component":"OCPPClien
t","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"jwz3vvungn0tetc2b6e5f2dd","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276134,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"jqtjptqse6kk10wx3kniy5hj","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276134,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould throw on invalid handle() arguments
[22m[39m{"id":"dl6sa2cc2r4ejhzklx6hofv6","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276137,"meta":{"port":58131,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould throw on invalid handle() arguments
[22m[39m{"id":"psylau93k0qgv4k6f0wrcmnr","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276138,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"d5vjodi2dhfuwzchql489lpk","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276140,"meta":{"port":58132,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39mConnecting { url: [32m'ws://localhost:58132/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"iqbdruiow9zuonkxnhtjnq4l","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276144,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Server[2m > [22mshould log client connected and disconnected[32m 221[2mms[22m[39m
 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Server[2m > [22mshould log auth rejection[32m 9[2mms[22m[39m
 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Server[2m > [22mshould log server closing[32m 3[2mms[22m[39m
 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Server[2m > [22mshould pass logging config to server clients[32m 11[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mTimeoutError should have correct properties[32m 2[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mTimeoutError should have default message[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mUnexpectedHttpResponse should include status code and headers[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mWebsocketUpgradeError should have default message[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCGenericError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCNotImplementedError should have correct code and message[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCNotSupportedError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCInternalError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCProtocolError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCSecurityError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCFormationViolationError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCFormatViolationError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCPropertyConstraintViolationError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCOccurrenceConstraintViolationError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCTypeConstraintViolationError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCMessageTypeNotSupportedError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPCFrameworkError should have correct code[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mall RPC errors should extend RPCGenericError chain[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/errors.test.ts[2m > [22mError Classes[2m > [22mRPC errors should carry details[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/logger.test.ts[2m > [22mLogger Integration - Server[2m > [22mshould not log on server when logging is false[32m 135[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould remove all handlers with removeAllHandlers()[32m 115[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould throw on invalid handle() arguments[32m 3[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39mCALL ΓåÉ {
  messageId: [32m'uifyhlposz63llja6z4omgh8'[39m,
  method: [32m'Heartbeat'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"jcnps7r93u110651zzr669ev","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276259,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"gow747jw4v5qj8j1xucqlalc","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276259,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"kyzhu980lmtqxjp4tygho466","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276262,"meta":{"port":58134,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39mConnecting { url: [32m'ws://localhost:58134/CS001'[39m }

 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Advanced Features[2m > [22mshould attempt reconnect on unexpected disconnect[33m 534[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"in4u1exsipx8j1n1dxpq7qom","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276265,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstderr[2m | test/client.test.ts[2m > 
[22m[2mOCPPClient - Advanced Features[2m 
> [22m[2mshould emit error when 
connecting to non-existent server
[22m[39m{"id":"gjd4mipufxicjexjwks5zcrk","
level":50,"levelName":"ERROR","message":"Con
nection error","timestamp":1771530276269,"me
ta":{"error":""},"context":{"component":"OCP
PClient","identity":"CS_ERR"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"mo3xajnrvfkeasvy2oc93oev","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276273,"meta":{"port":58138,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"vrhdvvuxxu25d6e0cgcwyujw","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276277,"meta":{"identity":"CS_PING","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"e7m6g4w9yyddjloka2nzkxhr","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530276279,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PING"}}

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould emit call event for incoming calls[32m 121[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Advanced Features[2m > [22mshould emit error when connecting to non-existent server[32m 6[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39mCALL ΓåÉ {
  messageId: [32m'wy61nhmkvto6p1dur1wqvwoe'[39m,
  method: [32m'FireAndForget'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22mparseSubprotocols[2m > [22mshould parse a single subprotocol[32m 3[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22mparseSubprotocols[2m > [22mshould parse multiple subprotocols[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22mparseSubprotocols[2m > [22mshould parse multiple subprotocols with extra whitespace[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22mparseSubprotocols[2m > [22mshould parse a single protocol without commas[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22mparseSubprotocols[2m > [22mshould throw on empty string[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22mparseSubprotocols[2m > [22mshould throw on leading comma[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22mparseSubprotocols[2m > [22mshould throw on trailing comma[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22mparseSubprotocols[2m > [22mshould throw on duplicate protocols[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22mparseSubprotocols[2m > [22mshould throw on invalid characters[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22mparseSubprotocols[2m > [22mshould handle tab whitespace[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22misValidStatusCode[2m > [22mshould accept 1000 (normal close)[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22misValidStatusCode[2m > [22mshould accept 1001 (going away)[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22misValidStatusCode[2m > [22mshould accept 1002 (protocol error)[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22misValidStatusCode[2m > [22mshould accept 1011 (unexpected condition)[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22misValidStatusCode[2m > [22mshould reject 1004 (reserved)[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22misValidStatusCode[2m > [22mshould reject 1005 (no status received)[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22misValidStatusCode[2m > [22mshould reject 1006 (abnormal closure)[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22misValidStatusCode[2m > [22mshould accept 3000-4999 (application defined)[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/ws-util.test.ts[2m > [22misValidStatusCode[2m > [22mshould reject codes outside valid ranges[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/event-buffer.test.ts[2m > [22mEventBuffer[2m > [22mshould capture events when started[32m 3[2mms[22m[39m
 [32mΓ£ô[39m test/event-buffer.test.ts[2m > [22mEventBuffer[2m > [22mshould replay buffered events on condense[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/event-buffer.test.ts[2m > [22mEventBuffer[2m > [22mshould preserve event order during condense[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/event-buffer.test.ts[2m > [22mEventBuffer[2m > [22mshould discard buffered events without replaying[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/event-buffer.test.ts[2m > [22mEventBuffer[2m > [22mshould be idempotent when start is called multiple times[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/event-buffer.test.ts[2m > [22mEventBuffer[2m > [22mshould be no-op when condense is called without start[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/event-buffer.test.ts[2m > [22mEventBuffer[2m > [22mshould be no-op when discard is called without start[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/event-buffer.test.ts[2m > [22mEventBuffer[2m > [22mshould clean up listeners after condense[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/event-buffer.test.ts[2m > [22mEventBuffer[2m > [22mshould clean up listeners after discard[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/adapter.test.ts[2m > [22mInMemoryAdapter[2m > [22mshould publish and receive messages[32m 3[2mms[22m[39m
 [32mΓ£ô[39m test/adapter.test.ts[2m > [22mInMemoryAdapter[2m > [22mshould support multiple subscribers[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/adapter.test.ts[2m > [22mInMemoryAdapter[2m > [22mshould not deliver to unrelated channels[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/adapter.test.ts[2m > [22mInMemoryAdapter[2m > [22mshould unsubscribe from a channel[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/adapter.test.ts[2m > [22mInMemoryAdapter[2m > [22mshould clear all channels on disconnect[32m 0[2mms[22m[39m
 [32mΓ£ô[39m test/adapter.test.ts[2m > [22mInMemoryAdapter[2m > [22mshould swallow handler errors silently[32m 0[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"pxbhw7ccmmxmil9njk5riwmf","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530276636,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_PING"}}
{"id":"yfa1snggkyvqqizmb97w4ajn","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276637,"meta":{"identity":"CS_PING"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"qwyzmrd699oqf3bwpkbxckn7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276639,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Advanced Features[2m > [22mshould use ping when pingIntervalMs is set[33m 370[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"xofbox1f0rkezsacezlkg5xz","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276644,"meta":{"port":58140,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"dgwp4uysonm9e7jsui35jc9c","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276652,"meta":{"identity":"CS_STRICT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"jgtucjn4lnd0e6jodtejyoeu","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530276653,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_STRICT"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"ehb1nk89hz52flto0a5f6jfx","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276660,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"ipuoxt0mtz59w1q2g4z2wndn","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276662,"meta":{"identity":"CS_STRICT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"mwf7pi6uhd3r5pmm9sx5cypq","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276668,"meta":{"port":58142,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"trvr0n13zg29gkhx2e56d9lo","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276672,"meta":{"identity":"CS_VCALL16","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"dlneh8e7zyfzj2fpgjl4f4hi","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530276673,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VCALL16"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"lr0lb3l2s71rfy4g5p0mssun","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276676,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"n5ng817lyv527xk40sjhux2f","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276677,"meta":{"identity":"CS_VCALL16"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"m4iu8nxz13kd4rqzg8wowu4r","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276680,"meta":{"port":58144,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mIncoming Call Handlers[2m > 
[22m[2mshould support NOREPLY from handler
[22m[39m{"id":"a8p7afxdqf874pd8ryqvxwka","
level":40,"levelName":"WARN","message":"Call
 timed out","timestamp":1771530276683,"meta"
:{"messageId":"wy61nhmkvto6p1dur1wqvwoe","me
thod":"FireAndForget","timeoutMs":300},"cont
ext":{"component":"OCPPClient","identity":"C
S001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"jia1c031ap98s9bh0w6khoc9","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276687,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"c3xjn2gh6eorfumblksqnajw","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276687,"meta":{"identity":"CS_VCALL201","remoteAddress":"::1","protocol":"ocpp2.0.1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"fs518tjw8yn6onp8f1rcah8x","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276689,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"vaaoimi01lmq7ueuwsi4t34e","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530276688,"meta":{"protocol":"ocpp2.0.1"},"context":{"component":"OCPPClient","identity":"CS_VCALL201"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"tvdgau3d2lsqeqiwavqll4x6","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276691,"meta":{"port":58146,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/redis-driver.test.ts[2m > [22mRedis Driver Factory[2m > [22mshould detect Node Redis v4 client[32m 3[2mms[22m[39m
 [32mΓ£ô[39m test/redis-driver.test.ts[2m > [22mRedis Driver Factory[2m > [22mshould detect IoRedis client (default)[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/redis-driver.test.ts[2m > [22mRedis Driver Factory[2m > [22mshould fallback to IoRedisDriver for unknown objects[32m 0[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39mConnecting { url: [32m'ws://localhost:58146/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"jhej7ikb8ppo78x8imx55vvi","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276694,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"oerzn72d7g3z1kxqbsua8aqe","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276694,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"jqh2o6femafc0k9j0yc0lqgp","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276696,"meta":{"identity":"CS_VCALL201"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"vnc9bu2t8ykshjqkr1vporan","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276709,"meta":{"port":58148,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Advanced Features[2m > [22mshould validate outbound calls in strict mode[32m 21[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Version-Aware Call[2m > [22mshould call with version-specific typed params (ocpp1.6)[32m 14[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Version-Aware Call[2m > [22mshould call with version-specific typed params (ocpp2.0.1)[32m 20[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"wsud4lhiw8qemk8jlokberiz","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276757,"meta":{"identity":"CS_VCALL_DEF","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"mbajey3xtg51u26jwy5ik7rr","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530276761,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VCALL_DEF"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"c5pwdqkmmmtzcwkr5nmy3wal","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276777,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"kblqb7pu4kn1qbah4tzaue8m","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276778,"meta":{"identity":"CS_VCALL_DEF"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"sdpxogejhm8y3tztbfeydhcp","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276784,"meta":{"port":58150,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"fm1a6te0w1f596pfbdi8vk2v","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276793,"meta":{"identity":"CS_VCALL_SRV","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould support NOREPLY from handler[33m 430[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39mCALL ΓåÉ {
  messageId: [32m'zfs3vpcz2ggn3by0uryk4t9v'[39m,
  method: [32m'Buggy'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"nzatpbx0jeatmtgvv279kdkp","level":30,"levelName":"INFO","message":"Connected","timestamp":1771530276796,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VCALL_SRV"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"tokk7qcmcqlqyv34x8q1us7x","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530276817,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_VCALL_SRV"}}
{"id":"fhchr1873p19pfd69c6xa00d","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276817,"meta":{"identity":"CS_VCALL_SRV"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"kady97jb0689cv8r6bnnygbj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276818,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Version-Aware Call[2m > [22mshould still work with non-versioned call (default protocol)[32m 81[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Version-Aware Call[2m > [22mshould support version-aware call from server to client[32m 40[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Version-Aware Call[2m > [22mshould build endpoint correctly with query params[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Version-Aware Call[2m > [22mshould build TLS options correctly[32m 1[2mms[22m[39m
 [32mΓ£ô[39m test/client.test.ts[2m > [22mOCPPClient - Version-Aware Call[2m > [22mshould emit strictValidationFailure on inbound validation error[32m 7[2mms[22m[39m
[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mIncoming Call Handlers[2m > 
[22m[2mshould include detailed errors 
when respondWithDetailedErrors is true
[22m[39mHandler error {
  messageId: 
[32m'zfs3vpcz2ggn3by0uryk4t9v'[39m,
  method: [32m'Buggy'[39m,
  error: [32m'Something broke'[39m
}

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mIncoming Call Handlers[2m > 
[22m[2mshould include detailed errors 
when respondWithDetailedErrors is true
[22m[39m{"id":"mdf8454q32upqt9t0t5sbsf9","
level":40,"levelName":"WARN","message":"CALL
ERROR ΓåÉ","timestamp":1771530276831,"meta":
{"messageId":"zfs3vpcz2ggn3by0uryk4t9v","met
hod":"Buggy","errorCode":"InternalError","er
rorMessage":"An internal error occurred and 
the receiver was not able to process the 
requested action successfully","protocol":"o
cpp1.6","latencyMs":31,"errorDetails":{"name
":"Error","message":"Something 
broke","stack":"Error: Something broke\n    
at D:\\projects\\ocpp-ws-io\\packages\\ocpp-
ws-io\\test\\browser-client.test.ts:777:15\n
    at 
BrowserOCPPClient._handleIncomingCall (D:\\p
rojects\\ocpp-ws-io\\packages\\ocpp-ws-io\\s
rc\\browser\\client.ts:678:24)\n    at 
BrowserOCPPClient._onMessage (D:\\projects\\
ocpp-ws-io\\packages\\ocpp-ws-io\\src\\brows
er\\client.ts:605:14)\n    at 
WebSocket.<anonymous> (D:\\projects\\ocpp-ws
-io\\packages\\ocpp-ws-io\\src\\browser\\cli
ent.ts:579:12)\n    at callListener (D:\\pro
jects\\ocpp-ws-io\\node_modules\\ws\\lib\\ev
ent-target.js:290:14)\n    at 
WebSocket.onMessage (D:\\projects\\ocpp-ws-i
o\\node_modules\\ws\\lib\\event-target.js:20
9:9)\n    at WebSocket.emit 
(node:events:508:28)\n    at 
Receiver.receiverOnMessage (D:\\projects\\oc
pp-ws-io\\node_modules\\ws\\lib\\websocket.j
s:1225:20)\n    at Receiver.emit 
(node:events:508:28)\n    at 
Receiver.dataMessage (D:\\projects\\ocpp-ws-
io\\node_modules\\ws\\lib\\receiver.js:596:1
4)"}},"context":{"component":"OCPPClient","i
dentity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"qpe9d2sv2530u73w920whzoz","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276833,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"ir95ocyp1srjcmplld3zvexg","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276834,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"rahpsbjpuiqd61uippmwxozb","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276836,"meta":{"port":58152,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39mConnecting { url: [32m'ws://localhost:58152/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"a2ftwoakmy8d92hmq24n4oqw","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276843,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2msendRaw[2m > [22m[2mshould send 
raw data over WebSocket
[22m[39m{"id":"rc3qoevc4v8tqkbr2mred2o9","
level":40,"levelName":"WARN","message":"Bad 
message","timestamp":1771530276845,"meta":{"
error":"Unexpected token 'h', \"hello\" is 
not valid JSON","count":1},"context":{"compo
nent":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"hehdfzcrc2nf5ajb6vp0c6p0","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276846,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"sukxjwbxrdluzld15un39a74","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530276847,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould throw when not connected
[22m[39m{"id":"fsaysxhoxbqf1zq2jyfr7zoh","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276850,"meta":{"port":58154,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould throw when not connected
[22m[39m{"id":"zlo73f51bowvkky912lz9me5","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276851,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update options
[22m[39m{"id":"r3e2mk0k5wcihrlwu36q4aww","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276864,"meta":{"port":58155,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update options
[22m[39m{"id":"p00drgp9ui77dod7emu70dg6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276866,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update call concurrency dynamically
[22m[39m{"id":"eh5ci9yaukrxhfqhut11ywt9","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276872,"meta":{"port":58156,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update call concurrency dynamically
[22m[39m{"id":"dyhu18eqyyx5pvnmg983xjg1","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530276872,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"w98n8ejiim2lj10v9p6ic39z","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530276875,"meta":{"port":58157,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39mConnecting { url: [32m'ws://localhost:58157/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"xmqoj3ngs8t3m5857pimpsc5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530276882,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould include detailed errors when respondWithDetailedErrors is true[32m 145[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22msendRaw[2m > [22mshould send raw data over WebSocket[32m 13[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22msendRaw[2m > [22mshould throw when not connected[32m 3[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mreconfigure[2m > [22mshould update options[32m 16[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mreconfigure[2m > [22mshould update call concurrency dynamically[32m 6[2mms[22m[39m
[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mBad Messages[2m > [22m[2mshould 
emit badMessage for invalid JSON
[22m[39mBad message {
  error: [32m`Unexpected token 'o', 
"not-json{{{" is not valid JSON`[39m,
  count: [33m1[39m
}

 [32mΓ£ô[39m test/index.test.ts[2m > [22mIndex Exports[2m > [22mshould export all public members[32m 2[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"zvqvjxnnmz2xcjj59juz428z","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530277099,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"ebclvsh8282pyrybzqatkyub","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530277100,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"y16xaq3jrh6m87rp17z6gvmb","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530277102,"meta":{"port":58159,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39mConnecting { url: [32m'ws://localhost:58159/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"akdlwmtism85lyg819g9v4bv","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530277104,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mBad Messages[2m > [22mshould emit badMessage for invalid JSON[32m 227[2mms[22m[39m
[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mBad Messages[2m > [22m[2mshould 
emit badMessage for non-array message
[22m[39mBad message { error: 
[32m'Message is not an array'[39m, count: 
[33m1[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"vddr4jzq5trizxwk4jimdh4b","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530277331,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"ug40461v19c3v7fpx1e6udcr","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530277331,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"fjcnchuq69o59seppfg2008u","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530277335,"meta":{"port":58161,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39mConnecting { url: [32m'ws://localhost:58161/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"sn2if6feir48uloskgbgpaga","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530277338,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mBad Messages[2m > [22mshould emit badMessage for non-array message[32m 233[2mms[22m[39m
[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mBad Messages[2m > [22m[2mshould 
emit badMessage for unknown message type
[22m[39mBad message { error: 
[32m'Unknown message type: 99'[39m, 
count: [33m1[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"o58ia0ai4yakt2lb0hys4evt","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530277567,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"sz4s4t4y8jysczibr4nvy91w","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530277568,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"sr3ai314exweir0xjmp6pit0","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530277570,"meta":{"port":58163,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39mConnecting { url: [32m'ws://localhost:58163/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"wwmw916trctc7a0q864y1w6i","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530277572,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mBad Messages[2m > [22mshould emit badMessage for unknown message type[32m 235[2mms[22m[39m
[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mBad Messages[2m > [22m[2mshould 
close after maxBadMessages is reached
[22m[39mBad message { error: 
[32m`Unexpected token 'b', "bad1" is not 
valid JSON`[39m, count: [33m1[39m }
Bad message { error: [32m`Unexpected token 
'b', "bad2" is not valid JSON`[39m, count: 
[33m2[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"eaah6lma5919a276sjm2am88","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771530277680,"meta":{"code":1002,"reason":"Too many bad messages"},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"bwwmbit9w75xxbbvpkokxrw4","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530277681,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"ip4aq31jitpslwkmsjqbcvf5","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530277882,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"swda3nfpxjpnb4n4tt3927j6","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530277884,"meta":{"port":58165,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39mConnecting { url: [32m'ws://localhost:58165/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"lxgorjldor256bg4s4r7484o","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530277886,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mBad Messages[2m > [22mshould close after maxBadMessages is reached[33m 314[2mms[22m[39m
[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mReconnection[2m > [22m[2mshould 
emit reconnect event after unexpected close
[22m[39mReconnecting { attempt: 
[33m1[39m, delayMs: [33m26[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39mDisconnected { code: [33m1006[39m, reason: [32m''[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"nnk0wsjdhs7yfruf1aelcuzb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530278002,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39mConnecting { url: [32m'ws://localhost:58165/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"f12o99ijnq36iyoz4zcwbbze","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530278034,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"dsxnhh8v7dj9omo48323nro2","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530278315,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"ld6o7mylmyval1q8m8bmzaw2","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530278316,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"ikkfpzirquou18nsdy5c0hv8","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530278320,"meta":{"port":58168,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39mConnecting { url: [32m'ws://localhost:58168/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"od7ueu2qx56ursvhvtw0l9wt","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530278323,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mReconnection[2m > [22mshould emit reconnect event after unexpected close[33m 434[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39mDisconnected { code: [33m1006[39m, reason: [32m''[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"flbm4lgcdjrl2l41ipf3dhe9","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530278435,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"zp6qg93v9hc7ixvh7a1srqp7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530278750,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"y8i58yxaob8g28btfhs7auu0","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530278753,"meta":{"port":58170,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39mConnecting { url: [32m'ws://localhost:58170/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"haxllllclmeey639akefgxs6","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530278757,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39mCALL ΓåÆ {
  messageId: [32m'p1dvqyr4bt0i1j3pc844b29f'[39m,
  method: [32m'SlowMethod'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}
{"id":"javgiv9ea8rhqs58llpdgiqb","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530278759,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39mDisconnected { code: [33m1006[39m, reason: [32m''[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"m58kuslb0hit6o089p62psls","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530278761,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"qk5c35v4xzn5vskihzenfazm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530278762,"meta":{"port":58172,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39mConnecting { url: [32m'ws://localhost:58172/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"bwzapmcqds1r9kj90dy3su1p","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530278764,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mReconnection[2m > [22mshould not reconnect when reconnect is false[33m 434[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mReconnection[2m > [22mshould reject pending calls on unexpected close[32m 10[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39mDisconnected { code: [33m1006[39m, reason: [32m''[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"f5xc645xyx12tinz4inflrhd","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530278868,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"xa0s6cb5cl6caqnbm40olghf","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530279469,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould emit error event on WebSocket error
[22m[39m{"id":"zcwbgx8fisg320v9b91ce4st","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530279472,"meta":{"port":58174,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould emit error event on WebSocket error
[22m[39mConnecting { url: [32m'ws://localhost:1/CS001'[39m }

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mError Handling[2m > 
[22m[2mshould emit error event on 
WebSocket error
[22m[39mConnection error

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould emit error event on WebSocket error
[22m[39m{"id":"dhitcpzmv0990c7u8jotm9c0","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530279475,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"xnq9pfqnu7o0yf5zj3vmvmof","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530279476,"meta":{"port":58177,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39mConnecting { url: [32m'ws://localhost:58177/CS001'[39m }

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"rv1ld3zd3pe28ojeb79kq3ae","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771530279479,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39mConnected { protocol: [32m'ocpp1.6'[39m }

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mReconnection[2m > [22mshould stop reconnecting when reconfigure disables reconnect[33m 709[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mError Handling[2m > [22mshould emit error event on WebSocket error[32m 6[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39mCALL ΓåÉ {
  messageId: [32m'zl9ocpq18p35r0tg305bsdsk'[39m,
  method: [32m'Buggy'[39m,
  protocol: [32m'ocpp1.6'[39m,
  payload: {}
}

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mError Handling[2m > 
[22m[2mshould handle handler throwing 
non-RPC error
[22m[39mHandler error {
  messageId: 
[32m'zl9ocpq18p35r0tg305bsdsk'[39m,
  method: [32m'Buggy'[39m,
  error: [32m'unexpected error'[39m
}

[90mstderr[2m | 
test/browser-client.test.ts[2m > 
[22m[2mBrowserOCPPClient[2m > 
[22m[2mError Handling[2m > 
[22m[2mshould handle handler throwing 
non-RPC error
[22m[39m{"id":"xcoqqgjf4qk459w6hkkxduj4","
level":40,"levelName":"WARN","message":"CALL
ERROR ΓåÉ","timestamp":1771530279583,"meta":
{"messageId":"zl9ocpq18p35r0tg305bsdsk","met
hod":"Buggy","errorCode":"InternalError","er
rorMessage":"An internal error occurred and 
the receiver was not able to process the 
requested action successfully","protocol":"o
cpp1.6","latencyMs":1,"errorDetails":{}},"co
ntext":{"component":"OCPPClient","identity":
"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"cxd4x2ha5rl4eierpn0d31ad","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530279584,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"zznaz758w5u3yczlda8w5fby","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771530279585,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBrowser Index Exports[2m > [22m[2mshould export all expected modules
[22m[39m{"id":"byf53dcrzspkag9rd5fglzud","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771530279586,"meta":{"port":58179,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBrowser Index Exports[2m > [22m[2mshould export all expected modules
[22m[39m{"id":"r8aq351s407ph0t7n9klsfu3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771530279595,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mError Handling[2m > [22mshould handle handler throwing non-RPC error[32m 110[2mms[22m[39m
 [32mΓ£ô[39m test/browser-client.test.ts[2m > [22mBrowserOCPPClient[2m > [22mBrowser Index Exports[2m > [22mshould export all expected modules[32m 10[2mms[22m[39m

[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m[1m[41m 
Failed Tests 1 
[49m[22m[31mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[39m

[41m[1m FAIL [22m[49m 
test/server.test.ts[2m > [22mOCPPServer - 
Robustness & Clustering[2m > [22mshould 
catch errors in broadcast handler
[31m[1mAssertionError[22m: expected 
"error" to be called with arguments: [ 
ΓÇª(2) ][90m

Received: 

[1m  1st error call:

[22m[2m  [[22m
[32m-   "Error processing broadcast 
message:",[90m
[32m-   Any<Error>,[90m
[31m+   "{\"id\":\"q9j5ouifzhsxku77lgfq155v
\",\"level\":50,\"levelName\":\"ERROR\",\"me
ssage\":\"Error processing broadcast message
\",\"timestamp\":1771530275665,\"meta\":{\"e
rror\":\"Iterator Error\"},\"context\":{\"co
mponent\":\"OCPPServer\"}}",[90m
[2m  ][22m
[31m[90m

Number of calls: [1m1[22m
[31m[39m
[36m [2mΓ¥»[22m 
test/server.test.ts:[2m688:24[22m[39m
    [90m686| [39m    
[34mcapturedHandler[39m[33m![39m({ 
source[33m:[39m 
[32m"other"[39m[33m,[39m 
method[33m:[39m 
[32m"Reset"[39m[33m,[39m 
params[33m:[39m {} })[33m;[39m
    [90m687| [39m
    [90m688| [39m    [34mexpect[39m(cons
oleSpy)[33m.[39m[34mtoHaveBeenCalledWith
[39m(
    [90m   | [39m                       
[31m^[39m
    [90m689| [39m      [32m"Error 
processing broadcast 
message:"[39m[33m,[39m
    [90m690| [39m      expect[33m.[39m[
34many[39m([33mError[39m)[33m,[39m

[31m[2mΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ
»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»ΓÄ»[1/1]ΓÄ
»[22m[39m


[2m Test Files [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m21 passed[39m[22m[90m (22)[39m
[2m      Tests [22m [1m[31m1 failed[39m[22m[2m | [22m[1m[32m395 passed[39m[22m[90m (396)[39m
[2m   Start at [22m 01:14:32
[2m   Duration [22m 6.71s[2m (transform 1.84s, setup 0ms, collect 6.52s, tests 11.14s, environment 7ms, prepare 4.18s)[22m

error: "vitest.cmd" exited with code 1
