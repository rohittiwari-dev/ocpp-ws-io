
> ocpp-ws-io@1.0.0 test
> vitest run


[1m[46m RUN [49m[22m [36mv3.2.4 [39m[90mD:/projects/ocpp-ws-io/packages/ocpp-ws-io[39m

 [32mâœ“[39m test/validator.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 328[2mms[22m[39m
[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"x4z4zv5v8geftk8r2biwqfmo","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205702,"meta":{"port":62618,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould start listening on a port
[22m[39m{"id":"l98tqhn8sivqsj3cwzy3pacl","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205704,"meta":{"port":62619,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould start listening on a port
[22m[39m{"id":"enw6nkth26tgfy1c401nlkdb","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205708,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"yexo4zf54yy1ygekfhlf20t9","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205707,"meta":{"port":62620,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"d7bpm433tzuibsx001erihpj","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205712,"meta":{"port":62621,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"zfwuiwglpz0ghb0486q3gbcw","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205712,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"csqvkee8lbgfjjad3r7ke6xk","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205717,"meta":{"port":62622,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"sih9mjdtpdl4xcas1ijvbwbs","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205720,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"g7ekk7q170etdp9bvuotovcf","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205724,"meta":{"port":62623,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"ovc5bdouurgtar8n8ducao86","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205753,"meta":{"identity":"CS_STATE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff

[22m[39m{"id":"lj2emcitx7a33num86xjef1q","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771787205766,"meta":{"attempt":1,"delayMs":468},"context":{"component":"OCPPClient","identity":"CS_STATE"}}
[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"eka1tmrjafkqo3d4x75k61dc","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205757,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_STATE"}}


[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"uoqr5beh5rv3s71qq1k0kh2f","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205761,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"md0mc9u53p7t4dqxi9jwsuop","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787205765,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_STATE"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"epnfirvmru066aztdhoryjl5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205768,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"mhzzn0dzn19xdj6n9qaswm4g","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205768,"meta":{"identity":"CS_STATE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"wwq7fjqdh67d7vpcdi40hn77","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205771,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"q3mr6onl74pwhapj1mbcy5s6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205774,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"s24uq0nphzn1nlgvhvep9ylq","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205778,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"mc3tzmfx30ne9009a5l7cnyn","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205782,"meta":{"port":62627,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"sdi53rl3mz0mxx61wzcdsbqr","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205789,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"z38qk3m7pquwc7gbqsyvua9y","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205789,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"uxqv70yitww947wplxoo7lnm","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205790,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"d7v10v167vcmtl2uw1whykk9","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205792,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"tea92ckplo06t01po6kktg1v","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205796,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[22m[39m{"id":"k0t0ugjnut30itgzrg9kddgv","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771787205821,"meta":{"attempt":1,"delayMs":417},"context":{"component":"OCPPClient","identity":"CS_NO_DOUBLE"}}
[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"rgv3p75i3ts1ds7lhder7jcl","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205796,"meta":{"port":62629,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"d2hm6t5uv1x954kdg6hl475y","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205798,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"z7ni3m43la82fbusftv3peiw","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205801,"meta":{"port":62630,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"qfeukxdgny8zt1hm30hfvaf6","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205815,"meta":{"port":62633,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"stfxnx6stizek5x067svg6d1","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205816,"meta":{"identity":"CS_NO_DOUBLE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"dhj3u3hhwfeyar143tvmy5a4","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205818,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_NO_DOUBLE"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"ucfvi34fdl1abxx0gsy0wfn6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205819,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"tym768b2p33bfszojvjprf51","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205821,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"b941e0oorqramkeem8i0dg2a","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787205820,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_NO_DOUBLE"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"n8qcgf21svd080qs81evwuha","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205824,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"wqp9853z9cbg490tlinre40p","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205823,"meta":{"identity":"CS_NO_DOUBLE"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"gxf1qfa63jydhs870tnz93hq","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771787205870,"meta":{"attempt":1,"delayMs":496},"context":{"component":"OCPPClient","identity":"CS_EVT"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"bsgeh81y9cksm3jst18hvk2g","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205823,"meta":{"port":62634,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"upo25chwz9bck401xnt2l1ms","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205825,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"xr0rw8zb3n0c2yr5uywmlrjz","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205828,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"v2ccbyirrynvbcdr2enjgq70","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205830,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"np3thmf3xhd64sqnky6xjwao","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205831,"meta":{"port":62635,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"ffgxapaw5ztoyx62a540bqlv","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205835,"meta":{"port":62636,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"w2h0msgshzihrlmuvx8dli9n","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205837,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[22m[39m{"id":"q4fy6bvgiw9obhvo6rgktsyv","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771787205899,"meta":{"attempt":1,"delayMs":391},"context":{"component":"BrowserOCPPClient","identity":"BR_STATE"}}
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected

[22m[39m{"id":"nc6ca8igvwdikev7fdycji02","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205838,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"sincdw072uihqzcuyb4h1s6b","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205839,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould expose static connection state constants
[22m[39m{"id":"iqceovyea2g4o1x5vicgu0bo","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205841,"meta":{"port":62638,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould expose static connection state constants
[22m[39m{"id":"pn2w6vusnpvv1ytxng7ev07g","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205845,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould set identity correctly
[22m[39m{"id":"dsdzcjy4z4du1x4iwykbsu7g","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205849,"meta":{"port":62639,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"ofnrmzx8ms31uei1b3bpxv1x","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205847,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould set identity correctly
[22m[39m{"id":"tb08oxp7xedo69on5ex1p22j","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205852,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"clxzvty727wy99isjdz884dc","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205853,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"shitu0sikmgf2cwoq29q454n","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205853,"meta":{"port":62640,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould provide a default logger when not specified
[22m[39m{"id":"ojj0g0axawx6sr0z9irzm15n","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205856,"meta":{"port":62641,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"scpixaj2tjwnokg6z2hrnwva","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205856,"meta":{"port":62642,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould provide a default logger when not specified
[22m[39m{"id":"pim100golhau2dbbvclfyzos","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205858,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"u5v9nt3h78h6ooehnol8ndyc","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205864,"meta":{"identity":"CS_EVT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"ec09331enjpayzudui0vxro9","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205865,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_EVT"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"tm1a5fze5yhep2tmvw7mxt1r","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205867,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections via auth callback

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"p2w904z37or4pgbnora7gyw8","level":40,"levelName":"WARN","message":"Auth rejected","timestamp":1771787206002,"meta":{"identity":"CS_REJECTED","code":401},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"clrkze0j108j22ahzvhydelt","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205871,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould provide a safe NOOP logger when logging is false
[22m[39m{"id":"p4hov0tu7ika2k5m5a9kmfwg","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205870,"meta":{"port":62645,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"rwwad0f77suty6hz1zjd1w8p","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205872,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould provide a safe NOOP logger when logging is false

[22m[39m{"id":"xjzmmodnnlnj2me5pcvwtbsz","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205873,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections via auth callback

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould use a custom logger instance and attempt to bind context via child()
[22m[39m{"id":"eszv69nik5xzq9aq844iobya","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205879,"meta":{"port":62647,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[22m[39m{"id":"wctxpzxy3dja36ww69lmx1q6","level":50,"levelName":"ERROR","message":"Unexpected HTTP response","timestamp":1771787206018,"meta":{"statusCode":401},"context":{"component":"OCPPClient","identity":"CS_REJECTED"}}
[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"juewueca3s1qvgg05l9hrhzg","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787205868,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_EVT"}}


[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"u4c22qtfdkam8t9cbdweun3a","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205881,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"y3pmdojtwy3fsml73aguz1ou","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205882,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"yojml04p6w7z2zgixze5tasu","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205884,"meta":{"identity":"BR_STATE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[22m[39m{"id":"yf6u66hvm06joeld9g8b9in6","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771787206042,"meta":{"attempt":1,"delayMs":26},"context":{"component":"OCPPClient","identity":"CS_MAX"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould use a custom logger instance and attempt to bind context via child()
[22m[39m{"id":"fvy2ofrgwy547kny9gajk3o4","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205884,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"j9dkdt9zy3qoqbzmk93skxlj","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205885,"meta":{"identity":"CS_EVT"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted

[22m[39m{"id":"dahkkhrerwikovj155s3lqys","level":50,"levelName":"ERROR","message":"Connection error","timestamp":1771787206097,"meta":{"error":""},"context":{"component":"OCPPClient","identity":"CS_MAX"}}
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"jkjevq15onsitlh2lzzyzz6n","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205886,"meta":{"port":62648,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould apply a custom handler transport correctly
[22m[39m{"id":"zjiaswo22obcm2hs0rre0eup","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205887,"meta":{"port":62649,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould apply a custom handler transport correctly
[22m[39m{"id":"f8l4c8x6oylrzit3da6xzz6h","level":30,"levelName":"INFO","message":"Test browser handler message","timestamp":1771787205889,"meta":{},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}


[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"x2upw3rma4ov0ns81dfh0ks4","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771787206134,"meta":{"attempt":1,"delayMs":387},"context":{"component":"BrowserOCPPClient","identity":"BR_NO_DBL"}}

[22m[39m{"id":"h36o7gxw3uxqknii3ll6wm27","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205887,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_STATE"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"hbwzutpbdgmfemxb16rctucx","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205892,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"xzr1h5pn55wtjrsuzgd1tzns","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771787206376,"meta":{"attempt":1,"delayMs":258},"context":{"component":"BrowserOCPPClient","identity":"BR_EVT"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"bzb64a315p90wvk21e1mg3u1","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787205898,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_STATE"}}


[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"xrnsww5a51nqwznild4zhb2u","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205901,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"yw7d07bxjkcl4icl8wr1wov7","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205902,"meta":{"identity":"BR_STATE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"n7bme5an1waoy3c3vnzwmh0v","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205904,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould apply a custom handler transport correctly
[22m[39m{"id":"lsqk3kss3gwjixzeaxzsexq1","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205906,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"xhbqydiwh4v8v3k4cjt9azd6","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787205907,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"wo45k670exte0j0e5bz0vyoa","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205909,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"bcpk1wjiu9cezdmm7343txu5","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205913,"meta":{"port":62652,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"hoxgzded48ixnwps6866ctt8","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205910,"meta":{"port":62651,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"b1rpgx3c4xbypyi735kkv77v","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205917,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"cnwc1nh1wap0ss1bjepw045a","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205917,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"gh994exekkhff8nnj6dag4vj","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205919,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"ykwq33u99hjv5nnui2f8a3ds","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205922,"meta":{"port":62654,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"vh0lv32r8sb2xz9iqbtbtk1w","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205922,"meta":{"identity":"CS_NO_RECON","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"pu6khnflm6e9ak22vsn8vata","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205924,"meta":{"port":62655,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"ompkpdvd7rhg5q0tuvw4hfzh","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205926,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_NO_RECON"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"cxm8u7d5keljfpqvzjj1mxxp","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205929,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"h9dkjlmmfae9w883t04rj2b4","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787205931,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_NO_RECON"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"trhw8w020oeorhosdgexgw1k","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205932,"meta":{"identity":"CS_NO_RECON"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"y6itsno689ru393wt2weqvfs","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205938,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"sx5vpgw3ryguk8s0xkaz7ww3","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205939,"meta":{"identity":"CS_EMIT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"phxvntbkotpg3w23tz8ghhzp","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205939,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"s6dxxv1ngkgsd15srv2z848w","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205943,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"cjx1wfjbf32k5ywrsuj9zaaw","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205944,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"rwjjomerlzd0w9i9ddwu4fje","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205950,"meta":{"port":62658,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"uwvml4qohfdw0wrvvy0cpihh","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205953,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_EMIT"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"qbsgu6x4vu71cfg3a3jm4wpn","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205956,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"tgzqt5skxxehc3xeczttd73n","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205969,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"t4ko5xq2b8crizzebcpglv4q","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205973,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"xhliqp85eeu4a4a586ovyeaj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787205973,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"nv3x4meevtrlm0ri9cqcrj7n","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205975,"meta":{"identity":"CS_EMIT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"vipgqy9kzfmraap7m7t5wv08","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205977,"meta":{"port":62660,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"rugt7bzd6zxwifp0yrsr3a72","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787205980,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections via auth callback
[22m[39m{"id":"vrpb55knbxqowx51xasug9m3","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205985,"meta":{"port":62662,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"dkxmvl9prowai7irpd9d9qb7","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787205990,"meta":{"port":62663,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"hwh3ge1b4ftiis49tr3f58yd","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787205996,"meta":{"identity":"CS_CLOSE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"qftgiqor07ha0j0306rmxy2v","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787205997,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_CLOSE"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"wkfdae6rk6y7lkwl8m19zvn8","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206002,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"qcj2ab8l085kqv9zxwrb0q2c","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206005,"meta":{"identity":"CS_CLOSE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"xqw4e7bb9egzfvv9thpfsctn","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206005,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"mfzvh7oe62f9sowpjfg1b2d6","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206011,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"l8lzlv2kd4wdhqx46tv9pdpm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206011,"meta":{"port":62667,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"ddjispccnkljk4ongcglplb0","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206017,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"yx88bdvn5eru4b97t3ulc1px","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206020,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"khng3i2ca0edrqc7o8sydhof","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206020,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"l7pio1sftaqi0t5weesrtokg","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206020,"meta":{"identity":"CS_MAX","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"uf9l5pyb96nbntd2chypt3h6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206021,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections via auth callback
[22m[39m{"id":"c25vx0bashmmoy2aas9rhalo","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206022,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"wyuf7jvtuddlwbmt9eaf6t02","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206022,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"suh7tnjr05ahkfn0q56cwdy0","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206025,"meta":{"port":62669,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"fliee64sas8c0doel42vm9jc","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206034,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"c2xj4segfk0x2kikgag1g8yv","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206036,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"c2i517gy9t71angxbfeip2cq","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206036,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_MAX"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"g4m0ti0he1odxy09nu719a4t","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206038,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"eeorca7b9j3sqtapu8shymuv","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206042,"meta":{"port":62671,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"un59vigtzvjwrshd5p272p6q","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206041,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_MAX"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"dm7ve8iu773tkh94gz2uzkrg","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206043,"meta":{"identity":"CS_MAX"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"mhodjq62mnlepzsciwt08ctp","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206050,"meta":{"port":62673,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"wc8k6btctmypkhqohqoxpqvs","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206051,"meta":{"identity":"MY-STATION-123","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"jx2p75iiy57aur1m2ki52m0j","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206053,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"MY-STATION-123"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"rq2w9knztekutpy3559bvxzr","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206064,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"n48vpbhc0hn3fik76l6q2oye","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206067,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"w3z0bdz65r9ba9mmrhrono74","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206054,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"o4rho839plkhx0ptnahli3i8","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206069,"meta":{"identity":"MY-STATION-123"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"v6hpct735ewb9iqrmzry11lt","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206074,"meta":{"port":62675,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"kp43d2tckehk626nwcsqcan8","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206035,"meta":{"identity":"CS002","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"jqx2ip4n911zs6yrph9if91y","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206087,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"fnnxokzwbtz7nt0tcok7i5k2","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206088,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"nmlkl3iri7ov1qy040nqrb6e","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206090,"meta":{"identity":"CS_DISC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"mjawnhyee6h1v4kdr41bu1ub","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206096,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_DISC"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"dspvfy16ipw3qvy9i97lb9ld","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206096,"meta":{"port":62679,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"cwqnd4r0zl066n8tzu15qpdr","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206098,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS002"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"h5mnra0vohntxfgar62aucju","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206100,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS002"}}
{"id":"yglpaj6hidgycjxhg7vrkktb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206105,"meta":{"identity":"CS002"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"t793zov2zi11txry5uhi1v5z","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206106,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"iks9qm1mrtrx6gxau3ye078k","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206108,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"ucwxkia41x27zloww144zu6c","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206109,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"r06cags787j63cge15wk6jo7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206113,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"lvuol1o3qkot3284impveln0","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206113,"meta":{"port":62681,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"tj1r9tovucup01td942cpdiv","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206114,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"ygiplyajp09za53ci430eqkn","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206117,"meta":{"port":62682,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"pmsyyjx3gtg63yvjzg96hdje","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206121,"meta":{"port":62684,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"rjqqcep642n0npcqu2bflcjk","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206122,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"uycf1tyysuibyju9t08jcj9x","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206126,"meta":{"identity":"BR_NO_DBL","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"cjzyze4gsv3gkdy1mxtp75t4","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206129,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_NO_DBL"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"w7zdqunlxvzsf3h9omcyqxmr","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206129,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"i0ilcq31gm188c6dzazu44ob","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206130,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"elzq5b4u0p2pqgu7iblt9d0b","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206132,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"q5210k3tmpsahxk8d9h03tly","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206132,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"r9a9f3qknb2url48hhqd3vv3","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206132,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"h4qq1v0j6y81owmc8wo63wiq","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206133,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"owe22ns8ka9eprnqih6nft9f","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206134,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"k8zi91uia2pwwxp8nqwwvc93","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206136,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"i66b2vkijjfsitlrup64yaa9","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206136,"meta":{"port":62687,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"wrdkkdrcedd9jqxtuxreo0xt","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206137,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"nc0i7vgh5uttqoaozyq3trfv","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206139,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"gp5t51dgoijfy6ioaip1igpk","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206140,"meta":{"port":62689,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"brcudlh30skau6tc4kk4xg8t","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206142,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"hveq957w2mn7tcxu3lwiqm9p","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206133,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_NO_DBL"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"x7z3rsb50q6gm6kfe2xvw9my","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206146,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"yr87muy1bfs2bzmtc6biqocm","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206146,"meta":{"identity":"BR_NO_DBL"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"r31c39krm2q5t3qp6r8fubff","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206149,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"fnxw8h1sd97sg45knffmpdt0","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206153,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"zsqj0vfl1oc4bxufv49xlhol","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206153,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"y2s2bwy7a3d1ggw22dfdixht","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206157,"meta":{"port":62691,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"errgxqyfxsxd6yso9v3dw5ha","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206162,"meta":{"identity":"CS/001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"bbphfwwpnn3as7z86vllp0ba","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206166,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS/001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"vk5e9mw64zehe1brzqxcwzps","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206170,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"ljc8tmtwf62esfghv11jik0l","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206176,"meta":{"identity":"CS/001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"c2gpp3l8vnpfge816h7i2l8f","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206182,"meta":{"port":62693,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"ncfebdjutgvesn76exhsw8fg","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206187,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"fltavofww1o3c0s1ztbgp9dt","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206188,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"h6dpuqqnslviyrwtzy1tbc0l","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206190,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"ot4zn0ue4ek0takiyl3bvicw","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206191,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"kiua5jo6uatvuecz3im6xx3x","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206196,"meta":{"port":62695,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"oza92sanxuu1qirnb4uvycog","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206206,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"umii96epr1a8j64xtceqsinp","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206214,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_DISC"}}
{"id":"qz36upg67ftbvxjlrwt3g0da","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206214,"meta":{"identity":"CS_DISC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"optqjsazrrv7oxf8pr1z2949","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206213,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"bbrdb5zsw3bqvbpcmnkhjcot","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206233,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"cga7hx4d5613jecf2a2cnwk4","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206235,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"xuh2t7pvmyepj8c1chmzwpij","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206238,"meta":{"port":62697,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"umydk64qauxs4c7a15176x0c","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206248,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"gacpujhd96831jp7wapkxocs","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206248,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"z2xgno79gcyn67ylpawcr1wt","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206249,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"vaqr1zmwr7dze4pb1k7161r2","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206250,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"ifa7jtyou7mfis0xhthcyj2p","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206252,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"hx4gfnqlekd2ockrcksmf8jc","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206255,"meta":{"port":62699,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw

[22m[39m{"id":"kreeymwxfzf1uvk6qb1fruwz","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787206516,"meta":{"error":"Unexpected token 'o', \"not-valid-ocpp\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"CS_RAW"}}
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"g6hco2bep78vzxef87kgw7tu","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206262,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"h5kk0mhwb282patk0v5yzugj","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206263,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould return immediately when already closed
[22m[39m{"id":"v66dx99o747bbmgokpdh6miy","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206266,"meta":{"port":62701,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"qpy22j89vsyis9bgtm6d7mna","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206266,"meta":{"identity":"CS_VERSIONED","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould return immediately when already closed
[22m[39m{"id":"wwuawyl7cmlrg0u6rvh4ziqo","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206268,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"abszmvr8bc1ll9t7k6z2w0k8","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206269,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VERSIONED"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"v8p2utr54r6z55jth7ukns71","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206272,"meta":{"port":62702,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"fnvvv03ojyst6eozazihtwp0","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206272,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_VERSIONED"}}
{"id":"pspuct09b0v2xaz3c7cl7sa8","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206272,"meta":{"identity":"CS_VERSIONED"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"mywo3u4uqaq3vzt0e9i3ogor","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206288,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"c7s4rcbrqqeq9i7j3w1kko70","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206290,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"sjk3uxmy9fptrogy4ln6sqdd","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206290,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"uovndpjirnaq2505rbmcs9oi","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206296,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"nqzby0i4e27dgqo2270twdvi","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206298,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"jjpxm710jd4nps6bg5qps7tr","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206298,"meta":{"port":62704,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"zgddqguuwb898gkgnudfjnfh","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206301,"meta":{"port":62705,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"qfatn7i5ptdjgr5gc2fkoles","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206301,"meta":{"identity":"CS_CTX","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"s7y91ka1zq5dod2qnsxp1rqy","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206303,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_CTX"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"g9cp0yb35hpbck6wj4q6kc72","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206305,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_CTX"}}
{"id":"e3d65h075u3q8ous7yqyalh6","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206306,"meta":{"identity":"CS_CTX"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"o5ry0febu0cgpnzstubhmlvk","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206306,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"uo70zfq3x14fmjyudoq7an52","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206312,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"ui7uw0gzff7zan6fqsclargi","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206313,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"hr3ulob892v1f7hfpqkpzylb","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206314,"meta":{"port":62708,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"q5ercyqiqudcnnwwa2aakw4d","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206315,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"x2zhcwk92g8fbix3g66vlgq8","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206316,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"frv59k2phwh76ecfx04n5a3v","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206320,"meta":{"port":62710,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"lxw19kehaetciqx2ps995cmt","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206319,"meta":{"identity":"CS_PRIORITY","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"kzjl5xu67d7obi3a3h4rt9cf","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206322,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PRIORITY"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"p4raadw0loljfxtc31lnau08","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206324,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_PRIORITY"}}
{"id":"se43gwj43f11cg6fuvt198f7","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206325,"meta":{"identity":"CS_PRIORITY"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"lvy5bf26mhrabiw5iu4njjt5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206325,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"sndl2wkm0mtxtfw6miata273","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206326,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"l4ow7mqhqync3ccj6l001hyj","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206329,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"m1xvmynxvu7gr45kq3b8hrp2","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206331,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"i8rmqmngg8psv0qw7lfmgbzl","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206331,"meta":{"port":62712,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"k1pxn7wagqdrvr29shhciqqs","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206331,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"hmsg46dtdwuhkr0bvbmruy6w","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206332,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"ez9tgdzqikhtspvmfkq0q2t1","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206335,"meta":{"port":62713,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"fk2d1mdlwbnjx8io1diovtqw","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206336,"meta":{"port":62715,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"oxt081sjksesb85iqmez94my","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206336,"meta":{"identity":"CS_FALLBACK","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"drzcco33px528aso3kn9denf","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206338,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_FALLBACK"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"qende1heffbqaefdcwrf98k5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206339,"meta":{"identity":"CS_CLOSE_ALL","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"m27lgtkpchiexi9hhjwh2t1p","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206339,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"oqpjnciskfiog5pri154upye","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206340,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"njgicsb65oy6ot643l5jt8v7","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206340,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_CLOSE_ALL"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"yaqw6mcx66o3aa8wciosbvti","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206346,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_FALLBACK"}}
{"id":"uilg6r9w6379t74gldnfeg7w","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206346,"meta":{"identity":"CS_FALLBACK"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"ngklpllwv57nn31ujq8avdy6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206348,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"cw6njycbr2amepatxb3x1gx0","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206351,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"xc1krxn10tajl6aneuo8d49p","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206352,"meta":{"port":62718,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"fhas143cb0mg4ijq4u1qqcd2","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206353,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"cfhswk7wdoic86fpf1obhc66","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206356,"meta":{"port":62719,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"e67hn5o88z7emst4ddzjr58d","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206363,"meta":{"identity":"CS_WILDCARD","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"ne0f65aj9qmoqk41axr8i7he","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206365,"meta":{"port":62722,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"iuh9r4y9mbgxke6za1i603c2","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206365,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_WILDCARD"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"kcdnmo76vgcyexu5qogqmtxx","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206369,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_WILDCARD"}}
{"id":"j7z7yp192iclm406n494f427","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206369,"meta":{"identity":"CS_WILDCARD"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"jte92490w75otiqcb3zryg5i","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206370,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"ilkm19pyyb75qzbmu8g8v6sc","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206370,"meta":{"identity":"BR_EVT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"rxyelk0ju23nz1c3xnndiw4b","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206370,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"m9murfjnyf5p20nz6skkmtb9","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206371,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"flbt09l0jsd9aojoi9xs1g84","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206371,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_EVT"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"fmxtvaixo6lllc8hqpd0pmma","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206372,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"pme6zkuwr7wgeizdsa88s1ie","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206375,"meta":{"port":62724,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"uzejwkkcm8uh3yn0tsr8ws2w","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206377,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"odn7441ecptrfuo0srpaui7v","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206373,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_EVT"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"fyhursuqtekf7c6chkked6gq","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206379,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"rrtahr4qbm9sngvastkgqt4p","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206379,"meta":{"identity":"BR_EVT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould reject calls when not connected
[22m[39m{"id":"georoqvkl77y0v5li0e7jycc","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206382,"meta":{"port":62725,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould reject calls when not connected
[22m[39m{"id":"hfv5qpw7qg5akcl2xth4k9t1","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206384,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"o9b5th0zj23pg9zkx7l0y9xm","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206385,"meta":{"identity":"CS_RMALL","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"y874lkuemxima2bt5wh0xxam","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206386,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RMALL"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"mei796nv4jm29k67pu5oehso","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206389,"meta":{"port":62727,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"fs5h6nhnooe6c59cdhnpamo8","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206389,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_RMALL"}}
{"id":"sg44ueuhxk9kcihezgjgf0ff","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206390,"meta":{"identity":"CS_RMALL"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"bquel4w2ffwdzl3vbye56tla","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206394,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"urlatwfydgx5bfnsexss1io3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206390,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"hno2lb1eq60bqc0hr60gcx4z","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206396,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"ljei8iby9zwzb0gnwb31u5mf","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206397,"meta":{"port":62729,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"j1nms76pjawz30a3cxx13mb4","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206403,"meta":{"identity":"CS_RAW","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"kzm8poxli86w4vzuip7mpsbo","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206404,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RAW"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"njn2xxgnrc9krqs0a4vdquht","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206447,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"z9dxtpbzk2yjxccvohhex7z4","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206450,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_CLOSE_ALL"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"i4m1x56fthgklu0dntv4g4xy","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206450,"meta":{"identity":"CS_CLOSE_ALL"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose server stats
[22m[39m{"id":"qy8k1i8rva0bc9rndmfzjuf3","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206454,"meta":{"port":62731,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose server stats
[22m[39m{"id":"ioo8x4l8on61zi273n0ftbmx","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206459,"meta":{"identity":"CS_STATS","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose server stats
[22m[39m{"id":"v9gp0v9lu21fszuovhczj5qa","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206461,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_STATS"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose server stats
[22m[39m{"id":"nurmz3p51tgx3uvc7ngw9axb","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206577,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose server stats
[22m[39m{"id":"tr4qdnv1nv6ezb8vs0m8642m","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206578,"meta":{"identity":"CS_STATS"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"jmm880lmme8zdqx9ls4oc05r","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206584,"meta":{"port":62733,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"ch37cife19ri151aq7cnrafe","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206588,"meta":{"identity":"CS_INHERIT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"momndmc7t8tzkvw49xtqzktt","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206589,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_INHERIT"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"e6api3ssw2q8tevo16ro899o","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206590,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"t0vi3u158mx8yd6vxyv4s04o","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206591,"meta":{"identity":"CS_INHERIT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"vsyjhyapvk16ed2t4xas04jb","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206595,"meta":{"port":62735,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"ppfv80xg5ld9ftqo1a5lstpu","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206602,"meta":{"identity":"CS_NO_CONNECT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"af6madpzmftvul74hesis0wi","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206602,"meta":{"port":62737,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"appeih6rl77qv9ahz5s39ex9","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206603,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_NO_CONNECT"}}
[22m[39m{"id":"otjbg6w3hyijmymj1tjjxdjf","level":40,"levelName":"WARN","message":"Call timed out","timestamp":1771787206609,"meta":{"messageId":"af9600d9-93b5-4b2a-8b07-b43f29ea024b","method":"SlowMethod","timeoutMs":200},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"bc92vuc1ir09piod7v00hwnz","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206605,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"mp1gkg6rczz6showvnm1he9t","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206605,"meta":{"identity":"CS_NO_CONNECT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"mngfxk06rzkdacny78140f6l","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206606,"meta":{"identity":"BR_NO_RC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"xq7nv8y3re8skxxjw1yac1li","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206610,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_NO_RC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"rswndb9bi3f2pk9i7t7q6gb4","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206611,"meta":{"port":62739,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"lehtq96kdvbkdnyuw35w7mgx","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206611,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"h707ad4n7ckzci9lw3b9lvka","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206612,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"c073ayh76ffjwsimsh323wgd","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206613,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"exa4wvjzl2y4yp3e66l17ti0","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206613,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_NO_RC"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"x1td29nizg1svl4dmt7gr8tj","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206616,"meta":{"identity":"BR_NO_RC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"czk63a3vo4k6rsr79dp6j7nc","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206617,"meta":{"identity":"CS_SESSION","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"dj02ki47l3vdg732hoi1uuf3","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206618,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_SESSION"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"d8pgoakcvzt61klf60zd1jww","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206618,"meta":{"port":62742,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"bvl92cf2ylvrnrj6hz52tvzk","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206619,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"ah49uqfho798eqeratfpqg1d","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206620,"meta":{"identity":"CS_SESSION"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"f10fpjdwhxzonar0frbab2d1","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206621,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"xqvh8xr7w3c9rq8l88efvi2c","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206622,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould support forceful close() from server side
[22m[39m{"id":"lpzhd9uw5bkceqaqncdwyy7i","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206623,"meta":{"port":62744,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"lvzijyotylwl6dd0ne5r8zc7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206625,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"u32od0b1wq3pbihx1s91jqw8","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206626,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"d1c3r2btjk8pqytqxces2aac","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206628,"meta":{"port":62745,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould support forceful close() from server side
[22m[39m{"id":"g2mavcr7snfo0jydu9749na4","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206633,"meta":{"identity":"CS_SERVER_CLOSE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould support forceful close() from server side
[22m[39m{"id":"lsub3caj8xy2gdw9yoe7bo9v","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206634,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_SERVER_CLOSE"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"yc0kgpaa7qvuxvewxrd2pj0t","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206634,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"act8dym1n3qj2he0qher7ltw","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206635,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould support forceful close() from server side
[22m[39m{"id":"nx2jincjdlpni77m9rio9duf","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206637,"meta":{"identity":"CS_SERVER_CLOSE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"pd2g4wvsrpq61rw0l1w969un","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206638,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"gvblyk01vry6ihn41icvo7qw","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206638,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould support forceful close() from server side
[22m[39m{"id":"mgcy5lnjh1pzpyen2cmf6h4c","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206639,"meta":{"code":4000,"reason":"Kicked"},"context":{"component":"OCPPClient","identity":"CS_SERVER_CLOSE"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"w9byvx8u811bwd1pnclyv3r7","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206641,"meta":{"port":62748,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"ebgzqeto3q56qdvhpey3gvxi","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206648,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"u26afty5yp1lfabaozdqc6gu","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206649,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"vtkeepana9mdwypsjygkt0ws","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206654,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"hmeaixbvnp0cbo50862g4lg2","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206654,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"abfw4kx3qhu1d70sz3bbp53e","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206657,"meta":{"port":62751,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"ig8ozuzaf6dkoqd6c7csjr73","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206668,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"x8eojkv5z449zrsu0tcfxv58","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206669,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould use default voltlog-io logger when no logging config is set
[22m[39m{"id":"eo7rcu5wq723tmnglaxbqcc9","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206670,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_LOG_DEFAULT"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould support forceful close() from server side
[22m[39m{"id":"wdl3f6aun82cl1yhzpscbmjw","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206696,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould expose handleUpgrade getter for external HTTP servers
[22m[39m{"id":"s634l0rsx7vtlgjlgsnyiakp","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206701,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"upxdgjye1j97pdfv69ypzeox","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206704,"meta":{"port":62756,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"sf5527u9lj3455ft5rvw6nfi","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206713,"meta":{"identity":"CS_EXT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"a1maizjhr2f9hrz9rzrjc6g3","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206717,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_EXT"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"qmc6rnfy2ebtv2j7fbya0cwh","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206718,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"qav3sohwe8axfiit720ln4vk","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206720,"meta":{"identity":"CS_EXT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"ns28cnw7pqm2bmaamlh9md0h","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206719,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_RAW"}}
{"id":"tm2mgndm9n1uv9xtmtrap7ul","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206720,"meta":{"identity":"CS_RAW"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"m36rcagca355lvp3fxxc53es","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206721,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould reconfigure server options at runtime
[22m[39m{"id":"rku64fgvirdnt4uiemxxefqv","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206722,"meta":{"port":62760,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould reconfigure server options at runtime
[22m[39m{"id":"vctt02h7y5bdod344f0l193h","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206723,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"ifqo0qoco6tjnj6vpfhoh7kh","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206724,"meta":{"port":62762,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould set and use a custom adapter
[22m[39m{"id":"ctwkxfkhh8foendn6lif8i7p","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206727,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"l7b06o81sh5ne4y5c9mohfp5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206730,"meta":{"identity":"CS_RECONF","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"qghhgyyuhzpnsgwixisyhzvr","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206731,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONF"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould no-op publish when no adapter is set
[22m[39m{"id":"qzy6ua422f0t4vfukp5oske6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206732,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"yyxx6zngxi9u5smo203gy0to","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206732,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"pp5nubfmzsft6zbnbrql0gbd","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206733,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"bi7s4qw2ma2ue5nusm85e91f","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206733,"meta":{"identity":"CS_RECONF"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"yxmsmgb6xh5u9rkrv9ropt77","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206733,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"qyla7ssog3pceko4nmooukrg","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206736,"meta":{"port":62765,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"ruqotu6m16rpbrjyj8440873","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206736,"meta":{"port":62767,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould close server via abort signal
[22m[39m{"id":"fv50nbwoi1ueake6kp7lopmj","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206736,"meta":{"port":62766,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"gzrr5gmswgqzzzlf8wu1dsx3","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206739,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"uup8naunjrgc3r6zywh68kmu","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206739,"meta":{"identity":"CS_RECONF_STRICT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"dd7rfn5q0nw0zzmk8ci39cr5","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206740,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"bp4qf676l92tpbcdksxh566c","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206740,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONF_STRICT"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"pu9t2lcfbhts9tqlwgswcqq5","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206741,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"jn8o0cs3pjgeguogfbjy1w17","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206742,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"opse9t2zf1konlc7l1t13xg9","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206742,"meta":{"identity":"CS_RECONF_STRICT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"uzatp3aki1p8kwcf20l8a53t","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206743,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"v66yybh7e2ho33ubzs0ll0lt","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206747,"meta":{"port":62770,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"njkpesy7kklakntkl0t4c8g1","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206747,"meta":{"port":62771,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"psui0gf0lvnei1diuiqduiia","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206750,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"t7atgsb98kf1o2lj9n4o8odn","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206750,"meta":{"identity":"CS_RECONF_PING","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"rxu1jqn94nrj3sfzhvpw5bz4","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206751,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"oom1lpr5kjnzzopzgip37lsu","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206751,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONF_PING"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"umxlh9brlzavbrxcrxow8nt5","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206752,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"bv1fmzskx1ednpql52aq3hdx","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206753,"meta":{"identity":"CS_RECONF_PING"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"gbof6g38emqv82w35ehsqyr3","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206757,"meta":{"port":62776,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"dvwu4hdlam97nio7a3kg19ah","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206760,"meta":{"identity":"CS_BADMSG","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"fjhv4rnjasinwfh5oen3ujmf","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206762,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BADMSG"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"txy8d0311xxi5oti848o84th","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206827,"meta":{"port":62782,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"hu5xhq5gys485qsnbefhocng","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206831,"meta":{"identity":"BR_INT_CLOSE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"jbzqoi4412fdu5nixfv5heyq","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206833,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_INT_CLOSE"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"qkbt7gi7sd650lt044msbdzm","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206837,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"fltigpbgdv9em8tkqvz3zmhz","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206837,"meta":{"identity":"BR_INT_CLOSE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"lb8518auxtocwrzcoyktcxnx","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206840,"meta":{"port":62784,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould close server via abort signal
[22m[39m{"id":"a2xktxgf8njhc7z1xn3z9knx","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206841,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"vjwbssewjskigdmynws86898","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206845,"meta":{"port":62786,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"n4pqfjdgijz3l0ql9est5enq","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206845,"meta":{"identity":"BR_VALID","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"pyhhgpttci6eezuchee5qon8","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206846,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_VALID"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"f81n6topduwv4lju1qcl1ebg","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206849,"meta":{"identity":"CS_BC_1","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"pc4uocctq5dguo7premh8vzj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206849,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"ziphs9fb5z7vwefggvv94ijr","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206849,"meta":{"identity":"BR_VALID"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"g1n6d7oj4l087l5vksb6ojxs","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206850,"meta":{"identity":"CS_BC_2","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"vsk2d3zebaz010f05u9tvcqk","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206851,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BC_1"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"lld76yqs34r1zxz16j2a2kjn","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206852,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BC_2"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"lptskxrtuwqyaj5pedmvisad","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206852,"meta":{"port":62789,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"zkv81ra2dcpq368d9fu5mrag","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206855,"meta":{"identity":"BR_BAD","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"f9e39gvx2mszbxy0v4m84v58","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206856,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_BAD"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"rxnke1u37rpb0eu8xvoh3e8u","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206858,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"sk1yxidxpdkf1vq1utoha26t","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206859,"meta":{"identity":"BR_BAD"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"m5tofztcqfa9py67844ca2j4","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206862,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"f3etup1mly02lmrt18uegvv2","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206863,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould throw when sendRaw called in CLOSED state
[22m[39m{"id":"yevjq3e5xs7ic1g8p5gzk3t9","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206864,"meta":{"port":62791,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"bcajz8zw2tvrn9zsb5cpwey5","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206866,"meta":{"port":62792,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould throw when sendRaw called in CLOSED state
[22m[39m{"id":"dzp0ifd3gryvyssvjfskrl22","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206865,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"o5d4bvwf4d0jyimh5i5yvnnw","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206868,"meta":{"port":62794,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"prgpotfm3zi47wm3a0be8yid","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206869,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"f3k53fbx508rbim9jk99ox93","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206869,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"fpnzgo0awswob7te4j1a4pby","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206871,"meta":{"identity":"BR_OPEN","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"cki5djtv7tn1lm5pnvi0ba11","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206872,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_OPEN"}}

[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"estfl3fehsfy433x38ugp13c","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787206874,"meta":{"error":"Unexpected token 'i', \"immediate-msg\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"BR_OPEN"}}

[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"see3p1f87uq0fhsukjcqhtg1","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787206875,"meta":{"error":"Expected property name or '}' in JSON at position 13 (line 1 column 14)","count":1},"context":{"component":"OCPPClient","identity":"CS_BADMSG"}}

[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"olmosazelf2wwbbvxufw8mmf","level":40,"levelName":"WARN","message":"Received CallError for unknown messageId","timestamp":1771787206878,"meta":{"messageId":"msg1"},"context":{"component":"OCPPClient","identity":"CS_BADMSG"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"zlygmw675deotf3nia3lht05","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206964,"meta":{"clientCount":2},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"twxhnh968c0izyw5l8eqlsmy","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206965,"meta":{"identity":"CS_BC_2"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"t3jqu7ijoaqj2poqxuzkm5lo","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206966,"meta":{"identity":"CS_BC_1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"s5thrr65jb3ftygb7a5mjxfa","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206968,"meta":{"port":62796,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"naklefir35svp4zakz8yru9m","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206970,"meta":{"identity":"CS_PERSIST","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"cnxzkpwdmawxi0nb8rvd6qqu","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206971,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PERSIST"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"ernruxfoo1oqoux5epu1w9oj","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787206973,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_PERSIST"}}
{"id":"xubfbqdd450oa367wway57k8","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206973,"meta":{"identity":"CS_PERSIST"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"jrvqv17iscqdh41g5zjx5g6q","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206975,"meta":{"identity":"CS_PERSIST","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"agjouxq7f865aga7yd96qi9m","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206976,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PERSIST"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"jq6z7i6g2uncrbare2ou0rwo","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206976,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"qa8f10um9umgfh50gnlxdwtm","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206978,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"x962wlraaj2tahx15qvplxax","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787206979,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"wd6hpz0o74j0nc9syjkj6dyi","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787206979,"meta":{"identity":"CS_PERSIST"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"bt08szh056pwzh0hw92u7yha","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206981,"meta":{"port":62799,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"ufk7z6vjvblf44mvyom2ksqu","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787206981,"meta":{"port":62801,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"qrt66ndxswo22r81kse5eib0","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206986,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"nr1gmqeroxf3qliazjy3n1jr","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206988,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"j5tmfdp2fp10f1kflxy7w1v1","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787206981,"meta":{"identity":"CS_GC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"s3ep9och534vk9xp6116d1iw","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787206981,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_GC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"eelb6ihi90wohojmucvee0cz","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787236981,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_GC"}}
{"id":"rfj1oqh9lb4zk9skfjg7fxex","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787236981,"meta":{"identity":"CS_GC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"bpcyjffwywslrw2gn1re467e","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771790806981,"meta":{"identity":"CS_GC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"d822uvgwnmwoauhrxzvrq7ke","level":30,"levelName":"INFO","message":"Connected","timestamp":1771790806981,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_GC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"bk7vecftlkczvcik0pxvzodp","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771790836981,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_GC"}}
{"id":"j2is4ck1h0nd19l9sdr3b63e","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771790836981,"meta":{"identity":"CS_GC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"tlxcjydl2ufac0aheu51y7wc","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771798066981,"meta":{"identity":"CS_GC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"ghqqch403njjwaectzrisyi8","level":30,"levelName":"INFO","message":"Connected","timestamp":1771798066981,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_GC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"d3yby7zmydsleem85voi8bfn","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771798066981,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"x4pvgoa8wz2y1o5v9xbo1c6b","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771798066981,"meta":{"identity":"CS_GC"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould ignore broadcast messages from self (loopback)
[22m[39m{"id":"zv1jo1vge1jhsrpif768f150","level":40,"levelName":"WARN","message":"Received unicast for unknown client","timestamp":1771787207011,"meta":{},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould ignore broadcast messages from self (loopback)
[22m[39m{"id":"dqbn4snjl3wif28qmd2xk6v2","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207012,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould ignore malformed broadcast messages
[22m[39m{"id":"hef67hflbg19t2iuqx2vlzjz","level":40,"levelName":"WARN","message":"Received unicast for unknown client","timestamp":1771787207014,"meta":{},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould ignore malformed broadcast messages
[22m[39m{"id":"tisnwv5k1es3u2lj7zjwtfu7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207017,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould handle client errors during broadcast gracefully
[22m[39m{"id":"s963564y1xz819cc3oon3342","level":40,"levelName":"WARN","message":"Received unicast for unknown client","timestamp":1771787207018,"meta":{},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould handle client errors during broadcast gracefully
[22m[39m{"id":"wlaahm2fn8lm1gknv1tojgiv","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207042,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould handle broadcastBatch properly routing local vs remote clients
[22m[39m{"id":"yaiu55urhmjd6c65xio34nnp","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207050,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould ignore messages when global limit exceeded
[22m[39m{"id":"inafuf7nepkj9zbk2zl3eto5","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207053,"meta":{"port":62807,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould ignore messages when global limit exceeded
[22m[39m{"id":"gxgc3cgw01n3ln7ptu371gpd","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207056,"meta":{"identity":"RL_CS","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould ignore messages when global limit exceeded
[22m[39m{"id":"kxk013zhxlq4ao056drw7did","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207057,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"RL_CS"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"hnj8d2iy2sufrh237bp55963","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207076,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"qgbn6db6p5fji3hiteoo0fez","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207076,"meta":{"identity":"BR_OPEN"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"etffi3qwzzbcf63bmz2g2hhj","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787207080,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_BADMSG"}}
[22m[39m{"id":"hkibsisnf2crmruzucwzc83m","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771787207089,"meta":{"attempt":1,"delayMs":140},"context":{"component":"BrowserOCPPClient","identity":"BR_BUF"}}
{"id":"ol00gmk393cymc01e69tz254","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207081,"meta":{"identity":"CS_BADMSG"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"h2vvb1sqn5el1nvq7t662ldd","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207082,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"t9rtyw6vty43vw3dsz0s2pic","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207082,"meta":{"port":62809,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect

[22m[39m{"id":"q3i0b95slhdlf06n7qbuk6ze","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771787207092,"meta":{"attempt":1,"delayMs":61},"context":{"component":"OCPPClient","identity":"CS_RECONN"}}
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"r3rb8dx79298uwrbigfyxnbk","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207084,"meta":{"port":62812,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}


[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"zjn9ujfle737jnphw1axhre3","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207085,"meta":{"identity":"BR_BUF","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"pv31rwfgj30qod3zugct3rpb","level":50,"levelName":"ERROR","message":"Handler error","timestamp":1771787207093,"meta":{"messageId":"b0fksrs50w6o6pscv6u220xn","method":"UnhandledMethod","error":"No handler for method: UnhandledMethod"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}


[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"z1d4jc431npxsqylns0b5743","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207086,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_BUF"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"f59ybre475hhfcdumnsxsjz0","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207087,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"aw0mv5zn4qqwv1khgpmatsb5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207088,"meta":{"identity":"CS_RECONN","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"gbryfnpaqf1gngwpdj8yg8f4","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787207088,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_BUF"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"vvnpq0avmbid7wdazdr0oamz","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207089,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONN"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"b3ovn9t97nn52zfp25fa6zdu","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207090,"meta":{"identity":"BR_BUF"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"typ19b8ozvzvoprcmueeassm","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207090,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"plqiigtj2obqbe0rzbe8ehi4","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787207091,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_RECONN"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"fg95ujrrl86276vj0aa664dy","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207093,"meta":{"identity":"CS_RECONN"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"qwct88rzica9iv2zjdjqfytc","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207098,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"aozknobiiniahj22akwt4ddh","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207099,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"si81ck7l87d0qtgvxjor1jtw","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207103,"meta":{"port":62815,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"n1ju8339fmkl71ivi5sp2wvy","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207106,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"yfmqhqjzy2dtveqqf79usouj","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207107,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"wkupbm3kd8524nkiiail9bju","level":50,"levelName":"ERROR","message":"Connection error","timestamp":1771787207160,"meta":{"error":""},"context":{"component":"OCPPClient","identity":"CS_RECONN"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould ignore messages when global limit exceeded
[22m[39m{"id":"hmzh69cld8igsr3g95rba1kk","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207175,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould ignore messages when global limit exceeded
[22m[39m{"id":"oieurvxg8ojko2n9fg0pn6bk","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207176,"meta":{"identity":"RL_CS"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould disconnect client when limit exceeded if configured
[22m[39m{"id":"v4xoopeukzxp83p5cup54hgf","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207178,"meta":{"port":62819,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould disconnect client when limit exceeded if configured
[22m[39m{"id":"ocymr1x6k0aowopzaf82r86d","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207181,"meta":{"identity":"RL_CS_DC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould disconnect client when limit exceeded if configured
[22m[39m{"id":"ycp2qa97r37vxqjj44w8u7ls","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207181,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"RL_CS_DC"}}

[90mstderr[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould disconnect client when limit exceeded if configured
[22m[39m{"id":"nhio5tda6ukkpo22vyrloo3f","level":40,"levelName":"WARN","message":"Rate limit exceeded â€” disconnecting client","timestamp":1771787207187,"meta":{"identity":"RL_CS_DC"},"context":{"component":"OCPPClient","identity":"RL_CS_DC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould disconnect client when limit exceeded if configured
[22m[39m{"id":"avsfu8p5iof8drrgr4100fdh","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787207188,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"RL_CS_DC"}}
{"id":"o4x20tk9v11bmbm3a4gx8amg","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207188,"meta":{"identity":"RL_CS_DC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould disconnect client when limit exceeded if configured
[22m[39m{"id":"p8uh17zfv7gz7d55x7ej342c","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787207189,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"RL_CS_DC"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"arw03zn3tuuiko94j1udtqg3","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207201,"meta":{"port":62809,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"dqc4b1sc9ltiil8042gge0yx","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207217,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"qv94cvrheh3idmpzw9zgjcoo","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207218,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"xa0v0xe5q1qlqhvlvsdflqox","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207221,"meta":{"port":62821,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"lx30ks26b0puxli49p0yz8f8","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207226,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"dlzodxvg1mx1xh58703bl40c","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207227,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"xosy128mr5iuqsiwtxb80yxt","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207240,"meta":{"identity":"BR_BUF","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"a2u7x09k5r9zyuq0i2xf25km","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787207243,"meta":{"error":"Unexpected token 'b', \"buf-msg-1\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"BR_BUF"}}

{"id":"teba6lyxybaq1ha3tzt8s7ix","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787207243,"meta":{"error":"Unexpected token 'b', \"buf-msg-2\" is not valid JSON","count":2},"context":{"component":"OCPPClient","identity":"BR_BUF"}}
[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"vo2ep6cxkltf2rp9vxa2gdua","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207242,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_BUF"}}


[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer Rate Limiter[2m > [22m[2mshould disconnect client when limit exceeded if configured
[22m[39m{"id":"ee9xrhx0lqssphaff22o869g","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207298,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/server.test.ts [2m([22m[2m29 tests[22m[2m)[22m[33m 1614[2mms[22m[39m
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"f6ov7otrggs1sifby9bguzuc","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207338,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"oxwfupcdf5pjn9aderl1k9hg","level":50,"levelName":"ERROR","message":"Handler error","timestamp":1771787207335,"meta":{"messageId":"sgop5p3cdh7lxvdt74mfscsq","method":"Reset","error":"No handler for method: Reset"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()

[22m[39m{"id":"af539xyx391nhjesll03q0mo","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207339,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"qzq1a06ezw5e27y9bzryapry","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207341,"meta":{"port":62824,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"a11isdd7at2v19st42d42a3k","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207348,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"peh9osk5nx0y1vlvm5xq8kxr","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207349,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"dc38fydz4oy04w4rt2tp2bqx","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207461,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"g02yl709i6bv4g312j13swme","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207462,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove wildcard handler with removeHandler()
[22m[39m{"id":"xhx7ej9o7nktesvmnkbptgvj","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207465,"meta":{"port":62826,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()

[22m[39m{"id":"i1clp1mf91nxoogybpioq6bt","level":50,"levelName":"ERROR","message":"Handler error","timestamp":1771787207580,"meta":{"messageId":"f0k47pdc5cdlxe4d5zrwpdu5","method":"Reset","error":"No handler for method: Reset"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove wildcard handler with removeHandler()
[22m[39m{"id":"xlpvkbw97b541735o09k8eil","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207466,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"st3hqlkp17atuudcfnz3xbai","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207469,"meta":{"port":62827,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould emit error when connecting to non-existent server

[22m[39m{"id":"yefhx2jaylczc2xdd0ffn5cl","level":50,"levelName":"ERROR","message":"Connection error","timestamp":1771787207613,"meta":{"error":""},"context":{"component":"OCPPClient","identity":"CS_ERR"}}
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"iydyrv0z5w6lizo28h54rmyy","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207477,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"ayrhma0mbag9jbkfm21oz6zv","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207478,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"whgy1uuroq356hbi8hveiw2y","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771787208149,"meta":{"attempt":1,"delayMs":168},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}
[22m[39m{"id":"obs7iynmitbsv2oewc9u1jdi","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207582,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()

[22m[39m{"id":"g92hxj08cr7r21pepaghvdeb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207582,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open

[22m[39m{"id":"pkhfewhr5rmdhdsj931dpmre","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787208388,"meta":{"error":"Unexpected token 'b', \"buffered-msg-1\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould throw on invalid handle() arguments
{"id":"q1uz4y0modd1r58brbmsxe5m","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787208391,"meta":{"error":"Unexpected token 'b', \"buffered-msg-2\" is not valid JSON","count":2},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}

[22m[39m{"id":"o80wcfyfzb10o93zxp7hjym3","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207585,"meta":{"port":62831,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould throw on invalid handle() arguments
[22m[39m{"id":"oqsmv2n8xgi2u7ox8cm70h51","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207588,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"le69648m0agqpf5wqs8a9ksr","level":50,"levelName":"ERROR","message":"Handler error","timestamp":1771787208408,"meta":{"messageId":"uok2nxigme3y6g5yxns4smnl","method":"Buggy","error":"Something broke"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
[22m[39m{"id":"cl5dig0nhvwutwwhftcssber","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207590,"meta":{"port":62832,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"x58gsokilksfyjnrzdnzpg9f","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207593,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"rd8u9h6ydz8e8gikstzna6pi","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207594,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"tf9uqg1db9v3a4h1m1kcovuu","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207615,"meta":{"port":62836,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"rcscpwh33ucgebcv7ln7oavh","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787208690,"meta":{"error":"Unexpected token 'h', \"hello\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"CS001"}}
[22m[39m{"id":"et4lw8uogfwxo75hc9wlju7v","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207621,"meta":{"identity":"CS_PING","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"w2gz7ck0pkedse725fkcsnmz","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207622,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PING"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"ssk8zfb8cnlhb4tvgrbkvcf0","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207729,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"atelofiyj2zce82crkn8xf9b","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207731,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"yc951d7wtdxfe2xfd553kfjm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787207733,"meta":{"port":62838,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"fhp9kljz59tgekfe1o89wco1","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787207755,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"zv3g945ccgxxhrwlj6h36rdm","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787207756,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"grva1x9qrvcztrq2xqt33d0h","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787207980,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_PING"}}
{"id":"ib9xssoufra1zwh8kl17ti95","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787207981,"meta":{"identity":"CS_PING"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould emit upgradeAborted when client disconnects during auth

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"m3qzp733tv4ntbbfqqb76spq","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787207982,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"vc5wjll3pjdhf9t54972ik4r","level":40,"levelName":"WARN","message":"Handshake aborted","timestamp":1771787208870,"meta":{"identity":"abort-test-01","reason":"Socket closed during handshake"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"bnnj5o7h3mqqt3s2rijpn9lo","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208005,"meta":{"port":62945,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode

[22m[39m{"id":"d4ih1dltszrl8n3aoovo59mh","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208017,"meta":{"identity":"CS_STRICT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON

[22m[39m{"id":"vjo3vzgtcqohxnrg6catwvp6","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787208908,"meta":{"error":"Unexpected token 'o', \"not-json{{{\" is not valid JSON","count":1},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"zga2a4ni1p0machoctex7bb9","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208018,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_STRICT"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"blnz9g58lc0qm5qczp14ctm8","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208022,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"bnjkmzq0q09kzapcivqag6gq","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208032,"meta":{"identity":"CS_STRICT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"lmyz8olw47eq0vg3putnwjep","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208035,"meta":{"port":62949,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"s21r7kbjd5lki5jycqn3kgut","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208050,"meta":{"identity":"CS_VCALL16","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"gt4yqo4aguyvk5aqsh9n4dwy","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208051,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VCALL16"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[90mstderr[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould abort handshake on timeout
[22m[39m{"id":"nsbb5cbvy2kuqxigw09ws26s","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208055,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[22m[39m{"id":"mk0hsutg6xw6xf85j0plidcq","level":40,"levelName":"WARN","message":"Handshake aborted","timestamp":1771787209102,"meta":{"identity":"timeout-test-01","reason":"Handshake timeout"},"context":{"component":"OCPPServer"}}
[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"ttszmm8hmqvp0zsij4fh9xn8","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208061,"meta":{"port":62951,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"viuay0dlimiebpxnxc419nz0","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208065,"meta":{"identity":"CS_VCALL16"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes

[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"r7ag7i2qu0r9jpuznkgs31fh","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787209211,"meta":{"error":"Message is not an array","count":1},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
[22m[39m{"id":"ew6orl6c1nx5gwdbrjevukhq","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208065,"meta":{"identity":"CS_VALID_CODE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes

[22m[39m{"id":"msxpngx8pqgxo2f3vg2lyw7r","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208066,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VALID_CODE"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"r1g1xaqcza47gy84wdx4vrii","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787209417,"meta":{"error":"Unexpected token 'i', \"immediate-msg\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"CS_IMMED"}}

[22m[39m{"id":"nmdw0kkub9dmxr9wqkiedkad","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208069,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"ce5s26vuv7z1ishr5bb49266","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208070,"meta":{"identity":"CS_VALID_CODE"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"o291qyp9j8mgntbpdm5oqbyb","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787209477,"meta":{"error":"Unknown message type: 99","count":1},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}


[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"exb9ml1o0bxyhpic0eh4ijws","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208071,"meta":{"port":62953,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached

[22m[39m{"id":"vh6g26nxrk4vgb59v9wody6k","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787209846,"meta":{"error":"Unexpected token 'b', \"bad1\" is not valid JSON","count":1},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
{"id":"w3dtogajnx1xa2gfrxymxts3","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771787209846,"meta":{"error":"Unexpected token 'b', \"bad2\" is not valid JSON","count":2},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept custom close codes (4000-4999)

[22m[39m{"id":"dz31flaxr6fvf6kjza4pdczt","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208072,"meta":{"port":62954,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"atd2fdplxnp0wytpoo4kt8n1","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208082,"meta":{"identity":"CS_VCALL201","remoteAddress":"::1","protocol":"ocpp2.0.1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept custom close codes (4000-4999)
[22m[39m{"id":"iwwlqanlh1jaf17jyngd0htk","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208083,"meta":{"identity":"CS_CUSTOM_CODE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"kaf8ckz8savozjhqzjesb84s","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208084,"meta":{"protocol":"ocpp2.0.1"},"context":{"component":"OCPPClient","identity":"CS_VCALL201"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept custom close codes (4000-4999)
[22m[39m{"id":"d8du89ywirbyofb7kb32fimt","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208084,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_CUSTOM_CODE"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"shpum3qooc7vmo2ct9517eis","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208086,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept custom close codes (4000-4999)
[22m[39m{"id":"dp9srn7vis0nvl1cakjctnul","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208086,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept custom close codes (4000-4999)
[22m[39m{"id":"erzr8yx2t7g136jdh7a8ulyf","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208087,"meta":{"identity":"CS_CUSTOM_CODE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"o5tmfm9exu5uc14qxc07ax2h","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208088,"meta":{"identity":"CS_VCALL201"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"yiaxsfnrfz1w22ka2xa5uqcq","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208090,"meta":{"port":62957,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"opkaatghq7o5xfjg71wcqinm","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771787210264,"meta":{"attempt":1,"delayMs":47},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
[22m[39m{"id":"xv2q3hrloiu81pby1tuk2skv","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208091,"meta":{"port":62958,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"x7dp1hl0ihvon3b1gcf094dd","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208101,"meta":{"identity":"CS_BAD_CODE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"zsv6ffdokq91wn4pajwghmzx","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208101,"meta":{"identity":"CS_VCALL_DEF","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"c5lodq9bri68bsx38ellt4ew","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208102,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BAD_CODE"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"zge8vk0k6jp0t71ej4p59yco","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208103,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VCALL_DEF"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"icl25s62wl4j9vt0mpn1vy67","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208103,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"bnqw36ch05qcllamg1mrqc6s","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208104,"meta":{"identity":"CS_BAD_CODE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"a11htu1ps7ce2ubvwbsb6uh6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208105,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"fkk9akohq532wgy9ysaxl1pv","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208107,"meta":{"port":62962,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"cueryo4ur79z334bx9io8z83","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208118,"meta":{"identity":"CS_VCALL_DEF"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"glsd4gxs7g91tiwnslelpmjf","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208121,"meta":{"port":62966,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"e0zyadrigaxsp1st138a1lhg","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208125,"meta":{"identity":"CS_VCALL_SRV","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"tfobwfidkce8yeeulemme0cg","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208130,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VCALL_SRV"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"p39jyelit1fkpdvff034a7lp","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787208133,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_VCALL_SRV"}}
{"id":"he47zsub2mf4okhas257qdm9","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208133,"meta":{"identity":"CS_VCALL_SRV"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"vt1bxv836ghezujt00tk511m","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208135,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"dkj0a9xck00x5qm8dvs4ovta","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208142,"meta":{"identity":"CS_BUFFER","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"x58ct6qi4dgtufyeqxnrf434","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208146,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"arkyuga6wlim96lzjcxngx9x","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208147,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"r9rlc5z8u6xj7rnd7dyar14v","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787208148,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"i09r3es127vtw20zebim3bgv","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208150,"meta":{"identity":"CS_BUFFER"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/client.test.ts [2m([22m[2m39 tests[22m[2m)[22m[33m 2506[2mms[22m[39m
   [33m[2mâœ“[22m[39m OCPPClient - Advanced Features[2m > [22mshould send raw message via sendRaw [33m 327[2mms[22m[39m
   [33m[2mâœ“[22m[39m OCPPClient - Advanced Features[2m > [22mshould handle bad messages and emit badMessage event [33m 328[2mms[22m[39m
   [33m[2mâœ“[22m[39m OCPPClient - Advanced Features[2m > [22mshould attempt reconnect on unexpected disconnect [33m 527[2mms[22m[39m
   [33m[2mâœ“[22m[39m OCPPClient - Advanced Features[2m > [22mshould use ping when pingIntervalMs is set [33m 369[2mms[22m[39m
[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"kz59gkbaubmwt2o91e2ep2oo","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208188,"meta":{"port":62962,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"xn2fruojy2bpmzt6vtc8c3b8","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208238,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"yzyhhy0rzsn3n96lbm7945t3","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208239,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"mjfnaomdplkhizsefhs4ugrl","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208242,"meta":{"port":62973,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"w6g61kpdmu0mjzyfgzizqgtx","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208250,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"aaktyqef1vsi9cxxdsb8n32t","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208251,"meta":{"identity":"BR_BUF"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/logger.test.ts [2m([22m[2m16 tests[22m[2m)[22m[33m 1656[2mms[22m[39m
   [33m[2mâœ“[22m[39m Logger Integration - Client[2m > [22mshould log reconnection attempts [33m 523[2mms[22m[39m
   [33m[2mâœ“[22m[39m Logger Integration - Client[2m > [22mshould log bad messages [33m 341[2mms[22m[39m
[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"su94i884bl14vzsi2oa77zq6","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208254,"meta":{"port":62974,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"uu3xt0dd86tw803li0k4ehxh","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208258,"meta":{"identity":"BR_PENDING","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"ubudlncernmgu7og31a8wf65","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208259,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_PENDING"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"cju2rvkp3x0ovqpjmgq3kwp5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208276,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/streams.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 3059[2mms[22m[39m
   [33m[2mâœ“[22m[39m Redis Streams Persistence[2m > [22mshould persist messages when node is offline [33m 3049[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"fw9r48pa0a8nkqaw9ppypji4","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208303,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"jzru4bizo62syzlihmaihe80","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208380,"meta":{"identity":"CS_BUFFER","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"w5u4n74m1cle5gltfpcrderi","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208382,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"hlbao8hawhaofap0r83zssik","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208398,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"mdq2tkmlh8y0ff3jvwumskxj","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787208400,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_PENDING"}}

[90mstderr[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould reject connection if middleware throws
[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"b7m4um7fewn6tox7s6kvmyo8","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208401,"meta":{"identity":"BR_PENDING"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/browser-robustness.test.ts [2m([22m[2m11 tests[22m[2m)[22m[33m 2610[2mms[22m[39m
   [33m[2mâœ“[22m[39m Browser Phase 3 â€” Reconnect State[2m > [22mshould stay in CONNECTING state during reconnect backoff [33m 323[2mms[22m[39m
   [33m[2mâœ“[22m[39m Browser Phase 3 â€” Outbound Buffering[2m > [22mshould buffer sendRaw messages during CONNECTING and flush on open [33m 1173[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"rl22v9hr40frruldydybwmni","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208422,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"gudlilv0c4545lnvyxi9tvs3","level":40,"levelName":"WARN","message":"Auth rejected","timestamp":1771787211227,"meta":{"identity":"CP-1","code":403},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true

[22m[39m{"id":"s0m748zv8l9ckkxzif32nqpy","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208423,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould reject connection if middleware throws

[22m[39m{"id":"jbrqb93wvwz6penctbo56ls4","level":50,"levelName":"ERROR","message":"Unexpected HTTP response","timestamp":1771787211229,"meta":{"statusCode":403},"context":{"component":"OCPPClient","identity":"CP-1"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept outgoing calls
[90mstderr[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould securely reject connections using ctx.reject()
[22m[39m{"id":"bb07c91ah8sdtly6evoaq9sn","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208447,"meta":{"port":62978,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"yi8n3nnohb5166e6iay19e8g","level":40,"levelName":"WARN","message":"Auth rejected","timestamp":1771787211491,"meta":{"identity":"CP-1","code":403},"context":{"component":"OCPPServer"}}


[90mstderr[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould securely reject connections using ctx.reject()
[22m[39m{"id":"jg5pg1znhbknlth3w5siivr0","level":50,"levelName":"ERROR","message":"Unexpected HTTP response","timestamp":1771787211493,"meta":{"statusCode":403},"context":{"component":"OCPPClient","identity":"CP-1"}}

[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould emit error event on WebSocket error
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept outgoing calls
[22m[39m{"id":"u87fpbidvnp6tzt312klq7fn","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208458,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"hapv9bzu1aa8ceyxbqifk9bk","level":50,"levelName":"ERROR","message":"Connection error","timestamp":1771787212107,"meta":{},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept outgoing calls
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"k0a73yaia2h9w99crrni6bns","level":50,"levelName":"ERROR","message":"Handler error","timestamp":1771787212263,"meta":{"messageId":"ce8uy20b2x0gf2ezt483vcjn","method":"Buggy","error":"unexpected error"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
[22m[39m{"id":"br523awxpi6roxlhqwt7v2ro","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208459,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept outgoing calls
[22m[39m{"id":"p2ak9g8trkq1ow4js7hsn1t5","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208464,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept outgoing calls
[22m[39m{"id":"wbzv7qv71kdzu4ael60pb5um","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208465,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming calls
[22m[39m{"id":"sifm63y99m4635tjhsgb8gd6","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208468,"meta":{"port":62980,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming calls
[22m[39m{"id":"k1d830deprlwo1y07y7ziync","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208490,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming calls
[22m[39m{"id":"f88dctu0x4z6tsomtp75f7ng","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208491,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming calls
[22m[39m{"id":"owgteltrzbpv7x9l9e2x3ynn","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208595,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming calls
[22m[39m{"id":"up51oyc4w841onxm44ctwaen","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208597,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould reject connection if no route matches
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming results
[22m[39m{"id":"dqpmnfywh6jl04uhk78f9lqe","level":40,"levelName":"WARN","message":"Connection rejected: No matching route found","timestamp":1771787213048,"meta":{"pathname":"/wrongpath/CP-REJECT"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"hp0r7xm2g5utfqapa0libpfk","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208599,"meta":{"port":62983,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming results
[22m[39m{"id":"hjuwdgx8j6xqhr2a4lt5baxi","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208605,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming results
[22m[39m{"id":"u16fdbt4gwwpfi1ytzrjlp80","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208606,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming results
[22m[39m{"id":"cf8dzjbbjkews0wr0zw35eur","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208608,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming results
[22m[39m{"id":"jbbb92lrfyorqlakflyvv95c","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208609,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming errors
[22m[39m{"id":"e5r05nxlfi430bc0ohi16rug","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208613,"meta":{"port":62985,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming errors
[22m[39m{"id":"j162is0rafbalgz2x7lautnx","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208621,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming errors
[22m[39m{"id":"vrnz7xpodwyp1twzn15zqu3w","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208622,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming errors
[22m[39m{"id":"e5lyml6e1i3hethkh5io8ft3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208625,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming errors
[22m[39m{"id":"vesp8ahhtdjmzjjzh5838505","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208626,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"mn0e3iyvugwi4zlx5oyv7vog","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208642,"meta":{"port":62988,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"l2v0ahtfct0grz0pzrx5bn2m","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208682,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"jzazxrvf41us5qoiv4txnzwj","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208683,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"w8hyvmqx2po32m155h3t57oj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208692,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"fbi61vs7k8yis9niso9zjzmn","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787208693,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould throw when not connected
[22m[39m{"id":"s01xegjre2wporr6wy9oyw7f","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208716,"meta":{"port":62990,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould throw when not connected
[22m[39m{"id":"ljr045f1zkdvpbb30kdpgl5u","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208742,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update options
[22m[39m{"id":"uohau1u95l5rrum959yyt6ag","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208750,"meta":{"port":62993,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update options
[22m[39m{"id":"mwc3lcvq76wcj68qdjcj7exo","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208751,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update call concurrency dynamically
[22m[39m{"id":"ighne45x0q247il7utjiwa9s","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208754,"meta":{"port":62994,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update call concurrency dynamically
[22m[39m{"id":"yi5ggvlkfab5sw59b81tdo0z","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208755,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"u9gjkwvn3n8ae5nxxknisktm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787208758,"meta":{"port":62995,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"b0cmk955adj0sdx3wkct3c9o","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787208761,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"zwpx4d4gdaumzxw6sz9sylbn","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787208762,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould emit upgradeAborted when client disconnects during auth
[22m[39m{"id":"yr5i1cntxd9xx9reyvs9c8q6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787208875,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"g42j68dcv6kp3hcdsy5skevu","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787209057,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"s8ex9pz7mqn4b0qqddt4flum","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787209058,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"umb1id95bgg41atogfsm36ip","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787209078,"meta":{"port":62999,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"reps782ciir7wp2sr8ofc603","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787209103,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould abort handshake on timeout
[22m[39m{"id":"btxw25cc5tp7g7n6313ocdk1","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787209108,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"ryt2xewk5mjift4ml4k8xb8x","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787209108,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould connect successfully with valid auth
[22m[39m{"id":"plhv6opwljp4lbmauj9s8gtl","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787209140,"meta":{"identity":"valid-test-01","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould connect successfully with valid auth
[22m[39m{"id":"liu40buita104s9sxfeve3ls","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787209145,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould connect successfully with valid auth
[22m[39m{"id":"sp0c2l9bmxr7vndpc8izwpru","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787209150,"meta":{"identity":"valid-test-01"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould support colons in identity via Basic Auth
[22m[39m{"id":"p0ncgrfbb9yln4zst5ydj535","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787209157,"meta":{"identity":"station:01","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould support colons in identity via Basic Auth
[22m[39m{"id":"ror4nyf9od3xxbkl1bi56nxc","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787209190,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould support colons in identity via Basic Auth
[22m[39m{"id":"twfyrp7p9a8xg6bt12k1x9g2","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787209212,"meta":{"identity":"station:01"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/handshake-robustness.test.ts [2m([22m[2m4 tests[22m[2m)[22m[33m 685[2mms[22m[39m
   [33m[2mâœ“[22m[39m OCPPServer - Handshake Robustness[2m > [22mshould emit upgradeAborted when client disconnects during auth [33m 347[2mms[22m[39m
[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"arf26sumz2846jfckn7jaiem","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787209248,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}
{"id":"jqqn8yz4kzfumw9qzvuqxkwd","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787209249,"meta":{"identity":"CS_BUFFER"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"u9bx4ox4xfyjwqmyv35tk3xj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787209250,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould throw when sendRaw called in CLOSED state
[22m[39m{"id":"lgmbs21fazpyx52n93k7joad","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787209254,"meta":{"port":63005,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould throw when sendRaw called in CLOSED state
[22m[39m{"id":"mtjsdkupjneht8n9cs5nno09","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787209307,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"eldbuso9mxxnbcl6ddkxzpp0","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787209314,"meta":{"port":63006,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"qk9puruaa3ptav5lcwiauy5r","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787209320,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"dmva0ni3cpa618bbf2rkjfio","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787209321,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"hrbpdprzsyf541nufdku3o98","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787209324,"meta":{"port":63008,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"gcy9bg88dxgxj0jteygkx8fk","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787209327,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"taktkk31p0mth9p9r4alhwql","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787209328,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"g5d57v4gv20t6el3oiueauiu","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787209408,"meta":{"identity":"CS_IMMED","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"jalip3r907u6neqtzj8wr6e1","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787209414,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_IMMED"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"r9xedwr7jmhrm8c5htps52zu","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787209557,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_IMMED"}}
{"id":"xk3l0415a5qcqnwr97nxtcsg","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787209560,"meta":{"identity":"CS_IMMED"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"uydq66e0z5cva0c5b4apq43u","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787209564,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"xk9p7rzfs0096i6ze6ak9d1m","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787209570,"meta":{"port":63012,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"qnr9ze0urmxubq9y1j6ty5p8","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787209638,"meta":{"identity":"CS_PENDING","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"olzpfzgvk18ojqzzlxnefia2","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787209651,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PENDING"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"hh0b3p0tyf6rkavpcki26bud","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787209655,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"odptj7pmnmwv81y1zdr4s52z","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787209656,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"ww3ci03kvy5rtgt24cftkbmh","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787209665,"meta":{"port":63014,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"snsqt205ybq77glqh13ubm42","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787209667,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"qsw7nd161gxeq16hxejb6ycf","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787209742,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"kw2t7n281nhl0irycvxskf9q","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787209743,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"pkz7845m6onjn13s6jy3wbe4","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787209668,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_PENDING"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"zldm3jhxzn60wldxekoyxal6","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787209745,"meta":{"identity":"CS_PENDING"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Protocol Narrowing[2m > [22m[2mshould narrow protocols to negotiated protocol after first connect
[22m[39m{"id":"w6z0pbw2mur8ekheailr34ya","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787209749,"meta":{"port":63016,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Protocol Narrowing[2m > [22m[2mshould narrow protocols to negotiated protocol after first connect
[22m[39m{"id":"myydhinelv4uujvbyg3wie5l","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787209839,"meta":{"identity":"CS_NARROW","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Protocol Narrowing[2m > [22m[2mshould narrow protocols to negotiated protocol after first connect
[22m[39m{"id":"nhzfr45eifj8gd9ltv1duthm","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787209840,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_NARROW"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Protocol Narrowing[2m > [22m[2mshould narrow protocols to negotiated protocol after first connect
[22m[39m{"id":"ois0hmlsmyfo8bmi06igr0it","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787209841,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Protocol Narrowing[2m > [22m[2mshould narrow protocols to negotiated protocol after first connect
[22m[39m{"id":"mcf9gz811rv26bqz7wcpa0jb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787209842,"meta":{"identity":"CS_NARROW"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"rs20j3ukov5a4trm8klwtq56","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787209850,"meta":{"code":1002,"reason":"Too many bad messages"},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"ygzu49n0ptmxgzlgjli3138w","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787209850,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/robustness-phase3.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 4238[2mms[22m[39m
   [33m[2mâœ“[22m[39m Phase 3 â€” disconnect vs close Events[2m > [22mshould emit 'close' when max reconnects exhausted [33m 2049[2mms[22m[39m
   [33m[2mâœ“[22m[39m Phase 3 â€” Outbound Message Buffering[2m > [22mshould buffer sendRaw messages during CONNECTING and flush on open [33m 1146[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"u4ouck0pmq11ehdcq1rt0cuf","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787210110,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"rf0025x6efago1bhayilwfw1","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787210121,"meta":{"port":63018,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"h5caqnc5pawryoa3ixatxu0k","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787210125,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"txn45e3f6zr22r0nlkmmwa9e","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787210126,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"vlidovophfgla0wbck316t90","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787210263,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"g8lhvgbv70u1v1rz2zrhd23r","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787210265,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"l0fddrmxnz405q4zf924dvlx","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787210432,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"tguk353bhnqyttwuf7h5n6le","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787210435,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould accept valid payload in strict mode
[22m[39m{"id":"xlptxvrdaduagqroa4njtb9r","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787210548,"meta":{"port":63023,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"qn7ebvn80hzik7mt36tdd11k","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787210610,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"tilluzqwl2knq6b4a72ucie4","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787210612,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"w36o1nadwzj74e9th1lqgda9","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787210618,"meta":{"port":63024,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"wfym4u8gvcedxzx3mwckjsd7","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787210624,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"hanei8ilbgehvk2l5pyhewgk","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787210627,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould accept valid payload in strict mode
[22m[39m{"id":"ybhm9z2hbrz1kzswm8244ekt","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787210734,"meta":{"identity":"CS_VALID","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould accept valid payload in strict mode
[22m[39m{"id":"o5zm200wc07dz81f7f082vrp","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787210740,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VALID"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"zfcb2hz75xjo8a8spku0pt2o","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787210773,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"bf6nh00p1velxixze4db9c18","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787210775,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould accept valid payload in strict mode
[22m[39m{"id":"lobtzp3uygvdgd7eq9zc8xd6","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787210821,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_VALID"}}
{"id":"orhpespwnibmloesoklbx7i9","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787210824,"meta":{"identity":"CS_VALID"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould accept valid payload in strict mode
[22m[39m{"id":"j8092ajzn6ul6vdq65ekkd9i","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787210849,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould reject invalid payload in strict mode
[22m[39m{"id":"lumr2dyi8a8fcp3izsujlr9l","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787210856,"meta":{"port":63027,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould reject invalid payload in strict mode
[22m[39m{"id":"s5uodfe2yhgzgxn7cwvnqman","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787210935,"meta":{"identity":"CS_INVALID","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould reject invalid payload in strict mode
[22m[39m{"id":"mmzycciik5ny9qzc7uj4d3zk","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787210937,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_INVALID"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould reject invalid payload in strict mode
[22m[39m{"id":"z8rm8yn3tw051ncn5n7ccf83","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787211003,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_INVALID"}}
{"id":"x2i8xubyuiwow1f591h2srug","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787211004,"meta":{"identity":"CS_INVALID"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould reject invalid payload in strict mode
[22m[39m{"id":"p7t1o9ll6j6y7jae4strtmnn","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787211008,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/validation-inbound.test.ts [2m([22m[2m2 tests[22m[2m)[22m[33m 484[2mms[22m[39m
   [33m[2mâœ“[22m[39m Inbound Validation (Strict Mode)[2m > [22mshould accept valid payload in strict mode [33m 324[2mms[22m[39m
[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m{"id":"d087ihk5wsfmi8pvt9bc2979","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787211051,"meta":{"port":50869,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"f6scxq09tsp9wbwgezh3iezq","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787211094,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"iuvcda00x8es2k4ga4kqo6hs","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787211107,"meta":{"port":50870,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"qatv30oufrw7o9dke0hgwwwz","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787211116,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"p6fwf09dq6v7czof13po2k40","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787211119,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"gblop2uv5aog7gjkmuq7m64c","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787211120,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"o0h120d5vuu6pla5fyro444e","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787211133,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"tnunzl1efcdufr1iaamhtx72","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787211136,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"s2vn3ew2mm1t2d0gatzyf3wu","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787211162,"meta":{"port":50872,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m{"id":"rc4vlwsnbiemed3lpw020hc1","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787211179,"meta":{"identity":"CP-1","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m{"id":"tzz9jhrc47k8sda0p6t9lx40","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787211184,"meta":{"protocol":""},"context":{"component":"OCPPClient","identity":"CP-1"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m{"id":"hzcs7s6igu99to9jr0ydv5d7","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787211194,"meta":{"identity":"CP-2","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m{"id":"tdn1w9vom586zcmtlei0g9gr","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787211196,"meta":{"protocol":""},"context":{"component":"OCPPClient","identity":"CP-2"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m{"id":"ppm0h392m4hyboq8i8tu6tnf","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787211212,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CP-1"}}
{"id":"y75gty0yk4jx3h8rwfee0v92","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787211214,"meta":{"identity":"CP-1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould reject connection if middleware throws
[22m[39m{"id":"vtnbbj5h6wej12kgxcyq2y16","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787211220,"meta":{"port":50875,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould reject connection if middleware throws
[22m[39m{"id":"bpqq74vryxrzjsxzl9n355qo","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787211223,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CP-2"}}
{"id":"kchg2rw3dgefd1qz3iktzj8e","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787211224,"meta":{"identity":"CP-2"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould support a global catch-all router via server.use()
[22m[39m{"id":"ljfy1lh1bxnr2xjovhef6an7","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787211235,"meta":{"port":50878,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"ud6d6z5hmumn0fm0nwq04set","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787211244,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"s6mcc6v1j2tb04d2ztf62tcg","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787211246,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould support a global catch-all router via server.use()
[22m[39m{"id":"xnsfm9g0oz3pgr9211hk0g6f","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787211306,"meta":{"identity":"CP-1","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"vfqy3m2qaaum0z5evdihssfg","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787211375,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"ieoec8e9kw6gd7shc2z2acey","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787211376,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould support a global catch-all router via server.use()
[22m[39m{"id":"cu3tu53ldh0lnz45zg23yp18","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787211410,"meta":{"protocol":""},"context":{"component":"OCPPClient","identity":"CP-1"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould securely reject connections using ctx.reject()
[22m[39m{"id":"bf2fdukpv61xqj42w3tvfvqh","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787211450,"meta":{"port":50881,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould securely reject connections using ctx.reject()
[22m[39m{"id":"aabcr9ptlm5vziwf61pajwbl","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787211485,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CP-1"}}
{"id":"orl0qpyb4y83uasmj2r0km18","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787211486,"meta":{"identity":"CP-1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould merge payload into ctx.state when using ctx.next(payload)
[22m[39m{"id":"bay6g5bclofdvq4uhzf867pa","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787211498,"meta":{"port":50883,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould merge payload into ctx.state when using ctx.next(payload)
[22m[39m{"id":"f2y90poz26bpvh6a3r2gfxwy","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787211557,"meta":{"identity":"CP-1","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould merge payload into ctx.state when using ctx.next(payload)
[22m[39m{"id":"pyx1xip58wt2q4ow2lduaxb6","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787211559,"meta":{"protocol":""},"context":{"component":"OCPPClient","identity":"CP-1"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould support defining handlers directly on the router via .handle()
[22m[39m{"id":"gj83avrbi02sl04m6bklvmji","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787211605,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CP-1"}}
{"id":"wp6f812fo6hex63yajau4vtu","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787211605,"meta":{"identity":"CP-1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould support defining handlers directly on the router via .handle()
[22m[39m{"id":"zpml11lic382d5zjvnaxxftc","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787211609,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CP-1"}}

 [32mâœ“[39m test/router-middleware.test.ts [2m([22m[2m6 tests[22m[2m)[22m[33m 591[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"hvrcm3lu675wlzp9a2tb6w3l","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787212057,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould emit error event on WebSocket error
[22m[39m{"id":"zxh0bshndm2khfmmomqc66h7","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787212061,"meta":{"port":50888,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould emit error event on WebSocket error
[22m[39m{"id":"pwb0sekgo09hnauxv1xe9t5k","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787212109,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"q51lg5aihx09nl1l3girhvqv","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787212111,"meta":{"port":50891,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"affxqhp5ovnt7vfaj98ox6fh","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787212118,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"mla21u29to23iw0vkgjq6hdz","level":30,"levelName":"INFO","message":"Connected","timestamp":1771787212141,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

 [32mâœ“[39m test/logger-reexport.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 90[2mms[22m[39m
[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m{"id":"l2i61phyvp0ibsxperbef6ws","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787212226,"meta":{"port":50893,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"cp8eexa17ekr5q87umz249tw","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787212266,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"mj0xzglqzacagmctdla6pysk","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787212266,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBrowser Index Exports[2m > [22m[2mshould export all expected modules
[22m[39m{"id":"zmdy22kz7k3euva5mujrm90g","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787212271,"meta":{"port":50894,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match default fallback route (legacy behavior)
[22m[39m{"id":"vxlbcx1sfu9icc3eef39ysj8","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787212394,"meta":{"port":50895,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m{"id":"qj1qq4d7g18uz1rikjvy05y3","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787212493,"meta":{"identity":"CP-Unicast-1","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBrowser Index Exports[2m > [22m[2mshould export all expected modules
[22m[39m{"id":"y6ccq1ofp3qibjzov88wi1yr","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787212570,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/browser-client.test.ts [2m([22m[2m61 tests[22m[2m)[22m[33m 6771[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould support NOREPLY from handler [33m 508[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mBad Messages[2m > [22mshould emit badMessage for invalid JSON [33m 304[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mBad Messages[2m > [22mshould emit badMessage for unknown message type [33m 336[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mBad Messages[2m > [22mshould close after maxBadMessages is reached [33m 457[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mReconnection[2m > [22mshould emit reconnect event after unexpected close [33m 498[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mReconnection[2m > [22mshould not reconnect when reconnect is false [33m 482[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mReconnection[2m > [22mshould stop reconnecting when reconfigure disables reconnect [33m 916[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mBrowser Index Exports[2m > [22mshould export all expected modules [33m 303[2mms[22m[39m
[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39mPresence Node ID: cla9pm0p9f4ebzf1p37jr71v
Client A found: [33mtrue[39m
Node B sending to client...

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m[MOCK] client.call called with GetDiagnostics { location: [32m'remote'[39m }

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match default fallback route (legacy behavior)
[22m[39m{"id":"p4ie6af7l6zxcgb3tc7ayhez","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787212711,"meta":{"identity":"CP-LEGACY","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match default fallback route (legacy behavior)
[22m[39m{"id":"jsab2h4x0u5mayf38t0wvhkr","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787212718,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match default fallback route (legacy behavior)
[22m[39m{"id":"dv41ova0hx4gpajar6pftpcm","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787212724,"meta":{"identity":"CP-LEGACY"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match string route and extract params
[22m[39m{"id":"xlpkqn6lty4ekt26tmqm5x9o","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787212729,"meta":{"port":50900,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39mNode B sent.
Verification passed.

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m{"id":"fo6gvibwl749e4klbk8vj3kd","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787212880,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CP-Unicast-1"}}
{"id":"cnxsihahfjeyklx83zo1azzd","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787212881,"meta":{"identity":"CP-Unicast-1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m{"id":"agxakjbhlx23rzfuzxatxo4l","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787212888,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match string route and extract params
[22m[39m{"id":"lyxt4bis1gemhtj4wc230qw4","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787212898,"meta":{"identity":"CP-001","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match string route and extract params
[22m[39m{"id":"prtdlzg2a57nz1wk2w8qbejz","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787212901,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match string route and extract params
[22m[39m{"id":"ab4kfng92eaf2ov3iv6alu4i","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787212904,"meta":{"identity":"CP-001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match RegExp route and extract named groups
[22m[39m{"id":"bjuqrnils85vyhp0vxexj5ep","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787212912,"meta":{"port":50911,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m{"id":"wfsifbnhm6jelkflk3o9hxtf","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787212925,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/unicast.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 768[2mms[22m[39m
   [33m[2mâœ“[22m[39m Unicast Routing (Phase 1)[2m > [22mServer B should route message to Client connected to Server A [33m 764[2mms[22m[39m
[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match RegExp route and extract named groups
[22m[39m{"id":"wa7qf9laedo4fsgseb53l1el","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787212962,"meta":{"identity":"CP-REGEXP","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match RegExp route and extract named groups
[22m[39m{"id":"pb0d4pecfmky0zbch7mzswbo","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787212964,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match RegExp route and extract named groups
[22m[39m{"id":"d916nxvqnvecg6gy89k4wdmb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787213009,"meta":{"identity":"CP-REGEXP"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould reject connection if no route matches
[22m[39m{"id":"ch25v6rrbkmd1rqs8dqtrzpm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787213017,"meta":{"port":50913,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould reject connection if no route matches
[22m[39m{"id":"y75c9rj34f652z9tna6h2h18","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787213186,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match first registered route if multiple match (order matters)
[22m[39m{"id":"l7i82sapi8ifm9udpk0m7pvn","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787213231,"meta":{"port":50915,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/browser-queue.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 53[2mms[22m[39m
[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match first registered route if multiple match (order matters)
[22m[39m{"id":"diewf9w23ct64wydwz8gi8su","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787213304,"meta":{"identity":"CP-MULTI","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match first registered route if multiple match (order matters)
[22m[39m{"id":"x5enq2fk336eoiubz5aba007","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787213308,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match first registered route if multiple match (order matters)
[22m[39m{"id":"z57khcuhiqm2f9valkgwcwfc","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787213310,"meta":{"identity":"CP-MULTI"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould reject connection if no route matches (strict mode)
[22m[39m{"id":"sut23lijf370ucytwwicirtx","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787213315,"meta":{"port":50917,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould reject connection if no route matches (strict mode)
[22m[39m{"id":"i49q5eg1lsdgdsl1tp9hjse3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787213355,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match Express-style wildcard routes securely
[22m[39m{"id":"kxdamqah2k1q83unyajnnu3a","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787213367,"meta":{"port":50919,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match Express-style wildcard routes securely
[22m[39m{"id":"bz8x7kasxiu3g6vvq0ga2hla","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787213388,"meta":{"identity":"CP-123","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match Express-style wildcard routes securely
[22m[39m{"id":"x4c8vrs791mc5ybluawagdve","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787213391,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match Express-style wildcard routes securely
[22m[39m{"id":"pz4d5hycaue8g18t4eujylii","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787213393,"meta":{"identity":"CP-123"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould override timeout and ping configurations per router
[22m[39m{"id":"qcbe3vjqz335z9fmzsyjmdvl","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787213398,"meta":{"port":50921,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould override timeout and ping configurations per router
[22m[39m{"id":"i32owg97k3c651d6spyidxng","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787213463,"meta":{"identity":"CP-CUSTOM","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould override timeout and ping configurations per router
[22m[39m{"id":"ojta4646dxfg7ku1fjn8gjt4","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787213486,"meta":{"identity":"CP-DEFAULT","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould override timeout and ping configurations per router
[22m[39m{"id":"bs9msdkzi45cxv14272mbrgp","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787213487,"meta":{"code":1005,"reason":""},"context":{"component":"OCPPClient","identity":"CP-CUSTOM"}}
{"id":"ldsjc2dg2k089n1x5m975gi8","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787213487,"meta":{"identity":"CP-CUSTOM"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould override timeout and ping configurations per router
[22m[39m{"id":"ksvixa7j6zd9cjrw0400cyks","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787213489,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould override timeout and ping configurations per router
[22m[39m{"id":"lfmpdwyuqi6wak33v4sm92xc","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787213491,"meta":{"identity":"CP-DEFAULT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould enforce allowed subprotocols per router
[22m[39m{"id":"ib2lhihyo1ayotng79tgdrjz","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771787213550,"meta":{"port":50924,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould enforce allowed subprotocols per router
[22m[39m{"id":"w47o9vmfq4f5b0gp2xwam7db","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771787213557,"meta":{"identity":"CP-16","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould enforce allowed subprotocols per router
[22m[39m{"id":"d9tyk94rcq9krlelywvuwdzu","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771787213564,"meta":{"code":1005,"reason":""},"context":{"component":"OCPPClient","identity":"CP-16"}}
{"id":"spcriqm2jmgjf413cqrwsc9d","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771787213565,"meta":{"identity":"CP-16"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould enforce allowed subprotocols per router
[22m[39m{"id":"w00bbecjlu3r3kbhkz0z2zli","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771787213632,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/routing.test.ts [2m([22m[2m9 tests[22m[2m)[22m[33m 1263[2mms[22m[39m
   [33m[2mâœ“[22m[39m OCPPServer - Express-like Routing[2m > [22mshould match default fallback route (legacy behavior) [33m 350[2mms[22m[39m
 [32mâœ“[39m test/server-coverage.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 208[2mms[22m[39m
 [32mâœ“[39m test/queue.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 55[2mms[22m[39m
 [32mâœ“[39m test/browser-errors.test.ts [2m([22m[2m66 tests[22m[2m)[22m[32m 19[2mms[22m[39m
 [32mâœ“[39m test/combine-auth.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 18[2mms[22m[39m
 [32mâœ“[39m test/client-coverage.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 21[2mms[22m[39m
 [32mâœ“[39m test/browser-util.test.ts [2m([22m[2m28 tests[22m[2m)[22m[32m 19[2mms[22m[39m
 [32mâœ“[39m test/redis-helpers.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 28[2mms[22m[39m
 [32mâœ“[39m test/browser-emitter.test.ts [2m([22m[2m22 tests[22m[2m)[22m[32m 14[2mms[22m[39m
 [32mâœ“[39m test/redis-adapter.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 21[2mms[22m[39m
 [32mâœ“[39m test/errors.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mâœ“[39m test/logging.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 16[2mms[22m[39m
 [32mâœ“[39m test/util.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 20[2mms[22m[39m
 [32mâœ“[39m test/middleware.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 19[2mms[22m[39m
 [32mâœ“[39m test/generate-types.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 91[2mms[22m[39m
 [32mâœ“[39m test/init-logger.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 14[2mms[22m[39m
 [32mâœ“[39m test/safeSendToClient.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 20[2mms[22m[39m
 [32mâœ“[39m test/ws-util.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 11[2mms[22m[39m
 [32mâœ“[39m test/adapter.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m test/event-buffer.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 8[2mms[22m[39m
 [32mâœ“[39m test/safecall.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 9[2mms[22m[39m
 [32mâœ“[39m test/redis-driver.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m test/cors.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 14[2mms[22m[39m
 [32mâœ“[39m test/client-duplicate.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m test/parse-basic-auth.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m test/index.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 4[2mms[22m[39m

[2m Test Files [22m [1m[32m40 passed[39m[22m[90m (40)[39m
[2m      Tests [22m [1m[32m539 passed[39m[22m[90m (539)[39m
[2m   Start at [22m 00:36:44
[2m   Duration [22m 19.02s[2m (transform 12.57s, setup 0ms, collect 25.90s, tests 27.38s, environment 12ms, prepare 12.90s)[22m

