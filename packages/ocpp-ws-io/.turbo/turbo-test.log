
> ocpp-ws-io@2.1.1 test
> vitest run


[1m[46m RUN [49m[22m [36mv3.2.4 [39m[90mD:/projects/ocpp-ws-io/packages/ocpp-ws-io[39m

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould start listening on a port
[22m[39m{"id":"hj2poythue9tu693fmuj6xqh","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461430,"meta":{"port":53207,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould start listening on a port
[22m[39m{"id":"uhv4cjkx7adcyuug1mmqwems","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461433,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"srzu8smjvr2omvtn5rdowj1g","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461435,"meta":{"port":53209,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"ni678ao1j4m874fuvc3075ro","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461439,"meta":{"port":53210,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"pwosf13ghji7lqmzuffwhf82","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461438,"meta":{"port":53208,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff

[22m[39m{"id":"usasndbo0otr6265mn94dcnl","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771788461548,"meta":{"attempt":1,"delayMs":252},"context":{"component":"OCPPClient","identity":"CS_STATE"}}
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"q7kqbx72lmbu18dxgvyvuler","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461443,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"vwsp4b2rlsl31sbwqhiybkbr","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461449,"meta":{"port":53211,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"u572brlk0r3d16duv3umfvls","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461450,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"eclgnpzotcgj8a0pyjrydk8z","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461454,"meta":{"port":53212,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"rvp1u024cadjv7qrbmgj91w2","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461502,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m_startPing called [33m30000[39m
{"id":"mkborh2s00g513d87di94and","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461504,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"trxd17max3m3r12a5pdg093d","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461509,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections without auth callback set
[22m[39m{"id":"wb0hghdx97tgb69rzkp4hshn","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461511,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"fev9xjlcc4tnnr1kez6mukns","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461514,"meta":{"port":53215,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"kd8jsbtsaiy9jtkg7el8a9x5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461536,"meta":{"identity":"CS_STATE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m_startPing called [33m30000[39m
{"id":"dxdracjdk55f7s4ljibcfv44","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461539,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_STATE"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"sx3s4qy1onr8tjd7icdcdydc","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461541,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"it7f58wwcpto0t3ukk1msfdn","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461542,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m_startPing called [33m30000[39m
{"id":"ynoiwdxwy5zwed87yg6rj3es","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461545,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}
[90mstderr[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections via auth callback
[22m[39m{"id":"hr1mjxgb9iwxcdoqgkb03o00","level":40,"levelName":"WARN","message":"Auth rejected","timestamp":1771788461745,"meta":{"identity":"CS_REJECTED","code":401},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully

[22m[39m{"id":"ped7bh89ewpzw9o8iq9to6xq","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461548,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[90mstderr[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections via auth callback
[22m[39m{"id":"o2hxdycfl2ap6bqqp1g09kvf","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461547,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_STATE"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"wdk04t1f7n68hskar0aovzvc","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461550,"meta":{"identity":"CS_STATE"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"zrojrc5i0fofdpfwnoqeu09j","level":50,"levelName":"ERROR","message":"Unexpected HTTP response","timestamp":1771788461747,"meta":{"statusCode":401},"context":{"component":"OCPPClient","identity":"CS_REJECTED"}}

[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"j4qqssj6ccq0oo41mgsqh7u7","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771788461801,"meta":{"attempt":1,"delayMs":440},"context":{"component":"BrowserOCPPClient","identity":"BR_STATE"}}
[22m[39m_startPing called [33m30000[39m
{"id":"d10er1d31wo6zu0as6bx7qjt","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461551,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}


[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"zn69i8gdkfpaayd5wm43gv97","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461554,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould connect successfully
[22m[39m{"id":"nwya3sawufgxpt3o72hxvft8","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771788461790,"meta":{"attempt":1,"delayMs":485},"context":{"component":"OCPPClient","identity":"CS_NO_DOUBLE"}}
[22m[39m{"id":"n6h5mkqsm70z9om6ztswmqip","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461555,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"d5pi1pqbem3d2g7xlnl8vd45","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771788462029,"meta":{"attempt":1,"delayMs":477},"context":{"component":"BrowserOCPPClient","identity":"BR_NO_DBL"}}

[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"cfik70vc8cuj668wbk906q5e","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461558,"meta":{"port":53219,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"xwd9pynconz4z8bwd8bgv19b","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461564,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"i0jvn1o7jrsocp9ird9w4qws","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771788462029,"meta":{"attempt":1,"delayMs":309},"context":{"component":"OCPPClient","identity":"CS_EVT"}}
[22m[39m_startPing called [33m30000[39m

{"id":"h6zu09g5a0at5amt5uzy3vbl","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461566,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"ckjafu4dwuaxjwd6s23vdd1m","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461567,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"iwibt1uvvltrebcxusvhp2vy","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461568,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"zj7jmlcb5mxvhintjahukl8j","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461572,"meta":{"port":53222,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"qioqsl86u287e71fpreria9t","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461576,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m_startPing called [33m30000[39m
{"id":"yj6v4aq43rfxmn0wsia1fo45","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461579,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"d0v7zemvzjmm45mti3ae6qzs","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461581,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"ao23c8mr5w2cx5uo6h48qzds","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461582,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould use default voltlog-io logger when no logging config is set
[22m[39m_startPing called [33m30000[39m
{"id":"ngytwape4gfx2zi3vrbdcf4e","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461583,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_LOG_DEFAULT"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"jcg3d22iiucbl52ir7omtxwq","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461585,"meta":{"port":53224,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"oeiaf13pld67enjgtz3oloq9","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461599,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m_startPing called [33m30000[39m
{"id":"kqraxn2olxumibim8tr7n5hv","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461600,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"n2xzpu75hp6ca5c8tzorso8d","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461605,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould close gracefully
[22m[39m{"id":"y4p1182z97of8gcy9za40s74","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461606,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"gcionrthf5xi407jtf6eibfm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461611,"meta":{"port":53228,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould not log when logging is disabled
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"joiarp6azgvs9ylox5y1cfbz","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461615,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m_startPing called [33m30000[39m
{"id":"vins4y8oe4m9ghv4bcwkrunz","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461618,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"w15tbgcoihz2rlg9cej2dm49","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461631,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle RPC call and response
[22m[39m{"id":"h4s107tw5fkqp2mnxf99q659","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461632,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"ljl698m1iip7mo2clo8t2jbz","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461635,"meta":{"port":53232,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"z1o1wkzrft7z1yc3dacnk8a8","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461639,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m_startPing called [33m30000[39m
{"id":"lwfp7ukj8ryt1abrejoowlj2","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461640,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould use custom handler when provided
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"dkfcxt7xenq0zxbx1gyzywu8","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461655,"meta":{"port":53235,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"q7ujny2oeb36qa0hevgbsfqt","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461662,"meta":{"port":53236,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"lp52dw5ol9liqxqfdps39v9r","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461664,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive NotImplemented for unhandled calls
[22m[39m{"id":"hgt4yw76qxlu9cfsdhdzs1yp","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461665,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould throw if identity is missing
[22m[39m{"id":"ct1nac77wylhyrigmy763j3g","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461666,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"bl0qipa5ajosrsx9jya362z9","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461669,"meta":{"port":53238,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"hjb8fkfsk2v7wg5104s3qv5y","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461671,"meta":{"port":53239,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould be in CLOSED state initially
[22m[39m{"id":"w9ti7r67tkufij8kunq535q2","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461673,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould expose static connection state constants
[22m[39m{"id":"h4rt3c0da2gj931uz341o47o","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461678,"meta":{"port":53240,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"qvj1ky5y3rz5p1pvkxo3f1q6","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461673,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"xwd94lq3rn8d1d615lhqs9t1","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461679,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould expose static connection state constants
[22m[39m{"id":"xf25eklsoteq7khzdbpps2cr","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461680,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould expose connected clients
[22m[39m{"id":"n27tl99c2vf65pa202zi2aij","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461680,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould set identity correctly
[22m[39m{"id":"yh27227219ynb6k0u5e626vy","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461683,"meta":{"port":53241,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConstruction[2m > [22m[2mshould set identity correctly
[22m[39m{"id":"avvcu7omkke7a96imi8xsj1q","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461684,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould provide a default logger when not specified
[22m[39m{"id":"ro30af6trv0j13falo4afqra","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461688,"meta":{"port":53242,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould provide a default logger when not specified
[22m[39m{"id":"xa5574wbd0ro7l16o4336qxh","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461689,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"zkdatt5rirvqt5oeczjkuqac","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461690,"meta":{"port":53244,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"npq7nn8os45t5vj7p9nky0f9","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461696,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m_startPing called [33m30000[39m
{"id":"f3b60zqe59rbju43c31gryjk","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461697,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"vob0jwcddyqh7hv6bvm9rq7n","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461700,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould support abort signal on calls
[22m[39m{"id":"tacr89o5mo1or2vibudyp2ra","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461701,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"d6zehmt3pgcciqfew56q0y50","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461704,"meta":{"port":53247,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould provide a safe NOOP logger when logging is false
[22m[39m{"id":"wvo9v4zs5hzgk0tq48eq2i3d","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461705,"meta":{"port":53246,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould provide a safe NOOP logger when logging is false
[22m[39m{"id":"zs9o7thmas6ibzwimcy7q7pv","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461711,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"s9oz59gjoegr7sl0xqg7pr2m","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461718,"meta":{"identity":"CS_EMIT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"e5u6i8mlmsplsxe0gy2hf2a5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461721,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould log CALL sent and received
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould use a custom logger instance and attempt to bind context via child()
[22m[39m{"id":"drssi95lmx2xuit9idr2mydi","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461723,"meta":{"port":53250,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m_startPing called [33m30000[39m
{"id":"pe6i2rwv0n9t8g2q5yqd4dyc","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461724,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould use a custom logger instance and attempt to bind context via child()
[22m[39m{"id":"f55l6nzamihuj0kbxnnloaly","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461728,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"nt0pipq6kvbxixh7ab4ml2b1","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461730,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"u35koqqwlohgsjt75goei2yw","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461730,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould receive calls from server
[22m[39m{"id":"pp5uuamu5d8zw6s5lez0er1q","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461731,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould apply a custom handler transport correctly
[22m[39m{"id":"wmf01y5wos5q4ige9lm6zso0","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461731,"meta":{"port":53251,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould apply a custom handler transport correctly
[22m[39m{"id":"cqnkvpxbvbd3f82vgju0av32","level":30,"levelName":"INFO","message":"Test browser handler message","timestamp":1771788461732,"meta":{},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"aq3fb2g0lam0cxz1gc6kreok","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461733,"meta":{"port":53252,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m_startPing called [33m30000[39m
{"id":"e6nqar9tpshuaz4jkrbtyvun","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461736,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_EMIT"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"n9x7uy1ktl6nhvnsy1k2g6x9","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461738,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould emit "client" event when a station connects
[22m[39m{"id":"u8rdskxztk1tqa00h5f8yd3f","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461738,"meta":{"identity":"CS_EMIT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections via auth callback
[22m[39m{"id":"uvlohdwlxl1y19h3t7sa3spn","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461741,"meta":{"port":53254,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould reject connections via auth callback
[22m[39m{"id":"my2hhse8n56047fkm6hywh38","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461749,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould log incoming CALL and handler errors
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"iqmrjh7ax0qqceedgyifcr65","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461762,"meta":{"identity":"CS002","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mLogging[2m > [22m[2mshould apply a custom handler transport correctly
[22m[39m{"id":"qj7wofjhsjc7461x6ul4z046","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461769,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"x3kusfa9xompllq5ehfewtlm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461772,"meta":{"port":53261,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"ascxft562qlvacoez7h0uuq4","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461772,"meta":{"port":53260,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould log CALLERROR received
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m_startPing called [33m30000[39m
{"id":"j4wo3hwnhwkeyhpoiwu684nf","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461776,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS002"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"jlooh06sh2zu873n8geao5za","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461780,"meta":{"identity":"MY-STATION-123","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"ozdypjxkmclbgccl5778s8hw","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461780,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS002"}}
{"id":"vmvcultunr258ymyb4he2jck","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461780,"meta":{"identity":"CS002"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"lcjh8sk3w3ym3f6bq7hlhipj","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461781,"meta":{"port":53263,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m_startPing called [33m30000[39m
{"id":"o33ulgju304mtoc14khvitxj","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461782,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"MY-STATION-123"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould handle wildcard handlers
[22m[39m{"id":"t9fjv93wy6m6eeoi8g30hhu3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461783,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"ybbbh903mxbaach3bjetd7nx","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461785,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"um43cj4em2gmywadewywhfn7","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461786,"meta":{"identity":"CS_NO_DOUBLE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould parse identity from URL path
[22m[39m{"id":"hab8y0nqhmkmzn0agpyyyi8c","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461786,"meta":{"identity":"MY-STATION-123"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m_startPing called [33m30000[39m
{"id":"awe0xupyki8xjq9g7jzf9cnv","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461787,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_NO_DOUBLE"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"vs051nqvlexgis84irohgubn","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461788,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"b73doczy0fnqz5a2ieg4x5fh","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461791,"meta":{"identity":"BR_STATE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"otpov5p408rkc4070epgjlil","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461790,"meta":{"port":53266,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"u4prhxdawgl43lit0i6kg4mx","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461794,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_STATE"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"r5i4rdar4fsgzy9vjxn6krqr","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461795,"meta":{"port":53267,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"g253q1d8i7jkj1y9kwjqxg3k","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461796,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"p085r2ehqk45k5ldzsw5hu1j","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461797,"meta":{"identity":"CS_DISC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m_startPing called [33m30000[39m
{"id":"j13yy39wg1yg8jjknkq5rhq2","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461798,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_DISC"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"cxsr9d0l2j9ldndyirj89d0l","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461800,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_STATE"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould stay in CONNECTING state during reconnect backoff
[22m[39m{"id":"ba7jretj2i8bafd2tghmz65g","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461803,"meta":{"identity":"BR_STATE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"cl9pary1diigpgh0c7v03ln4","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461790,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_NO_DOUBLE"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Reconnect State Transitions[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"sj2kyw92eryo0e00g0u9z80g","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461807,"meta":{"identity":"CS_NO_DOUBLE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"prrut663fdv2wj1rod9u2efg","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461812,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m_startPing called [33m30000[39m
{"id":"u6ttktia1n367e0udbpepoxh","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461815,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"rroprexhi3do3flq4ykbl039","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461818,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"e4c82sxw6tnu8e44guy56o7o","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461818,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient[2m > [22m[2mshould remove specific handlers
[22m[39m{"id":"sqi0zgq0wzsilpo7h8a789jx","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461819,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould log disconnect
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"pn9z7psz8959fbe922hphxnp","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461822,"meta":{"port":53272,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"kjtlwwnzcsb7h98wibp90q5x","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461825,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m_startPing called [33m30000[39m
{"id":"yvjrmsiqb5wp2so62i0363ng","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461827,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"euhb0j51q595n5v2hi3sxvvs","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461850,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"b1faevk2p6he0mgsdqy7o3m2","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461853,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"fvfdjfuj5nk44yz02sus8do3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461859,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould connect successfully
[22m[39m{"id":"hsll14pge3uadt2vlc44ycwb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461860,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"mxg89l0fnji4bsr0cv23nv8x","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461863,"meta":{"port":53275,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"guj6fpbjz1xu3epmkfi6559n","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461869,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"a7ukwty8v8hywjp1ny0abop4","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461872,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"rfmchntjv8kfjo71bjqnvc8g","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461878,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould set protocol after connection
[22m[39m{"id":"odpa213pl5pjasc6yc2mnc5p","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461879,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"tylamrmei3xsxge78muh4vin","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461883,"meta":{"port":53277,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"odoekoy04ybnlhmynlcf31i1","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461888,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"wffh271lth34zvin1ql3dcin","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461889,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"rjza9x1lyglhhcpvponvj29n","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461892,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "open" event on connect
[22m[39m{"id":"s10tjoi69gjtlubdfbxlzyi1","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461894,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"rhri7wlaw6ds3jbsk19qcwud","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461898,"meta":{"port":53279,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"rsyzrhnjbsluac9rtc80hsyl","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461907,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"v6nklvqbqhgr07jd4v0h5pbs","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461909,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"nvnj331i61lp1faa2byolr1l","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461913,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_DISC"}}
{"id":"w05xz7f59it5b8wxhpbxlw5g","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461913,"meta":{"identity":"CS_DISC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"ig0sonpvhx87l4jrdg0gev49","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461913,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould emit "connecting" event before WebSocket opens
[22m[39m{"id":"a2zvewdzm8kljlrghwv4sgpl","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461915,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"qj4js851s1jeus8pj93imgge","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461923,"meta":{"port":53281,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"liwsqa1wumkq6ad32ea1h6x0","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461937,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"opq0m48jwoe4dpveksk6szpy","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461938,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Security Profiles[2m > [22m[2mshould include Basic Auth header for Profile 1
[22m[39m{"id":"gniu5wxyam5355zvmdqffq3l","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461938,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"o7544sekhxgf3q47wnxab1r3","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461941,"meta":{"port":53282,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"r9qoonvt78tsmf2hi8p96pb6","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461947,"meta":{"identity":"CS_VERSIONED","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m_startPing called [33m30000[39m
{"id":"zf6ulytaqapgk2gccmvj0cmn","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461948,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VERSIONED"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"hor52vzve0f6w1gva7662j65","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461952,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_VERSIONED"}}
{"id":"gtkrpouha9sdjdntg5pnwh0u","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461952,"meta":{"identity":"CS_VERSIONED"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould support version-specific handler with typed params
[22m[39m{"id":"o8swn05jkski6y73hsetw9x7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461953,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"v4tqkktpyxfcyn920um3c6v1","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461955,"meta":{"port":53285,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"cnb4o1yc6wljl6u3to1ouivj","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461956,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"l2im4cb1mpxlg5okcqubuzt6","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461957,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"q6ugzpqbe98zxnwepe8vlbfn","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461958,"meta":{"identity":"CS_CTX","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m_startPing called [33m30000[39m
{"id":"t5y9j3nxcikxm1tez9h5ucta","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461962,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_CTX"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"f2gdmi43d0pl53rfakny6e8j","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461963,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_CTX"}}
{"id":"rt46r3yndo6z4ro3ag3xkkfu","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461964,"meta":{"identity":"CS_CTX"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould expose protocol in HandlerContext for generic handlers
[22m[39m{"id":"m00ps06jinf6uqqf4dlr1cup","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461964,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"j3mee9ct6c8v7eykjah6h8o0","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461967,"meta":{"port":53287,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"aijnez2id3ttbhqwsi4w2jtq","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461965,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould reject connect when already connected
[22m[39m{"id":"c58tctt9b4ctay9n2vm7if0h","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461970,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"dmqwpi1z7zzxkdxbbgz95k55","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461970,"meta":{"identity":"CS_PRIORITY","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"q0hqtw9g066ar4fi5ifoc7o5","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461972,"meta":{"port":53289,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m_startPing called [33m30000[39m
{"id":"ut1ot0py33b6s4agbxch5ewi","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461977,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PRIORITY"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"z9v65xc2p40o28vtly9cvdt7","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461981,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_PRIORITY"}}
{"id":"z36cz6exr8yzn639wle21je9","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461981,"meta":{"identity":"CS_PRIORITY"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"u2n2fxkv8vk6d8561bo9elg7","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461981,"meta":{"identity":"CS/001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould prioritize version-specific handler over generic handler
[22m[39m{"id":"ibkdxuwwz61y6gkknutynqqj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461982,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"xjowuhlw7hmusczpili5zq2d","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461982,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS/001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"ympv7xgae1qn27mkgjyzm9zm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461985,"meta":{"port":53291,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"umweqevcynlubmv2zj1v2tze","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461985,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould build endpoint with identity appended
[22m[39m{"id":"i9fg5zkxc7kk376827il7a6c","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461985,"meta":{"identity":"CS/001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"z6uapuskgckdnrafefbvsi1v","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788461987,"meta":{"port":53292,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"nf6cyh5apyklp4dzuiq2bahi","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461989,"meta":{"identity":"CS_FALLBACK","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m_startPing called [33m30000[39m
{"id":"y5qdmdjb2qm8u4rl36724cyt","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788461992,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_FALLBACK"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"w7dzndkc32oc43rcwrih1tew","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788461997,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_FALLBACK"}}
{"id":"evq1u180uweuf3w4ryr3r94s","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788461997,"meta":{"identity":"CS_FALLBACK"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"gqb7xo7ieq7ick0756qjsxew","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788461999,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould fall back to generic handler when version-specific is removed
[22m[39m{"id":"fe0foocok7xo25aztnb33vrp","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788461998,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"nw0qs7d43n0gyiaek1mjvsvs","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462000,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"ap1wm8tluk8s202x9tuocq6b","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462002,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mConnection[2m > [22m[2mshould append query params to endpoint
[22m[39m{"id":"qc9cevad5bkvqrygsma0x56y","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462002,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"l60xfa08z08euk2exc96m30m","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462004,"meta":{"port":53295,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"qaa1wys1l6qx3jlhi4zgy150","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462005,"meta":{"port":53296,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"z7gqrdqq066vmyz527i8ru3u","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462008,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"y6btmsu2x1n0v9jqf5wklhsf","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462009,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"b00zjwiu5n075dmuspjunu00","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462013,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close gracefully
[22m[39m{"id":"yai5lqwt5rsc2tqp0t0coica","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462014,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"qtcq214cvmx2lkglgcjhroko","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462016,"meta":{"port":53298,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"u6c9bkxmm2zor5y9m04v4u9a","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462020,"meta":{"port":53299,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"cp7kts7pijna2ll0f9kdqhls","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462020,"meta":{"port":53301,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"scm97d4enbhp9pialkgn7xt1","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462020,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"zv6zbnjnmw039vuhvsz87lg5","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462021,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"hg7vadb2j6icucayhan3n58v","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462023,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[22m[39m{"id":"tyzh3dkwa6nsvuabhn2tieu3","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788462202,"meta":{"error":"Unexpected token 'o', \"not-valid-ocpp\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"CS_RAW"}}
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould emit close event
[22m[39m{"id":"z23flfw77wy16taq7j7b80zs","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462024,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"pxue79bxpn5gumarj40ijx7x","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462025,"meta":{"identity":"BR_NO_DBL","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"d19h0gqw4g97imhhwsvh0d39","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462025,"meta":{"identity":"CS_EVT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)

[22m[39m{"id":"qinfqkt52a83vho3659eqjkb","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462026,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_NO_DBL"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m_startPing called [33m30000[39m
{"id":"nwjgfxstjo3ml8tyd6fms3tw","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462027,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_EVT"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould return immediately when already closed
[22m[39m{"id":"c2sq7q97fkn87elwtqwr68f1","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462026,"meta":{"port":53304,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"jnmao1x59wgzqx5ngonu2lns","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462027,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"xlkaznuh999s1hiigfrgjcnj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462027,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould return immediately when already closed
[22m[39m{"id":"yew490dtzgzpv9uuh6pdkra8","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462028,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"brrym6f0nc5qrfsvkyhq1h26","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462028,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_NO_DBL"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"cdwm9fgqbrkwlidflzyfh54p","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462029,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_EVT"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Reconnect State[2m > [22m[2mshould not allow connect() during CONNECTING (reconnect in progress)
[22m[39m{"id":"xrqlnjw7ainppj1oe7wvo9iy","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462030,"meta":{"identity":"BR_NO_DBL"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould log reconnection attempts
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"zzvsahzn02pdvupto3j6v6f2","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462040,"meta":{"identity":"CS_WILDCARD","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"blwski4gry5bhtnpe3ps94i3","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462044,"meta":{"port":53309,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection when reconnect is enabled
[22m[39m{"id":"twjcm9c28r5g1ubscs1kfcgu","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462030,"meta":{"identity":"CS_EVT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould remove client on disconnect
[22m[39m{"id":"hweqt56s718i4gmn6vjkx9dr","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462039,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m_startPing called [33m30000[39m
{"id":"c3c2v5nbbhvlul02gz8v44bd","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462042,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_WILDCARD"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"ge038de6fh20r6c7kkdcyoth","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462053,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"zaojbf65mkpzsy8ggkajqiu3","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462042,"meta":{"port":53308,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"xa9a140w950xi0qx4nquqcgw","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462044,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_WILDCARD"}}
{"id":"fhqu7eeadfqxso0jkuvpje6o","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462044,"meta":{"identity":"CS_WILDCARD"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"m52rmg8p3r53vg3vfbe301c1","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462053,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"tl1uff81rh3yrkikf9ppgtv3","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462054,"meta":{"identity":"CS_CLOSE_ALL","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mVersion-Aware Handle[2m > [22m[2mshould handle wildcard for unknown methods
[22m[39m{"id":"evy7364a2gt6cye0hatq4by8","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462045,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"po5bi81445nie76qvxubkfek","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462055,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m_startPing called [33m30000[39m
{"id":"ucm6oy5uculrz14j1x5o16ce","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462056,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_CLOSE_ALL"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"v0se3yx9qe3a47qj3e148mzv","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462057,"meta":{"port":53312,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould handle double close gracefully
[22m[39m{"id":"qp1b9lbwqbffefn75vwnf54b","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462056,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"txi6jxad59k2e1r9x3xr86vv","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462066,"meta":{"identity":"CS_RMALL","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"iobmpeikx1qewhyrehu1317s","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462059,"meta":{"port":53313,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m_startPing called [33m30000[39m
{"id":"rr833svmcjul9siavgj4m4ko","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462069,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RMALL"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"s340dctxc6kpfm88587znlns","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462067,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"mawnq0rgpsy8sfeycboes9fu","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462076,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_RMALL"}}
{"id":"ygu2y2z6ia7nyneu93lux14w","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462077,"meta":{"identity":"CS_RMALL"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"z8dmuawe4l4up2sfkcps0kk1","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462068,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould remove all handlers with removeAllHandlers
[22m[39m{"id":"nlwf7hjalb7a03828w5ai5tj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462080,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"in6dp5fulefvb7bs72605p7b","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462069,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"qe29ranyecbw15d8izdik3hg","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462083,"meta":{"port":53319,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with force option
[22m[39m{"id":"pcbu4p0j83r23shyosy6vx12","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462070,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"yld5affktnesr8qfot73o0e8","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462086,"meta":{"identity":"CS_RAW","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m_startPing called [33m30000[39m
{"id":"t3e199vona4smdersjozstmf","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462087,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RAW"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"kv3m0x6s9bfe9tamw7j20l7g","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462073,"meta":{"port":53316,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"hyyb20juxpicv9g223xc7hks","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462076,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"ljj7j8zvcge3xcznd8f9mv9z","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462077,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"w1xtd17xldwrxyep7xnyqmki","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462078,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mClose[2m > [22m[2mshould close with custom code and reason
[22m[39m{"id":"ewsqhs73e13rfojgr0e1hn9z","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462079,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"rhpofzxnnfcsb512dghczw6t","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462081,"meta":{"port":53318,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"j103j8ej9exiog50yt90b74i","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462085,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"j18w5rb2kvknodrv6dns0o0m","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462086,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"mz41qfzecmoycj1e4h7himo0","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462093,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould send a call and receive a response
[22m[39m{"id":"kccp2i3kaaws4d63yc014gky","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462094,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"kiss466km8phjkpkesk1yt1s","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462096,"meta":{"port":53322,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"ygyggnw34v0tqfly232tfj5i","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462103,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"q6qitv1k328givkc3xh4fbfb","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462104,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"j3cb466tg3wy6suv7leaztvi","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462108,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould receive call error from server
[22m[39m{"id":"qmhcr7ytps6wee30s44ixgtt","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462109,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould reject calls when not connected
[22m[39m{"id":"mv6g3sjkqsc9jvq9l6w9s7ra","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462111,"meta":{"port":53324,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould reject calls when not connected
[22m[39m{"id":"djum96yxvpghdw5i8htdh1mv","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462112,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"d5v4sn0yke591w7un2s5mgdk","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462115,"meta":{"port":53325,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"ehebszf3rn9ngk4mykdm8owg","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462121,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"q71u9x0at9gdtkpiqg95kb5t","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462122,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"swx2585aprqvqlcdxgyw7mpp","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462169,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"h5ougai2upmwyrb9leq6iwlm","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462170,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_CLOSE_ALL"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer[2m > [22m[2mshould close all clients on server close
[22m[39m{"id":"r3bhrarfnht0d3q8aiwopiz4","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462171,"meta":{"identity":"CS_CLOSE_ALL"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"ryb8fk1oaz362uirjx4snhqm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462174,"meta":{"port":53329,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"jkxgowxz47z2omxdxs9tz9ih","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462178,"meta":{"identity":"CS_INHERIT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m_startPing called [33m30000[39m
{"id":"fe7y4ww4shpnk5mesd4p2o8a","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462179,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_INHERIT"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"nj90r243abbr28p5qgm2swxv","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771788462259,"meta":{"attempt":1,"delayMs":255},"context":{"component":"BrowserOCPPClient","identity":"BR_EVT"}}
[22m[39m{"id":"emwedv0lugj0rrlnofo0wsgl","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462180,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould inherit options from server
[22m[39m{"id":"nif08quu6f6ua6f2i8f0ozui","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462181,"meta":{"identity":"CS_INHERIT"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"a68vmcszu37lxhmak22h457p","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462184,"meta":{"port":53331,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"iz8x7iyp5omu8jthzxf39yn8","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462189,"meta":{"identity":"CS_NO_CONNECT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m_startPing called [33m30000[39m
{"id":"dz4zl04fle6a3pu4z23x7oaf","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462190,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_NO_CONNECT"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"ggsy3r4hsnm1kew21d4d8vxh","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462192,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould reject connect() call
[22m[39m{"id":"o2rym91a99a36qpdkqcbwvl9","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462193,"meta":{"identity":"CS_NO_CONNECT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"kz877sl2pfphlawizpgskt9c","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462195,"meta":{"port":53333,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"rpmiyxywidy7r3tay9libjkq","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462199,"meta":{"identity":"CS_SESSION","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m_startPing called [33m30000[39m
{"id":"nfzjbxn8921rot37sqi23f7g","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462202,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_SESSION"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"lsc5qpdcpbmi18wex56sfkxr","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462204,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServerClient[2m > [22m[2mshould expose session data
[22m[39m{"id":"skjh7jefnsod596r1e32rwux","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462205,"meta":{"identity":"CS_SESSION"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould expose handleUpgrade getter for external HTTP servers
[22m[39m{"id":"du42qctas7i23s64b1yfehgw","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462207,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"h4mnzv09yec7sbx5nglnb8w5","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462209,"meta":{"port":53335,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"dhp0j7oon9hyzgz3k3w4wha8","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462214,"meta":{"identity":"CS_EXT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m_startPing called [33m30000[39m
{"id":"bj2t11vrs970hwuii1t6t6jv","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462215,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_EXT"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"vzdmsugnugzap4b9pmnjr91l","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462216,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould allow handleUpgrade to be called from an external server
[22m[39m{"id":"imlipl7i78p5zag422zdr3u9","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462218,"meta":{"identity":"CS_EXT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould reconfigure server options at runtime
[22m[39m{"id":"qlkj8hv6djg3ka15feq5nn7j","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462220,"meta":{"port":53338,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould reconfigure server options at runtime
[22m[39m{"id":"t1nrpuyk7tdsneu4g31btsv4","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462222,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould set and use a custom adapter
[22m[39m{"id":"di9mkmi272ry45rlhbstpysc","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462227,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould no-op publish when no adapter is set
[22m[39m{"id":"pbb5jaypnzeqjeyf2rspnh6d","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462229,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould close server via abort signal
[22m[39m{"id":"ty3uwjlwew2dxx2nvhoaknw6","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462232,"meta":{"port":53339,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"p0x8v2fz1ieh8l2qznhu3fly","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462245,"meta":{"port":53340,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"m7wvvzqu5jksiozr3isf8s8q","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462247,"meta":{"port":53341,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"jkj3z6942pfz0yl3i9b3e0wo","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462251,"meta":{"identity":"CS_NO_RECON","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"e4wbqpjsiwvg62ingoc16rhr","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462252,"meta":{"identity":"BR_EVT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m_startPing called [33m30000[39m
{"id":"nvfdv3vjjjnz0z77lp9fsozu","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462252,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_NO_RECON"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"fj14857wmqg971mxd2u0beim","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462252,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"adih5ywj6ydj8hvvj0qjfn1j","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462254,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_EVT"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"n0sysnv9kxrhg3bv8drgsqnf","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462254,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_NO_RECON"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"rdsxmmwcgb58pbpdek86jdzw","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462254,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"vnsriv1gqqs1t5saykek2qei","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462255,"meta":{"identity":"CS_NO_RECON"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"ljmofmykj8row2i8gg3mm7fc","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462256,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_EVT"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'disconnect' (not 'close') on transient disconnection
[22m[39m{"id":"m0q3a9b3d6n7lzwqk8ukcdl2","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462260,"meta":{"identity":"BR_EVT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - handleUpgrade, reconfigure, adapter, signal[2m > [22m[2mshould close server via abort signal
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"y3hlwzbhnuszez6fvee6gph1","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462337,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"atch719ksvu0hasz5tq7p4ii","level":40,"levelName":"WARN","message":"Call timed out","timestamp":1771788462337,"meta":{"messageId":"d71ylie3sn8gnhqjz7yxmnla","method":"SlowMethod","timeoutMs":200},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}


[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"uj6wsol5ugz5p10q06wviw3z","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462340,"meta":{"port":53344,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"e6glqiqdj33t8c1umm2i77wy","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462339,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould timeout calls that take too long
[22m[39m{"id":"zy5ccwfzqhoz4xivi77cq3xf","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462340,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"m2lmmut3of9mhva5y7rdevqj","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462342,"meta":{"port":53347,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"s458am88n1ljrdjchkwwg685","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462343,"meta":{"identity":"CS_BC_2","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"o7bkzrz5jp9lr5r4htrm6mwm","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462345,"meta":{"identity":"CS_BC_1","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m_startPing called [33m30000[39m
{"id":"uoz1obgxnnb0g4xd6uro3g4b","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462346,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BC_2"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"jt8oqxqhtf2bymyokk8yojzl","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462345,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"ws10m58m2ot8vgtka5cvasxn","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462346,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m_startPing called [33m30000[39m
{"id":"qtl5glnf0ud1bu5oapa3ljnm","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462347,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BC_1"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"wzrk8fk8z7k6163tb5py48io","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462349,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit message event when sending a call
[22m[39m{"id":"qd68sorrz39666d31hrgbt3o","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462349,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"zcstx8hkq7jbsizr5gqyp6d0","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462352,"meta":{"port":53349,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"xb52f1qvjt1g4oh4mtr67r43","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462356,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"ttxpobxm1aojavrouleemkcm","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462357,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"oh0e5g6eebyu9jopxbr1td5h","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462362,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould emit callResult event when receiving a response
[22m[39m{"id":"k02qabtlm2ffl7qltw1fivmb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462363,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"s23rtzwhna6i0e2dm6nf46qe","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462365,"meta":{"port":53351,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"drdk6kwr834f1hxfd3ta3jez","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462371,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"lfr4vuxig3yxbr31avlqh5nw","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462372,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"v81j1i0y8trkda3w6ipgwvfb","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462376,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould support concurrent calls with callConcurrency > 1
[22m[39m{"id":"ym7rcf77c5npdcefxx29j4xw","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462377,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"bj8j2vtfkky0s6h8rpyem8p5","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462380,"meta":{"port":53353,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"x6utblje3re4655e2zwaaxul","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462383,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"vr1ik04lmczwr44l5cumlnqv","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462384,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"jgw04hbquwfwwx8zwn1jay6c","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462415,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_RAW"}}
{"id":"ajlj2v3n3b95g8bmyoxyr2c4","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462415,"meta":{"identity":"CS_RAW"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould send raw message via sendRaw
[22m[39m{"id":"jstdyfqf4yq37elw6z3xhc7p","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462416,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"lzeosteqergfiv65pjsvagte","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462420,"meta":{"port":53355,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"jq8jwvwhf64teuka25lzaf90","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462423,"meta":{"identity":"CS_RECONF","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m_startPing called [33m30000[39m
{"id":"nrbtmzfw9v58qbahc4cloc2h","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462423,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONF"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"zs5emwutzu6l4zt7zjj8zvec","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462424,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure options at runtime
[22m[39m{"id":"fmll61fihv2mkc4eyan3z2e8","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462425,"meta":{"identity":"CS_RECONF"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"ajp5xje3oo4elwsx9umqfaci","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462428,"meta":{"port":53357,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"h7ounz1lec4ub14gr2frigrg","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462430,"meta":{"identity":"CS_RECONF_STRICT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m_startPing called [33m30000[39m
{"id":"me94l0hxfapvs77ujkfbznqy","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462431,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONF_STRICT"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"z7hm3jf7yopficdbtvajeg8e","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462432,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure and re-setup validators when strictMode changes
[22m[39m{"id":"ybegdene1umhc37pnaplk0g8","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462434,"meta":{"identity":"CS_RECONF_STRICT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"njzw2wrmzdw44pm1oajkhek4","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462439,"meta":{"port":53359,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"i4vfl5b8ureyeao0il7b004l","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462443,"meta":{"identity":"CS_RECONF_PING","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m_startPing called [33m0[39m
{"id":"psvgdt7bn1i4t74u0e1259e0","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462443,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONF_PING"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"c80ngxl0c8ghojk78b7pd6wf","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462444,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould reconfigure ping interval
[22m[39m{"id":"b8s7fpiqduvipwcy2jq0bk34","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462445,"meta":{"identity":"CS_RECONF_PING"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"z5d0zlauiyw2kr0qrrg8n9pc","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462448,"meta":{"port":53361,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"fy6d5lf4hjpaq72j282m52w3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462448,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould abort a call with AbortSignal
[22m[39m{"id":"byanozbrse9ymrkcqpcsz0tt","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462450,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"x3ml6xgmm9vbar3bb8g1m3vv","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462451,"meta":{"identity":"CS_BADMSG","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m_startPing called [33m30000[39m
{"id":"dxy18js7r4ph2ngv8l2cycm6","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462453,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BADMSG"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"xezyf1lcn55xt1ekywrgfggs","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462455,"meta":{"port":53363,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"pptp0joqnr1yi1b1dn62cjxv","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462459,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"a58iqar9t74ahec62amfjcpl","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462460,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"xz8stigvobn3124rj1a6oooh","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462463,"meta":{"clientCount":2},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"ilzbmbdv28c4v8ws8pe2wy8y","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462463,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"s6jd8nuaqz0uw1a6s2cfif36","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462463,"meta":{"identity":"CS_BC_1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould broadcast to local clients and publish to adapter
[22m[39m{"id":"ybutlxxk3yadzqimnxqjsirg","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462467,"meta":{"identity":"CS_BC_2"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mRPC Calls[2m > [22m[2mshould immediately reject if AbortSignal is already aborted
[22m[39m{"id":"mxkld6507fxr6cd081jrlaye","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462464,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"jw0u0emz2oa1k3iyyxfh4zno","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462472,"meta":{"port":53365,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"f9y4h96hyt13u9298b43senw","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462472,"meta":{"port":53367,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"e9qhv0hfpen4ud985d22sy82","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462473,"meta":{"port":53366,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"i0ivhdeg0k9b6olx054t0p13","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462475,"meta":{"identity":"CS_PERSIST","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"na90rvorm1k8krt5oayed0v0","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771788462497,"meta":{"attempt":1,"delayMs":37},"context":{"component":"OCPPClient","identity":"CS_MAX"}}
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"oazl1kr83ihitbw2z5qojyc7","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462475,"meta":{"port":53368,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"da0a5sr2tlhv6sym64x8ddrs","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462476,"meta":{"identity":"CS_CLOSE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m_startPing called [33m30000[39m
{"id":"uzt9reii9167lg445zki4pg3","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462476,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PERSIST"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m_startPing called [33m30000[39m
{"id":"sx0fqb1wo37drjis67dpjjtj","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462477,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_CLOSE"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"yum6wn7r05x1d5rfh84ewvc6","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462477,"meta":{"identity":"BR_NO_RC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"bnr7jp9dnj17r1vta2sfbocp","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462478,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_NO_RC"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"pw9fxgsfb66mgx1brb0cwebj","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462479,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"cb48s4nq4j200dql35lg1jrn","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462480,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_NO_RC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"z19f7qmztim49ehk43kvhrvy","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462480,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_PERSIST"}}
{"id":"jtmqjjwcrlfkflgcfd51zm0c","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462480,"meta":{"identity":"CS_PERSIST"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when reconnect is disabled
[22m[39m{"id":"gu5myhfnogp4sq456ccz54ox","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462481,"meta":{"identity":"BR_NO_RC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"wyi9r3h3f2hncv58xzse6gwh","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462481,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"zzc80rocir94g21ywlvfos6c","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462482,"meta":{"identity":"CS_PERSIST","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"nlbcggl5pojpdv9oy3kt2vs0","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462482,"meta":{"identity":"CS_CLOSE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m_startPing called [33m30000[39m
{"id":"qxttbqqorlfbrozq0rz72g6f","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462483,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PERSIST"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"awp7pdco4pjy18agks1yga34","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462488,"meta":{"port":53374,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"ao6cowfok3ie9u3b2yihn95q","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462488,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"ye09ugtuvmfgcjk3fo5ixyhp","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462489,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"o5ao7w875z0q9s4wqptws72c","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462490,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould persist session data across reconnections
[22m[39m{"id":"qvz486j3vznnatnaiwur10ks","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462490,"meta":{"identity":"CS_PERSIST"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"y6k4b1r8o0esirprvhk5byf1","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462494,"meta":{"identity":"CS_MAX","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m_startPing called [33m30000[39m
{"id":"p4a1mq09e3spvn274zhcd76a","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462495,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_MAX"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"f1vxbr6fkbguvdelhz8i7br6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462495,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"b0o1o7o85l66cx9qom9idhlm","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462497,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_MAX"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"ycmw69y93k0m9qx4a86xqxa9","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462492,"meta":{"port":53376,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"npu05ev97cbukqp2vd0233sw","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462498,"meta":{"identity":"CS_MAX"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"dkl6rk51p4hsn4h8ki1c5fsa","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462492,"meta":{"identity":"CS_GC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m_startPing called [33m30000[39m
{"id":"vi5vwejt3wwygnklda6ku3qr","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462492,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_GC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"fsm2c30y2y14i0k8ckt0rjy8","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788492492,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_GC"}}
{"id":"cmo28w5tfavgrqiqn4mjbruq","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788492492,"meta":{"identity":"CS_GC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"w248y8hhkdwg3o4dq4f54sax","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771792062492,"meta":{"identity":"CS_GC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m_startPing called [33m30000[39m
{"id":"rz2yep32flsl15r3vufa1wjz","level":30,"levelName":"INFO","message":"Connected","timestamp":1771792062492,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_GC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"rw4qnykxi5g48bocy330f9lq","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771792092492,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CS_GC"}}
{"id":"nlku6o4fcdhdg294wrpu6pcw","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771792092492,"meta":{"identity":"CS_GC"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"rag8qfoa209rqbg6uwk2zcoe","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771799322492,"meta":{"identity":"CS_GC","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m_startPing called [33m30000[39m
{"id":"f0i6nzjzlvs1u10v26u0ru2e","level":30,"levelName":"INFO","message":"Connected","timestamp":1771799322492,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_GC"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"lezk5lr3cvgmzxwvwz7xk8v2","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771799322492,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould garbage collect stale sessions
[22m[39m{"id":"zyxh089kgkq77ehutabdc1po","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771799322492,"meta":{"identity":"CS_GC"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould ignore broadcast messages from self (loopback)
[22m[39m{"id":"pmfwcdzf8g4gaszh4o5dx4yw","level":40,"levelName":"WARN","message":"Received unicast for unknown client","timestamp":1771788462533,"meta":{},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould ignore broadcast messages from self (loopback)
[22m[39m{"id":"teqqf2lka6cl6dugcd3zpqua","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462534,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould ignore malformed broadcast messages
[22m[39m{"id":"gicyzvtsa2fg1ev160b48rcm","level":40,"levelName":"WARN","message":"Received unicast for unknown client","timestamp":1771788462538,"meta":{},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould ignore malformed broadcast messages
[22m[39m{"id":"lmuakfx9oe32q0njwt7n0088","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462538,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould handle client errors during broadcast gracefully
[22m[39m{"id":"c877b9gfikqniac0j0ms8n6j","level":40,"levelName":"WARN","message":"Received unicast for unknown client","timestamp":1771788462540,"meta":{},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' when max reconnects exhausted
[22m[39m{"id":"p8yakihzgnrmf34qme45yzya","level":50,"levelName":"ERROR","message":"Connection error","timestamp":1771788462552,"meta":{"error":""},"context":{"component":"OCPPClient","identity":"CS_MAX"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould log bad messages
[22m[39m_startPing called [33m30000[39m

[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[90mstdout[2m | test/server.test.ts[2m > [22m[2mOCPPServer - Robustness & Clustering[2m > [22m[2mshould handle client errors during broadcast gracefully
[22m[39m{"id":"pataib3adrkybl8bj2axjx9s","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462564,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"zjojyvjxzi9yupf52m8cc5b8","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788462564,"meta":{"error":"Expected property name or '}' in JSON at position 13 (line 1 column 14)","count":1},"context":{"component":"OCPPClient","identity":"CS_BADMSG"}}


[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"h6xxkij8kwd256gfja93xnkf","level":40,"levelName":"WARN","message":"Received CallError for unknown messageId","timestamp":1771788462565,"meta":{"messageId":"msg1"},"context":{"component":"OCPPClient","identity":"CS_BADMSG"}}

 [32mâœ“[39m test/server.test.ts [2m([22m[2m24 tests[22m[2m)[22m[33m 1156[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"h3sc3colhkfzy2bax22cat5c","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462599,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould handle incoming calls from server
[22m[39m{"id":"ehzysjut1tc969mfsdivvx3l","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462600,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"y6wcsugc337g3zm6no1y8csc","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462602,"meta":{"port":53384,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"tcq7w8j4f4r9sfr5cgfltp9p","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462605,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"ls3u24vntesu95kznmfpywe3","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462606,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"ggwmsei7t9gg75ecw72l2vtv","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462696,"meta":{"port":53386,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"sz0l92ugv0vpx0vystqes66j","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462699,"meta":{"identity":"BR_INT_CLOSE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"nky1kc0ys1g0j5spfkezaqi3","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462700,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_INT_CLOSE"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"b29y6wojjkegrpk5r5m954a1","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462705,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” disconnect vs close Events[2m > [22m[2mshould emit 'close' on intentional close()
[22m[39m{"id":"jw1mj1cpgtpakavvw12qzwbg","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462706,"meta":{"identity":"BR_INT_CLOSE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"f2wpzgrubms9zz2gf6ievlgm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462712,"meta":{"port":53388,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"oekjmfrruf7d0pky4b1u5caz","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462712,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould invoke wildcard handler for unregistered methods
[22m[39m{"id":"z1xzs0rvxpgammgmt7ok5ocr","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462713,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"d7x9puf43tgb67wpigjo7n53","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462718,"meta":{"identity":"BR_VALID","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"f7fyxl3hclhsaq2c8ag84qqi","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462719,"meta":{"port":53390,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"z9hwtnoeh5urqq0uvrfr5r5h","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462720,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_VALID"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"dpixhu84u0d8jn114g72p6r8","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462723,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"xtzwpqw3rk65lvsrtt7m2z47","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462722,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"w17ct458vcfwaqmih0ej7gy5","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462724,"meta":{"identity":"BR_VALID"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"h4403hnuxhjsjed0drqdfbkf","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462723,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"azxamiy4eg92dllz9vmcckvf","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462727,"meta":{"port":53392,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"ydt3zxzuwq97obvgq952p4ds","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462731,"meta":{"identity":"BR_BAD","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"rqywtzkzl1o3iuz3m71qil4w","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462734,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_BAD"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"v0ojaqfjpsuer5t7e7qr6luw","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462740,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"wjsnfjtauj5rjlrm119rt3nc","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462741,"meta":{"identity":"BR_BAD"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould throw when sendRaw called in CLOSED state
[22m[39m{"id":"ybvvjsbxv7fatzolkr1w9lh5","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462744,"meta":{"port":53394,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould throw when sendRaw called in CLOSED state
[22m[39m{"id":"uvayx70ijimg9kv7hhkatfor","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462746,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"j1ans2ylje7gnibxe5c6jiup","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462750,"meta":{"port":53395,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"nkg9d65pwrf9413xgpf9t49d","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462756,"meta":{"identity":"BR_OPEN","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"vl9w0d28bzx3t75gyre5jjfo","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462757,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_OPEN"}}

[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"mx8opzj81ba3bpewax3uo4iz","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788462759,"meta":{"error":"Unexpected token 'i', \"immediate-msg\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"BR_OPEN"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"tftogl14n0kc07n5rcpu1aor","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462766,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_BADMSG"}}
{"id":"cpx1sz73nnv99zk4epp8gwiu","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462766,"meta":{"identity":"CS_BADMSG"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould handle bad messages and emit badMessage event
[22m[39m{"id":"ppss8euef9l7v3424r45okbf","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462767,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"lfg2yp2nhj3vv7kg5ey5j6sz","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462773,"meta":{"port":53397,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"bf656ekn5t3hlutebrxhcda5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462776,"meta":{"identity":"CS_RECONN","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m_startPing called [33m30000[39m
{"id":"mxmrcfujrz9a2qeq1ol0t8qn","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462777,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_RECONN"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"fkqgat0h9vqxg351rfm5r0ie","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462778,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"uc42zlqg2bmkf3pd0allbpjb","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462780,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_RECONN"}}
[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"su09turrpf67xex8857iyozc","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771788462781,"meta":{"attempt":1,"delayMs":52},"context":{"component":"OCPPClient","identity":"CS_RECONN"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"v1l1f5249es0v3qx8besxg0w","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462783,"meta":{"identity":"CS_RECONN"},"context":{"component":"OCPPServer"}}


[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"tl6dbdf269j4jrn2j5f8wo79","level":50,"levelName":"ERROR","message":"Handler error","timestamp":1771788462828,"meta":{"messageId":"txly7o0cupgo4vz1sbuhxe7w","method":"UnhandledMethod","error":"No handler for method: UnhandledMethod"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"ojn856d07mffb4uqmujmxz2x","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462830,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould respond with NotImplemented for unhandled methods
[22m[39m{"id":"spaymd16g593detob2udlzh1","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462830,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"i60oqbuob752dllp4n9w9mqn","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462834,"meta":{"port":53399,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"u97irjwzsgcexipgyedfh5pl","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462837,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"s942x4ukorn8sb6g9qn1iyri","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462838,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould attempt reconnect on unexpected disconnect
[22m[39m{"id":"mqb2kxkru6wwo2uxt1l22jan","level":50,"levelName":"ERROR","message":"Connection error","timestamp":1771788462847,"meta":{"error":""},"context":{"component":"OCPPClient","identity":"CS_RECONN"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Client[2m > [22m[2mshould respect logging.enabled = false
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"fycnelunyo5279aeruza6c5v","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462942,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould prefer version-specific handler over generic handler
[22m[39m{"id":"dd4ekwm9w2dngf2glm4hajq2","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462943,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"h4ixicq7wn6l1lfulr01xtzz","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462945,"meta":{"port":53407,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"o27et9cv96tiypjmmwlum776","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462948,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"uie2n1no1yc2q8nd5sf5y2gc","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462949,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Server[2m > [22m[2mshould log client connected and disconnected
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"n57sh24htlh50ibti8zdp9xp","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462961,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"zzzcscyrcw9c4b2cbch0jqx2","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462962,"meta":{"identity":"BR_OPEN"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"ds7a75j3ozr5gf25854ad3z1","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788462965,"meta":{"port":53410,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"ah2941wh9nm7e4pk7i4r9jc5","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788462971,"meta":{"identity":"BR_BUF","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"imspns874nrisjnac3y5cpgf","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771788462975,"meta":{"attempt":1,"delayMs":125},"context":{"component":"BrowserOCPPClient","identity":"BR_BUF"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"t6rgzhry562zb2yg82tae90m","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788462972,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_BUF"}}


[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"gol8r9whkwozoolq63jxjbbz","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788462973,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"ff4lsvynwznk6vr8kpt98kln","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788462974,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_BUF"}}

[22m[39m{"id":"csogakgow4pil5kg7lld1hod","level":50,"levelName":"ERROR","message":"Handler error","timestamp":1771788463073,"meta":{"messageId":"bx775txzpcez7aio6qx2wimb","method":"Reset","error":"No handler for method: Reset"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"lbfawezcmbb43wgw17wbyyin","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788462989,"meta":{"identity":"BR_BUF"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"raxurb4d1zikjdny9eovspfw","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788463120,"meta":{"error":"Unexpected token 'b', \"buf-msg-1\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"BR_BUF"}}
{"id":"p92uimzztmub6xkzt7x00fzm","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788463121,"meta":{"error":"Unexpected token 'b', \"buf-msg-2\" is not valid JSON","count":2},"context":{"component":"OCPPClient","identity":"BR_BUF"}}
[22m[39m{"id":"uqsfy7aqslit1zgmalro3ujs","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463087,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove a specific handler with removeHandler()
[22m[39m{"id":"lvdmcmdwqosgm6ewvf10ckn9","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788463088,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"gxfbsqy14ge4szg4tdscimlf","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463105,"meta":{"port":53412,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"c5atbreq78xvf157kxmkypw9","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463115,"meta":{"port":53410,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"a5idu9rjipx2gllau4z3huep","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788463118,"meta":{"identity":"BR_BUF","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"j9budvbbgq0or2wkjef06g5a","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788463119,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_BUF"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"jmctnzuys71728gxslbsvhqk","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788463129,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"ywz86xy5sz88qyikal35f10h","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788463130,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Server[2m > [22m[2mshould pass logging config to server clients
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[90mstderr[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould emit error when connecting to non-existent server
[22m[39m{"id":"zc6j8x5jq4hq5f6z7llovfl9","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463237,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"us4pn37wk4y3y9a2eiwpa8l9","level":50,"levelName":"ERROR","message":"Connection error","timestamp":1771788463320,"meta":{"error":""},"context":{"component":"OCPPClient","identity":"CS_ERR"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove version-specific handler with removeHandler(version, method)
[22m[39m{"id":"esqk99579gaglwb73tjdn9d6","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788463238,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove wildcard handler with removeHandler()
[22m[39m{"id":"wt0izfgxvpe4bc6p7l0fmvak","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463243,"meta":{"port":53421,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"bcarkg2k8ln2yv1tzgf9h1qf","level":50,"levelName":"ERROR","message":"Handler error","timestamp":1771788463375,"meta":{"messageId":"lkwd1j73yw0f7gxz5jp8ygel","method":"Reset","error":"No handler for method: Reset"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove wildcard handler with removeHandler()
[22m[39m{"id":"z7d6hom6psxcdm0slinmheic","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463244,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"hnbg54tgwc1vfflybn3ntdpd","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463248,"meta":{"port":53422,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"xjzo0dormriv2bambejlre68","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788463251,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"cdki0nbmvc0wu86i7vnzekqk","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788463253,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/logger.test.ts[2m > [22m[2mLogger Integration - Server[2m > [22m[2mshould not log on server when logging is false
[22m[39m_startPing called [33m30000[39m

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"p0jlc0knjchdlgnxkwref751","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463323,"meta":{"port":53427,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"yrfo3et9pppdwihfedl0cv7r","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788463330,"meta":{"identity":"CS_PING","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m_startPing called [33m200[39m
[22m[39m{"id":"wmv5ajf1xpz6mjlijp4zq4q4","level":50,"levelName":"ERROR","message":"Handler error","timestamp":1771788464147,"meta":{"messageId":"iuzj0fm73xhcafmmhn40dbje","method":"Buggy","error":"Something broke"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
{"id":"do54767gcwzb9eltmhtwudfp","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788463332,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PING"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"x686glclnvp29fqi5h7f8xpe","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463379,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould remove all handlers with removeAllHandlers()
[22m[39m{"id":"r4926h02xj7430jrrd4if6qx","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788463380,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould throw on invalid handle() arguments
[22m[39m{"id":"ozxac57vyt2lc0kk3ttku8jz","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463384,"meta":{"port":53429,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould throw on invalid handle() arguments
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"a5hltfhs1bzjy9u92jgboxxl","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463387,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"qyveod86ns1ltmacla12k81d","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788464731,"meta":{"error":"Unexpected token 'h', \"hello\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"CS001"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"d2zgecixql9i9bk9tvwsnvol","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463391,"meta":{"port":53430,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/logger.test.ts [2m([22m[2m16 tests[22m[2m)[22m[33m 2006[2mms[22m[39m
   [33m[2mâœ“[22m[39m Logger Integration - Client[2m > [22mshould log reconnection attempts [33m 516[2mms[22m[39m
   [33m[2mâœ“[22m[39m Logger Integration - Client[2m > [22mshould log bad messages [33m 326[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"qi81wy3vymtzbjo55u9ymz5l","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788463475,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"woq0clrof4cx2h2mcrijj358","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788463477,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39mdoPing executed

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"au5t1iyx7f04xkx3jegxd6uc","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463584,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould emit call event for incoming calls
[22m[39m{"id":"i8azociggnq992n7rxso3wbq","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788463585,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"zi2ftqly3lhira6ix73l5dav","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463587,"meta":{"port":53432,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"fp2puj7bsaopvd989qcgnkpo","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788463591,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"pv34zfg8uf778ju3o5hd04mo","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788463592,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

 [32mâœ“[39m test/validator.test.ts [2m([22m[2m15 tests[22m[2m)[22m[33m 551[2mms[22m[39m
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"zh1pskroxasx2y8bcm2os9o8","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788463700,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_PING"}}
{"id":"fa8195gvj9fra59ti4kb1gan","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788463702,"meta":{"identity":"CS_PING"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould use ping when pingIntervalMs is set
[22m[39m{"id":"ck6k5zfsy7i9unrtwygv197w","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463702,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"n4jlvlpdjgivbgqsuefaj1me","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463706,"meta":{"port":53434,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"dcjm4acwnkobag76mdqqx0jn","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788463723,"meta":{"identity":"CS_STRICT","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m_startPing called [33m30000[39m
{"id":"pyq0ulvfsse4e0jfqzy4zjpe","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788463725,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_STRICT"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"zjg1li7fe1bsfsuvy4plr3pq","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463731,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Advanced Features[2m > [22m[2mshould validate outbound calls in strict mode
[22m[39m{"id":"jh5u9ebc79fouhm3q5ypbaz4","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788463731,"meta":{"identity":"CS_STRICT"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"onegudc6ttck5r2s0owyb9yf","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463750,"meta":{"port":53436,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"ysimzydx9mbftcxfdsr7xqtc","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788463755,"meta":{"identity":"CS_VCALL16","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m_startPing called [33m30000[39m
{"id":"mxw4r888dxvfi92k6hpcwg43","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788463757,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VCALL16"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"benz1r7miguk7ghtuuazhhu4","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463764,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp1.6)
[22m[39m{"id":"ybyv2x04zdwyzld2gs0ey41j","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788463768,"meta":{"identity":"CS_VCALL16"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"bvc2hzvl0jwmbfiaqwsk123k","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463786,"meta":{"port":53438,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"lyhd628gwxvs3nhdjwk2rgq2","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788463803,"meta":{"identity":"CS_VCALL201","remoteAddress":"::1","protocol":"ocpp2.0.1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m_startPing called [33m30000[39m
{"id":"d0s0yhy8wym0e73lezrk5eku","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788463808,"meta":{"protocol":"ocpp2.0.1"},"context":{"component":"OCPPClient","identity":"CS_VCALL201"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"hufpwlu1buf9g3o5lojdk9eu","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463818,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould call with version-specific typed params (ocpp2.0.1)
[22m[39m{"id":"bkciang0cqixwf5tet7ql4d6","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788463825,"meta":{"identity":"CS_VCALL201"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"cohfodvqffw19fys3s907sxg","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771788464995,"meta":{"attempt":1,"delayMs":162},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}

[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"ka89kgd13aioe3kf9tgn7r2p","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788465057,"meta":{"error":"Unexpected token 'o', \"not-json{{{\" is not valid JSON","count":1},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
[22m[39m{"id":"hh9mharfso38edp7fl9l9z3u","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463853,"meta":{"port":53440,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"hp5ha4fpucol0rdt5onn50r2","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788463860,"meta":{"identity":"CS_VCALL_DEF","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m_startPing called [33m30000[39m
{"id":"hn7xvf3luk4r9ynxuukgshq9","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788463865,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VCALL_DEF"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"yjv3svdeilcw8him5d34iysa","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463868,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[22m[39m{"id":"ost2sqoj6f2zjl8pa5al5el5","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788465211,"meta":{"error":"Unexpected token 'b', \"buffered-msg-1\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould still work with non-versioned call (default protocol)
[22m[39m{"id":"w6vtunc4k31nzdk3esw1g1az","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788463869,"meta":{"identity":"CS_VCALL_DEF"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"u6c9skmwyeu7525wvghi2jql","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788463879,"meta":{"port":53442,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

{"id":"ie7w4s32sl5o3iq7ni88trcd","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788465215,"meta":{"error":"Unexpected token 'b', \"buffered-msg-2\" is not valid JSON","count":2},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"tcsia39txwntp7an46dtvu6c","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788463914,"meta":{"identity":"CS_VCALL_SRV","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m_startPing called [33m30000[39m

{"id":"k7xfnk1yto3ojc3b6zkfnuhy","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788463920,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VCALL_SRV"}}

[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"mdvar46dpqgdbn9n0iimpurv","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788465356,"meta":{"error":"Message is not an array","count":1},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
[22m[39m{"id":"er7tjaqinqorvdsneppupnpr","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788463929,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_VCALL_SRV"}}
{"id":"gg7je3gb0k9g49h8yjhb7phs","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788463929,"meta":{"identity":"CS_VCALL_SRV"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/client.test.ts[2m > [22m[2mOCPPClient - Version-Aware Call[2m > [22m[2mshould support version-aware call from server to client
[22m[39m{"id":"id2f2klx0g0el9a9wlon849z","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788463930,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/streams.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 3058[2mms[22m[39m

   [33m[2mâœ“[22m[39m Redis Streams Persistence[2m > [22mshould persist messages when node is offline [33m 3042[2mms[22m[39m
[90mstderr[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould reject connection if no route matches
 [32mâœ“[39m test/client.test.ts [2m([22m[2m38 tests[22m[2m)[22m[33m 2570[2mms[22m[39m
   [33m[2mâœ“[22m[39m OCPPClient - Advanced Features[2m > [22mshould send raw message via sendRaw [33m 336[2mms[22m[39m
   [33m[2mâœ“[22m[39m OCPPClient - Advanced Features[2m > [22mshould handle bad messages and emit badMessage event [33m 322[2mms[22m[39m
   [33m[2mâœ“[22m[39m OCPPClient - Advanced Features[2m > [22mshould attempt reconnect on unexpected disconnect [33m 529[2mms[22m[39m
[22m[39m{"id":"mxe6a27celykb1zedgbe8rux","level":40,"levelName":"WARN","message":"Connection rejected: No matching route found","timestamp":1771788465399,"meta":{"pathname":"/wrongpath/CP-REJECT"},"context":{"component":"OCPPServer"}}

   [33m[2mâœ“[22m[39m OCPPClient - Advanced Features[2m > [22mshould use ping when pingIntervalMs is set [33m 382[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"szxc8jwqdvs8x9rp57sldtsx","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464018,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould reject connection if middleware throws
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould support NOREPLY from handler
[22m[39m{"id":"leq7t6zyguaskhbbwg9t8ae9","level":40,"levelName":"WARN","message":"Auth rejected","timestamp":1771788465545,"meta":{"identity":"CP-1","code":403},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"qsxq649pskkr4gbar79swlrq","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464020,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"hwzf2jgupaw4l1meuarzsefg","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464024,"meta":{"port":53444,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[90mstderr[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould reject connection if middleware throws
[22m[39m{"id":"wbpnnhbbxs7x6nj192cpecco","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464029,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"w25bpbv2gbo55609opfohtrh","level":50,"levelName":"ERROR","message":"Unexpected HTTP response","timestamp":1771788465550,"meta":{"statusCode":403},"context":{"component":"OCPPClient","identity":"CP-1"}}

[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"u568w82ojykw074ujhldr0ey","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788465610,"meta":{"error":"Unknown message type: 99","count":1},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"sqy54mzgwzg12bfo0pj4i04q","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464031,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}


[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"s4rc1ocynqbflr7rzlcxgeev","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464151,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"hfn1h63kj1612uqqt58j09j0","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788465845,"meta":{"error":"Unexpected token 'b', \"bad1\" is not valid JSON","count":1},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

{"id":"dn6xm00ox5xazvj9l4w0jf3l","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788465845,"meta":{"error":"Unexpected token 'b', \"bad2\" is not valid JSON","count":2},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Outbound Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open

[90mstderr[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould emit upgradeAborted when client disconnects during auth
[22m[39m{"id":"vwlc6nyaey4tnim55pb426qn","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464152,"meta":{"identity":"BR_BUF"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"nh818i980dhkoyhou8sjsd0d","level":40,"levelName":"WARN","message":"Handshake aborted","timestamp":1771788466235,"meta":{"identity":"abort-test-01","reason":"Socket closed during handshake"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"v267m8n587tqtdgu37drgc7t","level":40,"levelName":"WARN","message":"Reconnecting","timestamp":1771788466256,"meta":{"attempt":1,"delayMs":26},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[22m[39m{"id":"ngrz3kcclokbgn7zvwrf8c02","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464156,"meta":{"port":53446,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstderr[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"rjj6ufint136pcmdec6afwaf","level":40,"levelName":"WARN","message":"Bad message","timestamp":1771788466412,"meta":{"error":"Unexpected token 'i', \"immediate-msg\" is not valid JSON","count":1},"context":{"component":"OCPPClient","identity":"CS_IMMED"}}
[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"lcbpd0amivtxg6lyvnblkei6","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464159,"meta":{"identity":"BR_PENDING","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}


[90mstderr[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould abort handshake on timeout
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"dy9tyadfyaogy7jegnemsb48","level":40,"levelName":"WARN","message":"Handshake aborted","timestamp":1771788466452,"meta":{"identity":"timeout-test-01","reason":"Handshake timeout"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"z6ehf3damd2uer5um226mu5h","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464159,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}


[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"bur9fbgneiwjiv13hvajzbrg","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464160,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"BR_PENDING"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mIncoming Call Handlers[2m > [22m[2mshould include detailed errors when respondWithDetailedErrors is true
[22m[39m{"id":"wqeqxjl58hs7whf3tmq8msht","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464187,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept outgoing calls
[22m[39m{"id":"ht2scjsueuttixke2lg6zh4j","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464200,"meta":{"port":53448,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept outgoing calls
[22m[39m{"id":"x9wgpo9vpk12yh0slj5y8zoo","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464220,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept outgoing calls
[22m[39m{"id":"yfaljqrmfotu6w7t7fn5lxgu","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464221,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept outgoing calls
[22m[39m{"id":"wn0dqj7s33oy7rras863r7kt","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464226,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept outgoing calls
[22m[39m{"id":"j1150l389m45521dgbrtzcnj","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464233,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming calls
[22m[39m{"id":"vaws5u292q2bhnvvz0yfxl4k","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464236,"meta":{"port":53450,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming calls
[22m[39m{"id":"fjmpb7t32dgk3bnm5hwgl30i","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464262,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming calls
[22m[39m{"id":"bg2txz4cz0bx4kzim512d9l5","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464264,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"zo7lwmz1fcmll0st1u2nttc0","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464285,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"xrqivfaaa3gnx3bg77ui8814","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788464287,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"BR_PENDING"}}

[90mstdout[2m | test/browser-robustness.test.ts[2m > [22m[2mBrowser Phase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"m9gcgsez3zto56to8i4bajh7","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464288,"meta":{"identity":"BR_PENDING"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/browser-robustness.test.ts [2m([22m[2m11 tests[22m[2m)[22m[33m 2652[2mms[22m[39m
   [33m[2mâœ“[22m[39m Browser Phase 3 â€” Reconnect State[2m > [22mshould stay in CONNECTING state during reconnect backoff [33m 379[2mms[22m[39m
   [33m[2mâœ“[22m[39m Browser Phase 3 â€” Outbound Buffering[2m > [22mshould buffer sendRaw messages during CONNECTING and flush on open [33m 1190[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming calls
[22m[39m{"id":"dmq20kuqoguybfswb539sm6g","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464381,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming calls
[22m[39m{"id":"at414hec77t40j554lymzxbl","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464382,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming results
[22m[39m{"id":"ius1892ac2o7debh2hrq4aj9","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464389,"meta":{"port":53452,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming results
[22m[39m{"id":"m3x4byde93fjc54ocbgtnwwg","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464470,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming results
[22m[39m{"id":"yynbbl1xsrpbjiajkb7aztnw","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464472,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"euhuri8661ndiwryi2qvje5m","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464516,"meta":{"port":53454,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"ubqswk1yzgp03ujgfpiwp0yk","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464520,"meta":{"identity":"CS_VALID_CODE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m_startPing called [33m30000[39m
{"id":"ez8g1kn54517mw0ohulhoj88","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464522,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VALID_CODE"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"nh8yb25ehvqy7to5eez91722","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464525,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept valid close codes
[22m[39m{"id":"i0wkyntws9qfyg3x4de2fctu","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464529,"meta":{"identity":"CS_VALID_CODE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept custom close codes (4000-4999)
[22m[39m{"id":"s1wxiycxhin286fu4jit2s33","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464575,"meta":{"port":53456,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming results
[22m[39m{"id":"ubagnr1cai5c5nruhtz5dku7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464580,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould emit error event on WebSocket error

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming results
[22m[39m{"id":"oklprf1fmzdkej4kvefpph6m","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464581,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}
[22m[39m{"id":"effvjsqq3pri936cyva777qr","level":50,"levelName":"ERROR","message":"Connection error","timestamp":1771788467803,"meta":{},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}


[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming errors
[90mstderr[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"kuiomnpqn0fe0y7gofbd93yr","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464584,"meta":{"port":53457,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept custom close codes (4000-4999)
[22m[39m{"id":"htvoxfg4kdql46keb4gi7ypt","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464631,"meta":{"identity":"CS_CUSTOM_CODE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[22m[39m{"id":"yhtkkbcrpfescnbj8ostdfxu","level":50,"levelName":"ERROR","message":"Handler error","timestamp":1771788467925,"meta":{"messageId":"zjyy1f4lw247s0t735x6j5u1","method":"Buggy","error":"unexpected error"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}
[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept custom close codes (4000-4999)

[22m[39m_startPing called [33m30000[39m
{"id":"cgjgb3cjvw7tt0myeztq0faz","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464632,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_CUSTOM_CODE"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept custom close codes (4000-4999)
[22m[39m{"id":"ni42mz7yyy9wqmsdjfdifit9","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464634,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould accept custom close codes (4000-4999)
[22m[39m{"id":"k4dlvs8ktgjfe34hrvf2dq0g","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464635,"meta":{"identity":"CS_CUSTOM_CODE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"g9jpd3j2gy7s6l61opn50zoa","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464638,"meta":{"port":53460,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming errors
[22m[39m{"id":"j36gekdeqwkdvfnxo15jg1dj","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464637,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming errors
[22m[39m{"id":"it7tnzk51o7ie4jttfsodmh5","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464639,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming errors
[22m[39m{"id":"hwwmo458zd9z9ykz76u338uo","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464705,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mMiddleware[2m > [22m[2mshould intercept incoming errors
[22m[39m{"id":"ebp9u4zhc6tj0tpzicjqi14b","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464706,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"buhjjvogeyy8uwok6g12akxe","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464717,"meta":{"port":53462,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"zkomq847rhislgr21pfi2h8j","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464728,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"rx8bsyiwvrd3auvcj48xw5j9","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464729,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"c9m467y3e5flrbf1oogc115e","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464733,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould send raw data over WebSocket
[22m[39m{"id":"bxrrctpm92hdbvl3kh1vfg98","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464807,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould throw when not connected
[22m[39m{"id":"zjw4736vb8vnzwmndezagcxm","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464833,"meta":{"port":53464,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2msendRaw[2m > [22m[2mshould throw when not connected
[22m[39m{"id":"eq91hq6qhl7a245gvmx9yhk3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464875,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update options
[22m[39m{"id":"hep0znl1rgu7t00e9ldrad99","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464883,"meta":{"port":53465,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"juiywnjwsngl1glqq2zrzhz8","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464851,"meta":{"identity":"CS_BAD_CODE","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update options
[22m[39m{"id":"wpowi0kvl082i5fz2cmgk0h0","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464885,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m_startPing called [33m30000[39m
{"id":"dstq7ju1w7vwlt33it0ye88n","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464889,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BAD_CODE"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update call concurrency dynamically
[22m[39m{"id":"xqtcx03dj8zziaoe16idrx4t","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464890,"meta":{"port":53466,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"g54lb6n1xqg2oubqbxa3g466","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464891,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mreconfigure[2m > [22m[2mshould update call concurrency dynamically
[22m[39m{"id":"zb4yq2m44y884mp90h2na6yv","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464891,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Close Code Validation[2m > [22m[2mshould normalize invalid close code to 1000
[22m[39m{"id":"obihpcy6xvx7zyn6uyclvjnt","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464892,"meta":{"identity":"CS_BAD_CODE"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"b44gqwpt049xglk4fvz03mqy","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464930,"meta":{"port":53467,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"b0cv6u3rjl1h6rr0mytvi6cq","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788464897,"meta":{"port":53468,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"oo16bu2chzu2gjqqk9ikxn94","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464935,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"uk4orglplaap9b5bty4ujdz8","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464936,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"pxnyz7hoabeez1t3lzenjomd","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788464989,"meta":{"identity":"CS_BUFFER","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m_startPing called [33m30000[39m
{"id":"z6xwrycrrmjdjyvasj85su21","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788464991,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"xgny1hkrawznb33kz2xjg3hp","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788464992,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"bo0uagng6btgfw7u0xieo5gp","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788464994,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"ev67pkj2qjg34iq0qkj2uor1","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788464996,"meta":{"identity":"CS_BUFFER"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match default fallback route (legacy behavior)
[22m[39m{"id":"vnndx1saz4qrb87p6l3cavoe","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465123,"meta":{"port":53471,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"m3993go171p0jbgx5gfqsmgn","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465129,"meta":{"port":53468,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"cm0w62xkutnzqv32usrpxw5m","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788465180,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for invalid JSON
[22m[39m{"id":"ikqg1oyg7xogrz6yqjfz6uo1","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465181,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"hhazjhl10es9hkq1uv5c10ac","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465188,"meta":{"port":53472,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"jbtsnyi8j5ymg48dpoe7p2m2","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465207,"meta":{"identity":"CS_BUFFER","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m_startPing called [33m30000[39m
{"id":"r2gvp4mh2i1rx02p7424h32g","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788465209,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"ljdtpkfrnzyfw96gn9f4iyl4","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465225,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"e0pcnefkgk89ke5jysqnx87b","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788465227,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m{"id":"lvtwwhs55tkio5rqkbknerox","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465257,"meta":{"port":53475,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match default fallback route (legacy behavior)
[22m[39m{"id":"awwooidbcxsk2wxlzp578kwh","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465288,"meta":{"identity":"CP-LEGACY","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match default fallback route (legacy behavior)
[22m[39m{"id":"djezb50o2cisv8tntn8fy9rr","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788465295,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match default fallback route (legacy behavior)
[22m[39m{"id":"qiqrzo5mcoiz4fvyrcnnw6wb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465302,"meta":{"identity":"CP-LEGACY"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match string route and extract params
[22m[39m{"id":"m5xcmlkq9czekxsu8emqkhwj","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465332,"meta":{"port":53477,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match string route and extract params
[22m[39m{"id":"j8eh8xs177uo9zfiiiqm8edk","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465338,"meta":{"identity":"CP-001","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match string route and extract params
[22m[39m{"id":"o7o6ued8xblg6rivp2youoai","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788465341,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match string route and extract params
[22m[39m{"id":"zmtcn5w95l05plxa9ubbdnxa","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465344,"meta":{"identity":"CP-001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match RegExp route and extract named groups
[22m[39m{"id":"pm96t57m0d64x7egf6g7nkcq","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465363,"meta":{"port":53479,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match RegExp route and extract named groups
[22m[39m{"id":"ingyjypa89lm8c6lbp6s27gm","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465367,"meta":{"identity":"CP-REGEXP","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match RegExp route and extract named groups
[22m[39m{"id":"r9x5ztmtpeyqagkc4d5k0xd7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788465369,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match RegExp route and extract named groups
[22m[39m{"id":"sesqb35u3sju7iyvpwvtcjpb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465371,"meta":{"identity":"CP-REGEXP"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould reject connection if no route matches
[22m[39m{"id":"z67lec88hur22b8ly63yqiwy","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465392,"meta":{"port":53481,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould reject connection if no route matches
[22m[39m{"id":"j8c3grloxfddksvqnwx09fb4","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788465404,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match first registered route if multiple match (order matters)
[22m[39m{"id":"v9yi9mcj9pv1vxm8ug9qg05w","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465409,"meta":{"port":53483,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match first registered route if multiple match (order matters)
[22m[39m{"id":"qti2g4o4rir7841cpz8ftr3z","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465427,"meta":{"identity":"CP-MULTI","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match first registered route if multiple match (order matters)
[22m[39m{"id":"mt4aifg885j9z3iit36a8pw8","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788465429,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match first registered route if multiple match (order matters)
[22m[39m{"id":"sp3lq6zu5p2kz0gvzni4q0e6","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465430,"meta":{"identity":"CP-MULTI"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould reject connection if no route matches (strict mode)
[22m[39m{"id":"z138q0tgyghpuqbaoov6yfti","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465434,"meta":{"port":53485,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould reject connection if no route matches (strict mode)
[22m[39m{"id":"p8signzt1jn6s7hubxejlvmu","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788465438,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match Express-style wildcard routes securely
[22m[39m{"id":"pvvxmsjt8euphmo83oaqsxwb","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465459,"meta":{"port":53487,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"ced1y792h7vmz6qdizoprrhy","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788465468,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for non-array message
[22m[39m{"id":"pjzw84vyeunjtz4pyhwet443","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465468,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match Express-style wildcard routes securely
[22m[39m{"id":"veqfyq1zy6gnyln4k77aihct","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465477,"meta":{"identity":"CP-123","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match Express-style wildcard routes securely
[22m[39m{"id":"i1sq8x4pbuclszrqzbmgqywd","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788465481,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"fikurzl52gmftbsvldmasg0w","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465484,"meta":{"port":53489,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/routing.test.ts[2m > [22m[2mOCPPServer - Express-like Routing[2m > [22m[2mshould match Express-style wildcard routes securely
[22m[39m{"id":"yrk1l8hxfw9xzogqb5ukte2c","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465483,"meta":{"identity":"CP-123"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/routing.test.ts [2m([22m[2m7 tests[22m[2m)[22m[33m 383[2mms[22m[39m
[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m{"id":"h9w1wtt672koqwdy4imrlr4w","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465501,"meta":{"identity":"CP-1","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"h0vk6pp10f7050szkjid278i","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465503,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m_startPing called [33m30000[39m
{"id":"hn7rh4m8flj0hoa6hdgjnjbv","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788465504,"meta":{"protocol":""},"context":{"component":"OCPPClient","identity":"CP-1"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"vja9grn73045ojiu8j3xuu00","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788465504,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m{"id":"tjka25y2d990jibvmg35ijzd","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465512,"meta":{"identity":"CP-2","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m_startPing called [33m30000[39m
{"id":"zryhc519g0z7m04u03smixw6","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788465513,"meta":{"protocol":""},"context":{"component":"OCPPClient","identity":"CP-2"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould match strings, regex patterns, and execute middlewares in order
[22m[39m{"id":"o8w216g5vkjaxlh9jeythkgs","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788465525,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CP-1"}}
{"id":"hqzcemgtr457d80abmizdvph","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465525,"meta":{"identity":"CP-1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould reject connection if middleware throws
[22m[39m{"id":"c4u2u5xrf7kg66zypwfuh3zj","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465536,"meta":{"port":53493,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould reject connection if middleware throws
[22m[39m{"id":"oioigtq9socoq29wrtbgp1ou","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788465540,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CP-2"}}
{"id":"tidbmldwhd2p5fa95bvjqmkr","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465540,"meta":{"identity":"CP-2"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould support a global catch-all router via server.use()
[22m[39m{"id":"ry1j0j39of72s61dpyvvoq73","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465564,"meta":{"port":53495,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould support a global catch-all router via server.use()
[22m[39m{"id":"gxjmcp9ssk3pb466vbzhsw4k","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465589,"meta":{"identity":"CP-1","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/router-middleware.test.ts[2m > [22m[2mOCPPRouter - Middleware & Multiplexing[2m > [22m[2mshould support a global catch-all router via server.use()
[22m[39m_startPing called [33m30000[39m
{"id":"dkid9cz7alaryd2cze774qz0","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788465590,"meta":{"protocol":""},"context":{"component":"OCPPClient","identity":"CP-1"}}

[90mstdout[2m | test/router-middleware.test.ts
[22m[39m{"id":"kg72lgk8wipf159mn7cgniox","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788465600,"meta":{"code":1000,"reason":""},"context":{"component":"OCPPClient","identity":"CP-1"}}
{"id":"ttith3udzng7cn9nn4c51ett","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465626,"meta":{"identity":"CP-1"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/router-middleware.test.ts [2m([22m[2m3 tests[22m[2m)[22m[33m 358[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"nipp3h72zw4ms0i39o4eccxk","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788465725,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould emit badMessage for unknown message type
[22m[39m{"id":"puaosifb3le7jm0ukbe8ai0r","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465725,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"rs41q4on3u5gxfcxg11hsmvl","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788465733,"meta":{"port":53497,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"n9uljfwjvlp3xsrw9t3pce07","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788465739,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"izegrogihgq7a0rhqdp3cxhx","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788465740,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"q5rt3pu1cfsl048xuqcwlwws","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788465848,"meta":{"code":1002,"reason":"Too many bad messages"},"context":{"component":"OCPPClient","identity":"CS001"}}
{"id":"n8p558yq4h27vftyiiz1g0kd","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788465848,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould accept valid payload in strict mode
[22m[39m{"id":"hu0pz54eqdspn1i01fnubtfq","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788466022,"meta":{"port":53500,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBad Messages[2m > [22m[2mshould close after maxBadMessages is reached
[22m[39m{"id":"bc41i0nhnml1rtjox77xzp2j","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466045,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"wgg9allxlmc3s6ck9bp68pzf","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788466048,"meta":{"port":53501,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"nkzv98psk3sewebqiyf66as0","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788466051,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"xmqei5ihnvcjoc41w1og5vbd","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788466052,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m{"id":"qcz6at7cnttfpjzvnwbzsbqh","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788466104,"meta":{"port":53503,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould emit upgradeAborted when client disconnects during auth
[22m[39m{"id":"okq6x5nbdp9gcyr7krnz4020","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466241,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"ehe3ln4porpkzubhtkpjxg7q","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788466255,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"vno6b9u52jbhpcpzd5znu64k","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466256,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"f6f6a9netred0g0ix8sp1f4p","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788466268,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_BUFFER"}}
{"id":"vcmbemhjlppd2s22iy1hgivt","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466270,"meta":{"identity":"CS_BUFFER"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould buffer sendRaw messages during CONNECTING and flush on open
[22m[39m{"id":"n6c03y9dyggpejs7z2fwvly4","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466274,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould accept valid payload in strict mode
[22m[39m{"id":"jn3rrgenuspa653u9rc9f5uh","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788466279,"meta":{"identity":"CS_VALID","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould throw when sendRaw called in CLOSED state
[22m[39m{"id":"lue08nrimf4424qsyr65gpa5","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788466306,"meta":{"port":53508,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould throw when sendRaw called in CLOSED state
[22m[39m{"id":"vxdcgdnx365mmnhikimeiuso","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466308,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"fjdcydcw3w6mgj4ow0pilrss","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788466339,"meta":{"port":53509,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m{"id":"vqmhzxy8h9h9dupjvbymotzt","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788466365,"meta":{"identity":"CP-Unicast-1","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"csw2ihec8jt778h7f36yepwz","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788466375,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"y6vd5ngp98rmayaxl4w6gkfa","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788466377,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould accept valid payload in strict mode
[22m[39m_startPing called [33m30000[39m
{"id":"nsdqmrujjaqyy2jyerv0wo6r","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788466325,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_VALID"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"ofap6m5t02yzif4hagnnhomp","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788466409,"meta":{"identity":"CS_IMMED","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m_startPing called [33m30000[39m
{"id":"hm46lgut5eqpus5iukbga88c","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788466411,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_IMMED"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould abort handshake on timeout
[22m[39m{"id":"uurehqg2qe55ks0gvuo97s1x","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466455,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould connect successfully with valid auth
[22m[39m{"id":"rezs45judsadutcs4stpiwtp","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788466466,"meta":{"identity":"valid-test-01","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould connect successfully with valid auth
[22m[39m{"id":"j8ayljc9b4m7jf7n92i575l6","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466471,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould connect successfully with valid auth
[22m[39m{"id":"u7at4lo69e7jmnvnkircijxs","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466479,"meta":{"identity":"valid-test-01"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39mPresence Node ID: tkzk550uf1itjzp1wzw3fhwh
Client A found: [33mtrue[39m
Node B sending to client...

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m[MOCK] client.call called with GetDiagnostics { location: [32m'remote'[39m }

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39mNode B sent.
Verification passed.

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m{"id":"ulwtf7vz6c4oddowb1mlym4t","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788466492,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CP-Unicast-1"}}
{"id":"td7eebwk1vpxx0z70z4iukqb","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466493,"meta":{"identity":"CP-Unicast-1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m{"id":"evai06im67le3hhbgai45tcy","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466495,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/unicast.test.ts[2m > [22m[2mUnicast Routing (Phase 1)[2m > [22m[2mServer B should route message to Client connected to Server A
[22m[39m{"id":"nz1w35ga4hjbtacwl1pmih2k","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466498,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/util.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 20[2mms[22m[39m
 [32mâœ“[39m test/unicast.test.ts [2m([22m[2m1 test[22m[2m)[22m[33m 417[2mms[22m[39m
   [33m[2mâœ“[22m[39m Unicast Routing (Phase 1)[2m > [22mServer B should route message to Client connected to Server A [33m 415[2mms[22m[39m
[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould support colons in identity via Basic Auth
[22m[39m{"id":"q0fpwnzgjflqmwww831fqv83","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788466504,"meta":{"identity":"station:01","remoteAddress":"::1"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould support colons in identity via Basic Auth
[22m[39m{"id":"tqe2dba8hmah69vmfvpsge3i","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466507,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/handshake-robustness.test.ts[2m > [22m[2mOCPPServer - Handshake Robustness[2m > [22m[2mshould support colons in identity via Basic Auth
[22m[39m{"id":"qijkjuhg0mh2hcztj2wqpebw","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466510,"meta":{"identity":"station:01"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/handshake-robustness.test.ts [2m([22m[2m4 tests[22m[2m)[22m[33m 513[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"oexqleivn6fld9s9bs24k7q3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466571,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould emit reconnect event after unexpected close
[22m[39m{"id":"ihkv9dq18hn6swcta7hzb86t","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466572,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"tmm0lw6e24zk694id2wp1tst","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788466575,"meta":{"port":53517,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"zxhjl2k6j1jzqw5zdhax430o","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788466583,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"imv57re8bylcztddisf3rv9j","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788466584,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"ohrbcpt5f5p9nzew2l5t6sxt","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788466614,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_IMMED"}}
{"id":"hup2to43jpbcisvqx3d19113","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466615,"meta":{"identity":"CS_IMMED"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould accept valid payload in strict mode
[22m[39m{"id":"zi078fjohzazjamhbqmfjzbw","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788466611,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_VALID"}}
{"id":"f8hmihwcmi7y5knjmu2sjtkf","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466618,"meta":{"identity":"CS_VALID"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Outbound Message Buffering[2m > [22m[2mshould send immediately when OPEN
[22m[39m{"id":"npp5u76s1skd1823qtfmvcik","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466622,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould accept valid payload in strict mode
[22m[39m{"id":"yz5aa21fg0tupmcztltmema3","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466625,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"j296ygdizwmu698u35jf5lr6","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788466626,"meta":{"port":53519,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould reject invalid payload in strict mode
[22m[39m{"id":"bl6zqc15jsleci82aa9oj11e","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788466633,"meta":{"port":53520,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"jwpnna02161ecg15eaou7668","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788466637,"meta":{"identity":"CS_PENDING","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould reject invalid payload in strict mode
[22m[39m{"id":"ohsepmjmqk6sxfyip3i9unzb","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788466639,"meta":{"identity":"CS_INVALID","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m_startPing called [33m30000[39m
{"id":"tc2od2y9jef8wgtwdz5tt7uz","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788466639,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_PENDING"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould reject invalid payload in strict mode
[22m[39m_startPing called [33m30000[39m
{"id":"z74di8kek7wzvu41tg8oefqn","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788466641,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_INVALID"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould reject invalid payload in strict mode
[22m[39m{"id":"q87qlkyou1qf89k20waibuw8","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788466644,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_INVALID"}}
{"id":"pw5yk555m4tyytwjo3twsd1r","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466644,"meta":{"identity":"CS_INVALID"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/validation-inbound.test.ts[2m > [22m[2mInbound Validation (Strict Mode)[2m > [22m[2mshould reject invalid payload in strict mode
[22m[39m{"id":"flkkbhgg1hqps2i4p8ekuqg7","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466645,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/validation-inbound.test.ts [2m([22m[2m2 tests[22m[2m)[22m[33m 645[2mms[22m[39m
   [33m[2mâœ“[22m[39m Inbound Validation (Strict Mode)[2m > [22mshould accept valid payload in strict mode [33m 625[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"bgi32ko527t67dlxhbqipi8z","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788466690,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"hcktjhgs6wqx9j7vrw5cp5p1","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466694,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"lbd2998g0jnc357whtlz2k4j","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466749,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"txi16b23jciopkj5oov02ite","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788466751,"meta":{"code":1006,"reason":""},"context":{"component":"OCPPClient","identity":"CS_PENDING"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Pending Call Rejection[2m > [22m[2mshould reject pending calls on unexpected disconnect
[22m[39m{"id":"mnu0aoahocqjxfkd540azpnh","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466752,"meta":{"identity":"CS_PENDING"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Protocol Narrowing[2m > [22m[2mshould narrow protocols to negotiated protocol after first connect
[22m[39m{"id":"kb0hdzcrbnute5gzyuqh3cal","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788466757,"meta":{"port":53523,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Protocol Narrowing[2m > [22m[2mshould narrow protocols to negotiated protocol after first connect
[22m[39m{"id":"a520d8ez9bv3tq51xgi879b9","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788466762,"meta":{"identity":"CS_NARROW","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Protocol Narrowing[2m > [22m[2mshould narrow protocols to negotiated protocol after first connect
[22m[39m_startPing called [33m30000[39m
{"id":"ekvd2hy5gmyqq1vnwwxepuj9","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788466777,"meta":{"protocol":"ocpp1.6"},"context":{"component":"OCPPClient","identity":"CS_NARROW"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Protocol Narrowing[2m > [22m[2mshould narrow protocols to negotiated protocol after first connect
[22m[39m{"id":"u510occtv09xuar9138j9n9k","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788466780,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/robustness-phase3.test.ts[2m > [22m[2mPhase 3 â€” Protocol Narrowing[2m > [22m[2mshould narrow protocols to negotiated protocol after first connect
[22m[39m{"id":"iz860lhnljfqx9529dbbu6ut","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788466782,"meta":{"identity":"CS_NARROW"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/robustness-phase3.test.ts [2m([22m[2m14 tests[22m[2m)[22m[33m 5371[2mms[22m[39m
   [33m[2mâœ“[22m[39m Phase 3 â€” Reconnect State Transitions[2m > [22mshould stay in CONNECTING state during reconnect backoff [33m 353[2mms[22m[39m
   [33m[2mâœ“[22m[39m Phase 3 â€” disconnect vs close Events[2m > [22mshould emit 'close' when max reconnects exhausted [33m 2030[2mms[22m[39m
   [33m[2mâœ“[22m[39m Phase 3 â€” Outbound Message Buffering[2m > [22mshould buffer sendRaw messages during CONNECTING and flush on open [33m 1385[2mms[22m[39m
   [33m[2mâœ“[22m[39m Phase 3 â€” Outbound Message Buffering[2m > [22mshould send immediately when OPEN [33m 315[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould not reconnect when reconnect is false
[22m[39m{"id":"bo5618l2tegw863o8tboc50d","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788467014,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"izi0rd0mygw8jinvbpdklqqd","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788467021,"meta":{"port":53525,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"v06o166eqzgwcx96calevvwi","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788467056,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"scwtasc39cv2tqsuvmm823ni","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788467057,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"myvg2x8b19tpinjs38bw41ue","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788467059,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"u37tqnwzk6o0eiritp6ok8qf","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788467063,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould reject pending calls on unexpected close
[22m[39m{"id":"hpc3uzmzg0slerhrsbqc07ww","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788467064,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"ic8ldwjakf33908sgjqkkfvv","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788467067,"meta":{"port":53527,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"pfyt2h0jkh1udmggsq90gqka","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788467081,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"qib2ufs06oenc46t577yrokf","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788467082,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

 [32mâœ“[39m test/queue.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 41[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"m92n9d0ncpjtb06psr41pp2o","level":30,"levelName":"INFO","message":"Disconnected","timestamp":1771788467186,"meta":{"code":1006,"reason":""},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"xi3qhw2uz8ndtnrw9bi3hxpv","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788467187,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/server-coverage.test.ts [2m([22m[2m7 tests[22m[2m)[22m[32m 59[2mms[22m[39m
 [32mâœ“[39m test/generate-types.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 55[2mms[22m[39m
 [32mâœ“[39m test/browser-queue.test.ts [2m([22m[2m12 tests[22m[2m)[22m[32m 50[2mms[22m[39m
 [32mâœ“[39m test/redis-helpers.test.ts [2m([22m[2m15 tests[22m[2m)[22m[32m 26[2mms[22m[39m
 [32mâœ“[39m test/logger-reexport.test.ts [2m([22m[2m16 tests[22m[2m)[22m[32m 208[2mms[22m[39m
[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mReconnection[2m > [22m[2mshould stop reconnecting when reconfigure disables reconnect
[22m[39m{"id":"rlxpothdnd6jlq7idws3xy41","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788467793,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould emit error event on WebSocket error
[22m[39m{"id":"echyeg2th1lf695g8nbahwel","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788467796,"meta":{"port":53530,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould emit error event on WebSocket error
[22m[39m{"id":"l5ert30086icejuywmpu23sq","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788467804,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"wrnuz0f3f9qqj551c6f7drl5","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788467807,"meta":{"port":53533,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"pfvi9cme2o8cn4ianq5vga0z","level":30,"levelName":"INFO","message":"Client connected","timestamp":1771788467811,"meta":{"identity":"CS001","remoteAddress":"::1","protocol":"ocpp1.6"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"ccfb463gyucyf42clcscvvzp","level":30,"levelName":"INFO","message":"Connected","timestamp":1771788467812,"meta":{"protocol":"ocpp1.6"},"context":{"component":"BrowserOCPPClient","identity":"CS001"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"jevu3zr4t9apovbuz5f9xmaa","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788467928,"meta":{"clientCount":1},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mError Handling[2m > [22m[2mshould handle handler throwing non-RPC error
[22m[39m{"id":"ar4ou4mb375ve4ip4az5n7jj","level":30,"levelName":"INFO","message":"Client disconnected","timestamp":1771788467929,"meta":{"identity":"CS001"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBrowser Index Exports[2m > [22m[2mshould export all expected modules
[22m[39m{"id":"nsy8owecp2fszhdoz3bu767o","level":30,"levelName":"INFO","message":"Server listening","timestamp":1771788467938,"meta":{"port":53535,"host":"0.0.0.0"},"context":{"component":"OCPPServer"}}

[90mstdout[2m | test/browser-client.test.ts[2m > [22m[2mBrowserOCPPClient[2m > [22m[2mBrowser Index Exports[2m > [22m[2mshould export all expected modules
[22m[39m{"id":"mlxhcuzpe64rbrzdedv7eyzw","level":30,"levelName":"INFO","message":"Server closing","timestamp":1771788468005,"meta":{"clientCount":0},"context":{"component":"OCPPServer"}}

 [32mâœ“[39m test/browser-client.test.ts [2m([22m[2m61 tests[22m[2m)[22m[33m 6364[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mIncoming Call Handlers[2m > [22mshould support NOREPLY from handler [33m 436[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mBad Messages[2m > [22mshould close after maxBadMessages is reached [33m 320[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mReconnection[2m > [22mshould emit reconnect event after unexpected close [33m 526[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mReconnection[2m > [22mshould not reconnect when reconnect is false [33m 442[2mms[22m[39m
   [33m[2mâœ“[22m[39m BrowserOCPPClient[2m > [22mReconnection[2m > [22mshould stop reconnecting when reconfigure disables reconnect [33m 729[2mms[22m[39m
 [32mâœ“[39m test/ws-util.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32mâœ“[39m test/browser-errors.test.ts [2m([22m[2m66 tests[22m[2m)[22m[32m 22[2mms[22m[39m
 [32mâœ“[39m test/safeSendToClient.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 22[2mms[22m[39m
[90mstdout[2m | test/client-coverage.test.ts[2m > [22m[2mOCPPClient Coverage[2m > [22m[2mPing Deferral
[22m[39m_startPing called [33m1000[39m
doPing executed
elapsed [33m500[39m deferring? [33mtrue[39m
doPing executed
elapsed [33m1500[39m deferring? [33mfalse[39m

[90mstdout[2m | test/client-coverage.test.ts[2m > [22m[2mOCPPClient Coverage[2m > [22m[2mPong Timeout terminates connection
[22m[39m_startPing called [33m1000[39m
doPing executed

 [32mâœ“[39m test/client-coverage.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 23[2mms[22m[39m
 [32mâœ“[39m test/browser-util.test.ts [2m([22m[2m28 tests[22m[2m)[22m[32m 20[2mms[22m[39m
 [32mâœ“[39m test/middleware.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 21[2mms[22m[39m
 [32mâœ“[39m test/combine-auth.test.ts [2m([22m[2m8 tests[22m[2m)[22m[32m 16[2mms[22m[39m
 [32mâœ“[39m test/redis-adapter.test.ts [2m([22m[2m10 tests[22m[2m)[22m[32m 20[2mms[22m[39m
 [32mâœ“[39m test/logging.test.ts [2m([22m[2m11 tests[22m[2m)[22m[32m 27[2mms[22m[39m
 [32mâœ“[39m test/browser-emitter.test.ts [2m([22m[2m22 tests[22m[2m)[22m[32m 23[2mms[22m[39m
 [32mâœ“[39m test/init-logger.test.ts [2m([22m[2m13 tests[22m[2m)[22m[32m 17[2mms[22m[39m
 [32mâœ“[39m test/errors.test.ts [2m([22m[2m19 tests[22m[2m)[22m[32m 12[2mms[22m[39m
 [32mâœ“[39m test/adapter.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 8[2mms[22m[39m
 [32mâœ“[39m test/event-buffer.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 10[2mms[22m[39m
 [32mâœ“[39m test/redis-driver.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m test/parse-basic-auth.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m test/client-duplicate.test.ts [2m([22m[2m4 tests[22m[2m)[22m[32m 6[2mms[22m[39m
 [32mâœ“[39m test/index.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 7[2mms[22m[39m
 [32mâœ“[39m test/safecall.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 13[2mms[22m[39m

[2m Test Files [22m [1m[32m39 passed[39m[22m[90m (39)[39m
[2m      Tests [22m [1m[32m516 passed[39m[22m[90m (516)[39m
[2m   Start at [22m 00:57:39
[2m   Duration [22m 15.95s[2m (transform 10.85s, setup 0ms, collect 24.56s, tests 26.79s, environment 13ms, prepare 11.10s)[22m

